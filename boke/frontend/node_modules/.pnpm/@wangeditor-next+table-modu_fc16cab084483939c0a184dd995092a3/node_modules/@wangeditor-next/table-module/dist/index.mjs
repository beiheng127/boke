import{i18nAddResources as t,DomEditor as e,t as r,isHTMLElememt as n}from"@wangeditor-next/core";import{Element as o,Editor as i,Node as a,Transforms as u,Range as c,Path as l,Text as f,Operation as s,Point as v}from"slate";import d,{append as h,on as p,focus as g,attr as y,val as b,html as m,dataset as w,addClass as x,removeClass as S,children as N,each as M,find as T,data as z,hide as E,show as k}from"dom7";import{jsx as O,h as A}from"snabbdom";import C from"lodash.debounce";import I from"lodash.throttle";t("en",{tableModule:{modal:{border:"Border",borderWidth:"Width",bgColor:"Back color",align:"Text Align",ok:"OK"},color:{default:"Default color",clear:"Clear back color"},borderStyle:{none:"None",solid:"Solid",dotted:"Dotted",dashed:"Dashed",double:"Double",groove:"Groove",ridge:"Ridge",inset:"Inset",outset:"Outset"},deleteCol:"Delete column",deleteRow:"Delete row",deleteTable:"Delete table",widthAuto:"Fit width",insertCol:"Insert column",insertRow:"Insert row",insertTable:"Insert table",header:"Header",mergeCell:"merge cell",splitCell:"split cell",tableProperty:"Table property",cellProperty:"Cell property"}}),t("zh-CN",{tableModule:{modal:{border:"边框",borderWidth:"宽度",bgColor:"背景色",align:"对齐方式",ok:"确定"},color:{default:"默认颜色",clear:"清除背景色"},borderStyle:{none:"无样式",solid:"实线",dotted:"点状虚线",dashed:"虚线",double:"双线",groove:"凹槽边框",ridge:"菱形边框",inset:"凹边框",outset:"凸边框"},deleteCol:"删除列",deleteRow:"删除行",deleteTable:"删除表格",widthAuto:"适应宽度",insertCol:"插入列",insertRow:"插入行",insertTable:"插入表格",header:"表头",mergeCell:"合并单元格",splitCell:"拆分单元格",tableProperty:"表格属性",cellProperty:"单元格属性"}});var H,j,P="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},R={};function V(){if(j)return H;j=1;var t=function(t){return t&&t.Math===Math&&t};return H=t("object"==typeof globalThis&&globalThis)||t("object"==typeof window&&window)||t("object"==typeof self&&self)||t("object"==typeof P&&P)||t("object"==typeof H&&H)||function(){return this}()||Function("return this")()}var D,L,B,W,_,F,q,$,G={};function U(){return L?D:(L=1,D=function(t){try{return!!t()}catch(t){return!0}})}function Y(){if(W)return B;W=1;var t=U();return B=!t(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})}function X(){if(F)return _;F=1;var t=U();return _=!t(function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})}function K(){if($)return q;$=1;var t=X(),e=Function.prototype.call;return q=t?e.bind(e):function(){return e.apply(e,arguments)},q}var J,Q,Z,tt,et,rt,nt,ot,it,at,ut,ct,lt,ft,st,vt,dt,ht,pt,gt,yt,bt,mt,wt,xt,St,Nt,Mt,Tt,zt,Et,kt,Ot,At,Ct,It,Ht,jt,Pt,Rt,Vt,Dt={};function Lt(){if(J)return Dt;J=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,r=e&&!t.call({1:2},1);return Dt.f=r?function(t){var r=e(this,t);return!!r&&r.enumerable}:t,Dt}function Bt(){return Z?Q:(Z=1,Q=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}})}function Wt(){if(et)return tt;et=1;var t=X(),e=Function.prototype,r=e.call,n=t&&e.bind.bind(r,r);return tt=t?n:function(t){return function(){return r.apply(t,arguments)}},tt}function _t(){if(nt)return rt;nt=1;var t=Wt(),e=t({}.toString),r=t("".slice);return rt=function(t){return r(e(t),8,-1)}}function Ft(){if(it)return ot;it=1;var t=Wt(),e=U(),r=_t(),n=Object,o=t("".split);return ot=e(function(){return!n("z").propertyIsEnumerable(0)})?function(t){return"String"===r(t)?o(t,""):n(t)}:n}function qt(){return ut?at:(ut=1,at=function(t){return null==t})}function $t(){if(lt)return ct;lt=1;var t=qt(),e=TypeError;return ct=function(r){if(t(r))throw new e("Can't call method on "+r);return r}}function Gt(){if(st)return ft;st=1;var t=Ft(),e=$t();return ft=function(r){return t(e(r))}}function Ut(){if(dt)return vt;dt=1;var t="object"==typeof document&&document.all;return vt=void 0===t&&void 0!==t?function(e){return"function"==typeof e||e===t}:function(t){return"function"==typeof t}}function Yt(){if(pt)return ht;pt=1;var t=Ut();return ht=function(e){return"object"==typeof e?null!==e:t(e)}}function Xt(){if(yt)return gt;yt=1;var t=V(),e=Ut();return gt=function(r,n){return arguments.length<2?(o=t[r],e(o)?o:void 0):t[r]&&t[r][n];var o},gt}function Kt(){if(mt)return bt;mt=1;var t=Wt();return bt=t({}.isPrototypeOf)}function Jt(){if(xt)return wt;xt=1;var t=V().navigator,e=t&&t.userAgent;return wt=e?String(e):""}function Qt(){if(Nt)return St;Nt=1;var t,e,r=V(),n=Jt(),o=r.process,i=r.Deno,a=o&&o.versions||i&&i.version,u=a&&a.v8;return u&&(e=(t=u.split("."))[0]>0&&t[0]<4?1:+(t[0]+t[1])),!e&&n&&(!(t=n.match(/Edge\/(\d+)/))||t[1]>=74)&&(t=n.match(/Chrome\/(\d+)/))&&(e=+t[1]),St=e}function Zt(){if(Tt)return Mt;Tt=1;var t=Qt(),e=U(),r=V().String;return Mt=!!Object.getOwnPropertySymbols&&!e(function(){var e=Symbol("symbol detection");return!r(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&t&&t<41})}function te(){if(Et)return zt;Et=1;var t=Zt();return zt=t&&!Symbol.sham&&"symbol"==typeof Symbol.iterator}function ee(){if(Ot)return kt;Ot=1;var t=Xt(),e=Ut(),r=Kt(),n=te(),o=Object;return kt=n?function(t){return"symbol"==typeof t}:function(n){var i=t("Symbol");return e(i)&&r(i.prototype,o(n))}}function re(){if(Ct)return At;Ct=1;var t=String;return At=function(e){try{return t(e)}catch(t){return"Object"}}}function ne(){if(Ht)return It;Ht=1;var t=Ut(),e=re(),r=TypeError;return It=function(n){if(t(n))return n;throw new r(e(n)+" is not a function")}}function oe(){if(Pt)return jt;Pt=1;var t=ne(),e=qt();return jt=function(r,n){var o=r[n];return e(o)?void 0:t(o)}}function ie(){if(Vt)return Rt;Vt=1;var t=K(),e=Ut(),r=Yt(),n=TypeError;return Rt=function(o,i){var a,u;if("string"===i&&e(a=o.toString)&&!r(u=t(a,o)))return u;if(e(a=o.valueOf)&&!r(u=t(a,o)))return u;if("string"!==i&&e(a=o.toString)&&!r(u=t(a,o)))return u;throw new n("Can't convert object to primitive value")},Rt}var ae,ue,ce,le,fe,se,ve,de,he,pe,ge,ye,be,me,we,xe,Se,Ne,Me,Te,ze,Ee,ke,Oe,Ae={exports:{}};function Ce(){return ue?ae:(ue=1,ae=!1)}function Ie(){if(le)return ce;le=1;var t=V(),e=Object.defineProperty;return ce=function(r,n){try{e(t,r,{value:n,configurable:!0,writable:!0})}catch(e){t[r]=n}return n}}function He(){if(fe)return Ae.exports;fe=1;var t=Ce(),e=V(),r=Ie(),n="__core-js_shared__",o=Ae.exports=e[n]||r(n,{});return(o.versions||(o.versions=[])).push({version:"3.46.0",mode:t?"pure":"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru), 2025 CoreJS Company (core-js.io)",license:"https://github.com/zloirock/core-js/blob/v3.46.0/LICENSE",source:"https://github.com/zloirock/core-js"}),Ae.exports}function je(){if(ve)return se;ve=1;var t=He();return se=function(e,r){return t[e]||(t[e]=r||{})}}function Pe(){if(he)return de;he=1;var t=$t(),e=Object;return de=function(r){return e(t(r))}}function Re(){if(ge)return pe;ge=1;var t=Wt(),e=Pe(),r=t({}.hasOwnProperty);return pe=Object.hasOwn||function(t,n){return r(e(t),n)}}function Ve(){if(be)return ye;be=1;var t=Wt(),e=0,r=Math.random(),n=t(1.1.toString);return ye=function(t){return"Symbol("+(void 0===t?"":t)+")_"+n(++e+r,36)}}function De(){if(we)return me;we=1;var t=V(),e=je(),r=Re(),n=Ve(),o=Zt(),i=te(),a=t.Symbol,u=e("wks"),c=i?a.for||a:a&&a.withoutSetter||n;return me=function(t){return r(u,t)||(u[t]=o&&r(a,t)?a[t]:c("Symbol."+t)),u[t]}}function Le(){if(Se)return xe;Se=1;var t=K(),e=Yt(),r=ee(),n=oe(),o=ie(),i=De(),a=TypeError,u=i("toPrimitive");return xe=function(i,c){if(!e(i)||r(i))return i;var l,f=n(i,u);if(f){if(void 0===c&&(c="default"),l=t(f,i,c),!e(l)||r(l))return l;throw new a("Can't convert object to primitive value")}return void 0===c&&(c="number"),o(i,c)}}function Be(){if(Me)return Ne;Me=1;var t=Le(),e=ee();return Ne=function(r){var n=t(r,"string");return e(n)?n:n+""}}function We(){if(ze)return Te;ze=1;var t=V(),e=Yt(),r=t.document,n=e(r)&&e(r.createElement);return Te=function(t){return n?r.createElement(t):{}}}function _e(){if(ke)return Ee;ke=1;var t=Y(),e=U(),r=We();return Ee=!t&&!e(function(){return 7!==Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a})}function Fe(){if(Oe)return G;Oe=1;var t=Y(),e=K(),r=Lt(),n=Bt(),o=Gt(),i=Be(),a=Re(),u=_e(),c=Object.getOwnPropertyDescriptor;return G.f=t?c:function(t,l){if(t=o(t),l=i(l),u)try{return c(t,l)}catch(t){}if(a(t,l))return n(!e(r.f,t,l),t[l])},G}var qe,$e,Ge,Ue,Ye,Xe,Ke,Je={};function Qe(){if($e)return qe;$e=1;var t=Y(),e=U();return qe=t&&e(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype})}function Ze(){if(Ue)return Ge;Ue=1;var t=Yt(),e=String,r=TypeError;return Ge=function(n){if(t(n))return n;throw new r(e(n)+" is not an object")}}function tr(){if(Ye)return Je;Ye=1;var t=Y(),e=_e(),r=Qe(),n=Ze(),o=Be(),i=TypeError,a=Object.defineProperty,u=Object.getOwnPropertyDescriptor,c="enumerable",l="configurable",f="writable";return Je.f=t?r?function(t,e,r){if(n(t),e=o(e),n(r),"function"==typeof t&&"prototype"===e&&"value"in r&&f in r&&!r[f]){var i=u(t,e);i&&i[f]&&(t[e]=r.value,r={configurable:l in r?r[l]:i[l],enumerable:c in r?r[c]:i[c],writable:!1})}return a(t,e,r)}:a:function(t,r,u){if(n(t),r=o(r),n(u),e)try{return a(t,r,u)}catch(t){}if("get"in u||"set"in u)throw new i("Accessors not supported");return"value"in u&&(t[r]=u.value),t},Je}function er(){if(Ke)return Xe;Ke=1;var t=Y(),e=tr(),r=Bt();return Xe=t?function(t,n,o){return e.f(t,n,r(1,o))}:function(t,e,r){return t[e]=r,t}}var rr,nr,or,ir,ar,ur,cr,lr,fr,sr,vr,dr,hr,pr,gr,yr={exports:{}};function br(){if(nr)return rr;nr=1;var t=Y(),e=Re(),r=Function.prototype,n=t&&Object.getOwnPropertyDescriptor,o=e(r,"name"),i=o&&"something"===function(){}.name,a=o&&(!t||t&&n(r,"name").configurable);return rr={EXISTS:o,PROPER:i,CONFIGURABLE:a}}function mr(){if(ir)return or;ir=1;var t=Wt(),e=Ut(),r=He(),n=t(Function.toString);return e(r.inspectSource)||(r.inspectSource=function(t){return n(t)}),or=r.inspectSource}function wr(){if(ur)return ar;ur=1;var t=V(),e=Ut(),r=t.WeakMap;return ar=e(r)&&/native code/.test(String(r))}function xr(){if(lr)return cr;lr=1;var t=je(),e=Ve(),r=t("keys");return cr=function(t){return r[t]||(r[t]=e(t))}}function Sr(){return sr?fr:(sr=1,fr={})}function Nr(){if(dr)return vr;dr=1;var t,e,r,n=wr(),o=V(),i=Yt(),a=er(),u=Re(),c=He(),l=xr(),f=Sr(),s="Object already initialized",v=o.TypeError,d=o.WeakMap;if(n||c.state){var h=c.state||(c.state=new d);h.get=h.get,h.has=h.has,h.set=h.set,t=function(t,e){if(h.has(t))throw new v(s);return e.facade=t,h.set(t,e),e},e=function(t){return h.get(t)||{}},r=function(t){return h.has(t)}}else{var p=l("state");f[p]=!0,t=function(t,e){if(u(t,p))throw new v(s);return e.facade=t,a(t,p,e),e},e=function(t){return u(t,p)?t[p]:{}},r=function(t){return u(t,p)}}return vr={set:t,get:e,has:r,enforce:function(n){return r(n)?e(n):t(n,{})},getterFor:function(t){return function(r){var n;if(!i(r)||(n=e(r)).type!==t)throw new v("Incompatible receiver, "+t+" required");return n}}}}function Mr(){if(hr)return yr.exports;hr=1;var t=Wt(),e=U(),r=Ut(),n=Re(),o=Y(),i=br().CONFIGURABLE,a=mr(),u=Nr(),c=u.enforce,l=u.get,f=String,s=Object.defineProperty,v=t("".slice),d=t("".replace),h=t([].join),p=o&&!e(function(){return 8!==s(function(){},"length",{value:8}).length}),g=String(String).split("String"),y=yr.exports=function(t,e,r){"Symbol("===v(f(e),0,7)&&(e="["+d(f(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),r&&r.getter&&(e="get "+e),r&&r.setter&&(e="set "+e),(!n(t,"name")||i&&t.name!==e)&&(o?s(t,"name",{value:e,configurable:!0}):t.name=e),p&&r&&n(r,"arity")&&t.length!==r.arity&&s(t,"length",{value:r.arity});try{r&&n(r,"constructor")&&r.constructor?o&&s(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var a=c(t);return n(a,"source")||(a.source=h(g,"string"==typeof e?e:"")),t};return Function.prototype.toString=y(function(){return r(this)&&l(this).source||a(this)},"toString"),yr.exports}function Tr(){if(gr)return pr;gr=1;var t=Ut(),e=tr(),r=Mr(),n=Ie();return pr=function(o,i,a,u){u||(u={});var c=u.enumerable,l=void 0!==u.name?u.name:i;if(t(a)&&r(a,l,u),u.global)c?o[i]=a:n(i,a);else{try{u.unsafe?o[i]&&(c=!0):delete o[i]}catch(t){}c?o[i]=a:e.f(o,i,{value:a,enumerable:!1,configurable:!u.nonConfigurable,writable:!u.nonWritable})}return o}}var zr,Er,kr,Or,Ar,Cr,Ir,Hr,jr,Pr,Rr,Vr,Dr,Lr,Br,Wr,_r,Fr={};function qr(){if(Or)return kr;Or=1;var t=function(){if(Er)return zr;Er=1;var t=Math.ceil,e=Math.floor;return zr=Math.trunc||function(r){var n=+r;return(n>0?e:t)(n)}}();return kr=function(e){var r=+e;return r!=r||0===r?0:t(r)}}function $r(){if(Cr)return Ar;Cr=1;var t=qr(),e=Math.max,r=Math.min;return Ar=function(n,o){var i=t(n);return i<0?e(i+o,0):r(i,o)}}function Gr(){if(Hr)return Ir;Hr=1;var t=qr(),e=Math.min;return Ir=function(r){var n=t(r);return n>0?e(n,9007199254740991):0}}function Ur(){if(Pr)return jr;Pr=1;var t=Gr();return jr=function(e){return t(e.length)}}function Yr(){if(Vr)return Rr;Vr=1;var t=Gt(),e=$r(),r=Ur(),n=function(n){return function(o,i,a){var u=t(o),c=r(u);if(0===c)return!n&&-1;var l,f=e(a,c);if(n&&i!=i){for(;c>f;)if((l=u[f++])!=l)return!0}else for(;c>f;f++)if((n||f in u)&&u[f]===i)return n||f||0;return!n&&-1}};return Rr={includes:n(!0),indexOf:n(!1)}}function Xr(){if(Lr)return Dr;Lr=1;var t=Wt(),e=Re(),r=Gt(),n=Yr().indexOf,o=Sr(),i=t([].push);return Dr=function(t,a){var u,c=r(t),l=0,f=[];for(u in c)!e(o,u)&&e(c,u)&&i(f,u);for(;a.length>l;)e(c,u=a[l++])&&(~n(f,u)||i(f,u));return f}}function Kr(){return Wr?Br:(Wr=1,Br=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"])}function Jr(){if(_r)return Fr;_r=1;var t=Xr(),e=Kr().concat("length","prototype");return Fr.f=Object.getOwnPropertyNames||function(r){return t(r,e)},Fr}var Qr,Zr,tn,en,rn,nn,on,an,un,cn,ln,fn,sn,vn,dn,hn,pn,gn,yn,bn,mn,wn,xn,Sn,Nn,Mn,Tn,zn,En={};function kn(){return Qr||(Qr=1,En.f=Object.getOwnPropertySymbols),En}function On(){if(tn)return Zr;tn=1;var t=Xt(),e=Wt(),r=Jr(),n=kn(),o=Ze(),i=e([].concat);return Zr=t("Reflect","ownKeys")||function(t){var e=r.f(o(t)),a=n.f;return a?i(e,a(t)):e}}function An(){if(rn)return en;rn=1;var t=Re(),e=On(),r=Fe(),n=tr();return en=function(o,i,a){for(var u=e(i),c=n.f,l=r.f,f=0;f<u.length;f++){var s=u[f];t(o,s)||a&&t(a,s)||c(o,s,l(i,s))}}}function Cn(){if(on)return nn;on=1;var t=U(),e=Ut(),r=/#|\.prototype\./,n=function(r,n){var c=i[o(r)];return c===u||c!==a&&(e(n)?t(n):!!n)},o=n.normalize=function(t){return String(t).replace(r,".").toLowerCase()},i=n.data={},a=n.NATIVE="N",u=n.POLYFILL="P";return nn=n}function In(){if(un)return an;un=1;var t=V(),e=Fe().f,r=er(),n=Tr(),o=Ie(),i=An(),a=Cn();return an=function(u,c){var l,f,s,v,d,h=u.target,p=u.global,g=u.stat;if(l=p?t:g?t[h]||o(h,{}):t[h]&&t[h].prototype)for(f in c){if(v=c[f],s=u.dontCallGetSet?(d=e(l,f))&&d.value:l[f],!a(p?f:h+(g?".":"#")+f,u.forced)&&void 0!==s){if(typeof v==typeof s)continue;i(v,s)}(u.sham||s&&s.sham)&&r(v,"sham",!0),n(l,f,v,u)}}}function Hn(){if(ln)return cn;ln=1;var t=_t();return cn=Array.isArray||function(e){return"Array"===t(e)}}function jn(){if(sn)return fn;sn=1;var t=TypeError;return fn=function(e){if(e>9007199254740991)throw t("Maximum allowed index exceeded");return e}}function Pn(){if(dn)return vn;dn=1;var t=Y(),e=tr(),r=Bt();return vn=function(n,o,i){t?e.f(n,o,r(0,i)):n[o]=i}}function Rn(){if(pn)return hn;pn=1;var t={};return t[De()("toStringTag")]="z",hn="[object z]"===String(t)}function Vn(){if(yn)return gn;yn=1;var t=Rn(),e=Ut(),r=_t(),n=De()("toStringTag"),o=Object,i="Arguments"===r(function(){return arguments}());return gn=t?r:function(t){var a,u,c;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(u=function(t,e){try{return t[e]}catch(t){}}(a=o(t),n))?u:i?r(a):"Object"===(c=r(a))&&e(a.callee)?"Arguments":c}}function Dn(){if(mn)return bn;mn=1;var t=Wt(),e=U(),r=Ut(),n=Vn(),o=Xt(),i=mr(),a=function(){},u=o("Reflect","construct"),c=/^\s*(?:class|function)\b/,l=t(c.exec),f=!c.test(a),s=function(t){if(!r(t))return!1;try{return u(a,[],t),!0}catch(t){return!1}},v=function(t){if(!r(t))return!1;switch(n(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return f||!!l(c,i(t))}catch(t){return!0}};return v.sham=!0,bn=!u||e(function(){var t;return s(s.call)||!s(Object)||!s(function(){t=!0})||t})?v:s}function Ln(){if(xn)return wn;xn=1;var t=Hn(),e=Dn(),r=Yt(),n=De()("species"),o=Array;return wn=function(i){var a;return t(i)&&(a=i.constructor,(e(a)&&(a===o||t(a.prototype))||r(a)&&null===(a=a[n]))&&(a=void 0)),void 0===a?o:a}}function Bn(){if(Nn)return Sn;Nn=1;var t=Ln();return Sn=function(e,r){return new(t(e))(0===r?0:r)}}function Wn(){if(Tn)return Mn;Tn=1;var t=U(),e=De(),r=Qt(),n=e("species");return Mn=function(e){return r>=51||!t(function(){var t=[];return(t.constructor={})[n]=function(){return{foo:1}},1!==t[e](Boolean).foo})}}!function(){if(zn)return R;zn=1;var t=In(),e=U(),r=Hn(),n=Yt(),o=Pe(),i=Ur(),a=jn(),u=Pn(),c=Bn(),l=Wn(),f=De(),s=Qt(),v=f("isConcatSpreadable"),d=s>=51||!e(function(){var t=[];return t[v]=!1,t.concat()[0]!==t}),h=function(t){if(!n(t))return!1;var e=t[v];return void 0!==e?!!e:r(t)};t({target:"Array",proto:!0,arity:1,forced:!d||!l("concat")},{concat:function(t){var e,r,n,l,f,s=o(this),v=c(s,0),d=0;for(e=-1,n=arguments.length;e<n;e++)if(h(f=-1===e?s:arguments[e]))for(l=i(f),a(d+l),r=0;r<l;r++,d++)r in f&&u(v,d,f[r]);else a(d+1),u(v,d++,f);return v.length=d,v}})}();var _n,Fn,qn,$n={};function Gn(){if(Fn)return _n;Fn=1;var t=U();return _n=function(e,r){var n=[][e];return!!n&&t(function(){n.call(null,r||function(){return 1},1)})}}!function(){if(qn)return $n;qn=1;var t=In(),e=Wt(),r=Ft(),n=Gt(),o=Gn(),i=e([].join);t({target:"Array",proto:!0,forced:r!==Object||!o("join",",")},{join:function(t){return i(n(this),void 0===t?",":t)}})}();var Un,Yn,Xn,Kn,Jn,Qn,Zn,to={};function eo(){if(Kn)return Xn;Kn=1;var t=function(){if(Yn)return Un;Yn=1;var t=_t(),e=Wt();return Un=function(r){if("Function"===t(r))return e(r)}}(),e=ne(),r=X(),n=t(t.bind);return Xn=function(t,o){return e(t),void 0===o?t:r?n(t,o):function(){return t.apply(o,arguments)}},Xn}function ro(){if(Qn)return Jn;Qn=1;var t=eo(),e=Wt(),r=Ft(),n=Pe(),o=Ur(),i=Bn(),a=e([].push),u=function(e){var u=1===e,c=2===e,l=3===e,f=4===e,s=6===e,v=7===e,d=5===e||s;return function(h,p,g,y){for(var b,m,w=n(h),x=r(w),S=o(x),N=t(p,g),M=0,T=y||i,z=u?T(h,S):c||v?T(h,0):void 0;S>M;M++)if((d||M in x)&&(m=N(b=x[M],M,w),e))if(u)z[M]=m;else if(m)switch(e){case 3:return!0;case 5:return b;case 6:return M;case 2:a(z,b)}else switch(e){case 4:return!1;case 7:a(z,b)}return s?-1:l||f?f:z}};return Jn={forEach:u(0),map:u(1),filter:u(2),some:u(3),every:u(4),find:u(5),findIndex:u(6),filterReject:u(7)}}!function(){if(Zn)return to;Zn=1;var t=In(),e=ro().map;t({target:"Array",proto:!0,forced:!Wn()("map")},{map:function(t){return e(this,t,arguments.length>1?arguments[1]:void 0)}})}();var no,oo,io,ao={};!function(){if(io)return ao;io=1;var t=Rn(),e=Tr(),r=function(){if(oo)return no;oo=1;var t=Rn(),e=Vn();return no=t?{}.toString:function(){return"[object "+e(this)+"]"}}();t||e(Object.prototype,"toString",r,{unsafe:!0})}();var uo={type:"table",elemToHtml:function(t,e){var r=t,n=r.width,o=void 0===n?"auto":n,i=r.columnWidths,a=r.height,u=void 0===a?"auto":a,c=null==i?void 0:i.map(function(t){return"<col width=".concat(t,"></col>")}).join(""),l=c?'<colgroup contentEditable="false">'.concat(c,"</colgroup>"):"";return'<table style="width: '.concat(o,";table-layout: fixed;height:").concat(u,'">').concat(l,"<tbody>").concat(e,"</tbody></table>")}},co={type:"table-row",elemToHtml:function(t,e){var r=t.height,n=r?' style="height: '.concat(r,'px"'):"";return"<tr".concat(n,">").concat(e,"</tr>")}},lo={type:"table-cell",elemToHtml:function(t,e){var r=t,n=r.colSpan,o=void 0===n?1:n,i=r.rowSpan,a=void 0===i?1:i,u=r.isHeader,c=void 0!==u&&u,l=r.width,f=void 0===l?"auto":l,s=r.hidden;if(void 0!==s&&s)return"";var v=c?"th":"td";return"<".concat(v,' colSpan="').concat(o,'" rowSpan="').concat(a,'" width="').concat(f,'">').concat(e,"</").concat(v,">")}},fo=function(t,e){return fo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},fo(t,e)};var so=function(){return so=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},so.apply(this,arguments)};function vo(t,e){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=u(0),a.throw=u(1),a.return=u(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(c){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&u[0]?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return i.label++,{value:u[1],done:!1};case 5:i.label++,n=u[1],u=[0];continue;case 7:u=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){i=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){i.label=u[1];break}if(6===u[0]&&i.label<o[1]){i.label=o[1],o=u;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(u);break}o[2]&&i.ops.pop(),i.trys.pop();continue}u=e.call(t,i)}catch(t){u=[6,t],n=0}finally{r=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}}function ho(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function po(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function go(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))}"function"==typeof SuppressedError&&SuppressedError;var yo,bo,mo,wo,xo,So,No,Mo,To,zo,Eo='<svg viewBox="0 0 1024 1024"><path d="M236.8 128L896 787.2V128H236.8z m614.4 704L192 172.8V832h659.2zM192 64h704c38.4 0 64 25.6 64 64v704c0 38.4-25.6 64-64 64H192c-38.4 0-64-25.6-64-64V128c0-38.4 25.6-64 64-64z"></path></svg>',ko={},Oo={};function Ao(){if(bo)return yo;bo=1;var t=Xr(),e=Kr();return yo=Object.keys||function(r){return t(r,e)}}function Co(){if(xo)return wo;xo=1;var t=Xt();return wo=t("document","documentElement")}function Io(){if(No)return So;No=1;var t,e=Ze(),r=function(){if(mo)return Oo;mo=1;var t=Y(),e=Qe(),r=tr(),n=Ze(),o=Gt(),i=Ao();return Oo.f=t&&!e?Object.defineProperties:function(t,e){n(t);for(var a,u=o(e),c=i(e),l=c.length,f=0;l>f;)r.f(t,a=c[f++],u[a]);return t},Oo}(),n=Kr(),o=Sr(),i=Co(),a=We(),u=xr(),c="prototype",l="script",f=u("IE_PROTO"),s=function(){},v=function(t){return"<"+l+">"+t+"</"+l+">"},d=function(t){t.write(v("")),t.close();var e=t.parentWindow.Object;return t=null,e},h=function(){try{t=new ActiveXObject("htmlfile")}catch(t){}var e,r,o;h="undefined"!=typeof document?document.domain&&t?d(t):(r=a("iframe"),o="java"+l+":",r.style.display="none",i.appendChild(r),r.src=String(o),(e=r.contentWindow.document).open(),e.write(v("document.F=Object")),e.close(),e.F):d(t);for(var u=n.length;u--;)delete h[c][n[u]];return h()};return o[f]=!0,So=Object.create||function(t,n){var o;return null!==t?(s[c]=e(t),o=new s,s[c]=null,o[f]=t):o=h(),void 0===n?o:r.f(o,n)}}function Ho(){if(To)return Mo;To=1;var t=De(),e=Io(),r=tr().f,n=t("unscopables"),o=Array.prototype;return void 0===o[n]&&r(o,n,{configurable:!0,value:e(null)}),Mo=function(t){o[n][t]=!0}}!function(){if(zo)return ko;zo=1;var t=In(),e=Yr().includes,r=U(),n=Ho();t({target:"Array",proto:!0,forced:r(function(){return!Array(1).includes()})},{includes:function(t){return e(this,t,arguments.length>1?arguments[1]:void 0)}}),n("includes")}();var jo,Po,Ro,Vo,Do,Lo,Bo,Wo,_o,Fo={};function qo(){if(Vo)return Ro;Vo=1;var t=function(){if(Po)return jo;Po=1;var t=Yt(),e=_t(),r=De()("match");return jo=function(n){var o;return t(n)&&(void 0!==(o=n[r])?!!o:"RegExp"===e(n))}}(),e=TypeError;return Ro=function(r){if(t(r))throw new e("The method doesn't accept regular expressions");return r}}function $o(){if(Lo)return Do;Lo=1;var t=Vn(),e=String;return Do=function(r){if("Symbol"===t(r))throw new TypeError("Cannot convert a Symbol value to a string");return e(r)}}!function(){if(_o)return Fo;_o=1;var t=In(),e=Wt(),r=qo(),n=$t(),o=$o(),i=function(){if(Wo)return Bo;Wo=1;var t=De()("match");return Bo=function(e){var r=/./;try{"/./"[e](r)}catch(n){try{return r[t]=!1,"/./"[e](r)}catch(t){}}return!1}}(),a=e("".indexOf);t({target:"String",proto:!0,forced:!i("includes")},{includes:function(t){return!!~a(o(n(this)),o(r(t)),arguments.length>1?arguments[1]:void 0)}})}();var Go={blocks:{td:"table-cell",th:"table-cell",content:"paragraph",tr:"table-row",table:"table",tbody:"table-body"}};function Uo(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=Go,a=e.map(function(t){var e;return null===(e=null==n?void 0:n.blocks)||void 0===e?void 0:e[t]});return function(t){return function(t){return!i.isEditor(t)&&o.isElement(t)&&"type"in t}(t)&&a.includes(t.type)}}function Yo(t,e){for(var r=po(e,2),n=r[0],o=r[1],u=[],c=2;c<arguments.length;c++)u[c-2]=arguments[c];var l=po(a.common(t,n,o),2),f=l[0],s=l[1];return!!Uo.apply(void 0,go([t],po(u),!1))(f,s)||!!i.above(t,{match:Uo.apply(void 0,go([t],po(u),!1)),at:s})}function Xo(t,e){var r,n;void 0===e&&(e={});var o=[];try{for(var a=ho(function(t,e){var r,n,o,a,u,c,l,f,s,v,d,h,p,g,y,b,m,w;return void 0===e&&(e={}),vo(this,function(x){switch(x.label){case 0:if(r=po(i.nodes(t,{match:Uo(t,"table"),at:e.at}),1),!(n=r[0]))return[2,[]];o=po(n,2),a=o[1],x.label=1;case 1:x.trys.push([1,6,7,8]),u=ho(i.nodes(t,{match:Uo(t,"table"),at:a})),c=u.next(),x.label=2;case 2:if(c.done)return[3,5];l=po(c.value,2),f=l[1],s=[];try{for(m=void 0,v=ho(i.nodes(t,{match:Uo(t,"tr"),at:f})),d=v.next();!d.done;d=v.next())h=po(d.value,2),p=h[1],s.push(go([],po(i.nodes(t,{match:Uo(t,"th","td"),at:p})),!1))}catch(t){m={error:t}}finally{try{d&&!d.done&&(w=v.return)&&w.call(v)}finally{if(m)throw m.error}}return[4,s];case 3:x.sent(),x.label=4;case 4:return c=u.next(),[3,2];case 5:return[3,8];case 6:return g=x.sent(),y={error:g},[3,8];case 7:try{c&&!c.done&&(b=u.return)&&b.call(u)}finally{if(y)throw y.error}return[7];case 8:return[2]}})}(t,{at:e.at})),u=a.next();!u.done;u=a.next()){for(var c=u.value,l=[],f=0,s=0;s<c.length;s+=1)c[s]&&(f=Math.max(f,c[s].length));for(s=0;s<c.length;s+=1)if(l[s]||(l[s]=[]),c[s])for(var v=0;v<c[s].length;v+=1)if(c[s][v]&&c[s][v][0]){for(var d=po(c[s][v],1)[0],h=d.rowSpan,p=void 0===h?1:h,g=d.colSpan,y=void 0===g?1:g,b=v;l[s]&&l[s][b];)b+=1;for(var m=0;m<y;m+=1)for(var w=0;w<p;w+=1){var x=s+w,S=b+m;l[x]||(l[x]=[]),l[x][S]||(l[x][S]=[c[s][v],{rtl:m+1,ltr:y-m,ttb:w+1,btt:p-w}])}}o.push.apply(o,go([],po(l),!1))}}catch(t){r={error:t}}finally{try{u&&!u.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return o}var Ko,Jo=function(){function t(t,e){this.x=t,this.y=e}return t.valueOf=function(t,e){return new this(t,e)},t.equals=function(t,e){return t.x===e.x&&t.y===e.y},t}(),Qo={};!function(){if(Ko)return Qo;Ko=1;var t=In(),e=ro().find,r=Ho(),n="find",o=!0;n in[]&&Array(1)[n](function(){o=!1}),t({target:"Array",proto:!0,forced:o},{find:function(t){return e(this,t,arguments.length>1?arguments[1]:void 0)}}),r(n)}();var Zo,ti,ei,ri,ni,oi,ii,ai,ui,ci,li,fi,si,vi,di,hi,pi,gi={};function yi(){if(ti)return Zo;ti=1;var t=K(),e=Ze(),r=oe();return Zo=function(n,o,i){var a,u;e(n);try{if(!(a=r(n,"return"))){if("throw"===o)throw i;return i}a=t(a,n)}catch(t){u=!0,a=t}if("throw"===o)throw i;if(u)throw a;return e(a),i}}function bi(){if(ri)return ei;ri=1;var t=Ze(),e=yi();return ei=function(r,n,o,i){try{return i?n(t(o)[0],o[1]):n(o)}catch(t){e(r,"throw",t)}}}function mi(){return oi?ni:(oi=1,ni={})}function wi(){if(ai)return ii;ai=1;var t=De(),e=mi(),r=t("iterator"),n=Array.prototype;return ii=function(t){return void 0!==t&&(e.Array===t||n[r]===t)}}function xi(){if(ci)return ui;ci=1;var t=Vn(),e=oe(),r=qt(),n=mi(),o=De()("iterator");return ui=function(i){if(!r(i))return e(i,o)||e(i,"@@iterator")||n[t(i)]}}function Si(){if(fi)return li;fi=1;var t=K(),e=ne(),r=Ze(),n=re(),o=xi(),i=TypeError;return li=function(a,u){var c=arguments.length<2?o(a):u;if(e(c))return r(t(c,a));throw new i(n(a)+" is not iterable")},li}function Ni(){if(hi)return di;hi=1;var t=De()("iterator"),e=!1;try{var r=0,n={next:function(){return{done:!!r++}},return:function(){e=!0}};n[t]=function(){return this},Array.from(n,function(){throw 2})}catch(t){}return di=function(r,n){try{if(!n&&!e)return!1}catch(t){return!1}var o=!1;try{var i={};i[t]=function(){return{next:function(){return{done:o=!0}}}},r(i)}catch(t){}return o}}!function(){if(pi)return gi;pi=1;var t=In(),e=function(){if(vi)return si;vi=1;var t=eo(),e=K(),r=Pe(),n=bi(),o=wi(),i=Dn(),a=Ur(),u=Pn(),c=Si(),l=xi(),f=Array;return si=function(s){var v=r(s),d=i(this),h=arguments.length,p=h>1?arguments[1]:void 0,g=void 0!==p;g&&(p=t(p,h>2?arguments[2]:void 0));var y,b,m,w,x,S,N=l(v),M=0;if(!N||this===f&&o(N))for(y=a(v),b=d?new this(y):f(y);y>M;M++)S=g?p(v[M],M):v[M],u(b,M,S);else for(b=d?new this:[],x=(w=c(v,N)).next;!(m=e(x,w)).done;M++)S=g?n(w,p,[m.value,M],!0):m.value,u(b,M,S);return b.length=M,b},si}();t({target:"Array",stat:!0,forced:!Ni()(function(t){Array.from(t)})},{from:e})}();var Mi,Ti,zi,Ei,ki,Oi,Ai,Ci,Ii,Hi,ji,Pi={};function Ri(){if(Ti)return Mi;Ti=1;var t=Ze();return Mi=function(){var e=t(this),r="";return e.hasIndices&&(r+="d"),e.global&&(r+="g"),e.ignoreCase&&(r+="i"),e.multiline&&(r+="m"),e.dotAll&&(r+="s"),e.unicode&&(r+="u"),e.unicodeSets&&(r+="v"),e.sticky&&(r+="y"),r}}function Vi(){if(Ei)return zi;Ei=1;var t=U(),e=V().RegExp,r=t(function(){var t=e("a","y");return t.lastIndex=2,null!==t.exec("abcd")}),n=r||t(function(){return!e("a","y").sticky}),o=r||t(function(){var t=e("^r","gy");return t.lastIndex=2,null!==t.exec("str")});return zi={BROKEN_CARET:o,MISSED_STICKY:n,UNSUPPORTED_Y:r}}function Di(){if(Hi)return Ii;Hi=1;var t,e,r=K(),n=Wt(),o=$o(),i=Ri(),a=Vi(),u=je(),c=Io(),l=Nr().get,f=function(){if(Oi)return ki;Oi=1;var t=U(),e=V().RegExp;return ki=t(function(){var t=e(".","s");return!(t.dotAll&&t.test("\n")&&"s"===t.flags)})}(),s=function(){if(Ci)return Ai;Ci=1;var t=U(),e=V().RegExp;return Ai=t(function(){var t=e("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")})}(),v=u("native-string-replace",String.prototype.replace),d=RegExp.prototype.exec,h=d,p=n("".charAt),g=n("".indexOf),y=n("".replace),b=n("".slice),m=(e=/b*/g,r(d,t=/a/,"a"),r(d,e,"a"),0!==t.lastIndex||0!==e.lastIndex),w=a.BROKEN_CARET,x=void 0!==/()??/.exec("")[1];return(m||x||w||f||s)&&(h=function(t){var e,n,a,u,f,s,S,N=this,M=l(N),T=o(t),z=M.raw;if(z)return z.lastIndex=N.lastIndex,e=r(h,z,T),N.lastIndex=z.lastIndex,e;var E=M.groups,k=w&&N.sticky,O=r(i,N),A=N.source,C=0,I=T;if(k&&(O=y(O,"y",""),-1===g(O,"g")&&(O+="g"),I=b(T,N.lastIndex),N.lastIndex>0&&(!N.multiline||N.multiline&&"\n"!==p(T,N.lastIndex-1))&&(A="(?: "+A+")",I=" "+I,C++),n=new RegExp("^(?:"+A+")",O)),x&&(n=new RegExp("^"+A+"$(?!\\s)",O)),m&&(a=N.lastIndex),u=r(d,k?n:N,I),k?u?(u.input=b(u.input,C),u[0]=b(u[0],C),u.index=N.lastIndex,N.lastIndex+=u[0].length):N.lastIndex=0:m&&u&&(N.lastIndex=N.global?u.index+u[0].length:a),x&&u&&u.length>1&&r(v,u[0],n,function(){for(f=1;f<arguments.length-2;f++)void 0===arguments[f]&&(u[f]=void 0)}),u&&E)for(u.groups=s=c(null),f=0;f<E.length;f++)s[(S=E[f])[0]]=u[S[1]];return u}),Ii=h}function Li(){if(ji)return Pi;ji=1;var t=In(),e=Di();return t({target:"RegExp",proto:!0,forced:/./.exec!==e},{exec:e}),Pi}Li();var Bi,Wi,_i,Fi,qi,$i,Gi,Ui,Yi,Xi,Ki,Ji,Qi,Zi,ta,ea,ra,na,oa,ia,aa,ua,ca,la,fa,sa={};function va(){if(Wi)return Bi;Wi=1;var t=Wt(),e=qr(),r=$o(),n=$t(),o=t("".charAt),i=t("".charCodeAt),a=t("".slice),u=function(t){return function(u,c){var l,f,s=r(n(u)),v=e(c),d=s.length;return v<0||v>=d?t?"":void 0:(l=i(s,v))<55296||l>56319||v+1===d||(f=i(s,v+1))<56320||f>57343?t?o(s,v):l:t?a(s,v,v+2):f-56320+(l-55296<<10)+65536}};return Bi={codeAt:u(!1),charAt:u(!0)}}function da(){if($i)return qi;$i=1;var t=Re(),e=Ut(),r=Pe(),n=xr(),o=function(){if(Fi)return _i;Fi=1;var t=U();return _i=!t(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})}(),i=n("IE_PROTO"),a=Object,u=a.prototype;return qi=o?a.getPrototypeOf:function(n){var o=r(n);if(t(o,i))return o[i];var c=o.constructor;return e(c)&&o instanceof c?c.prototype:o instanceof a?u:null}}function ha(){if(Ui)return Gi;Ui=1;var t,e,r,n=U(),o=Ut(),i=Yt(),a=Io(),u=da(),c=Tr(),l=De(),f=Ce(),s=l("iterator"),v=!1;return[].keys&&("next"in(r=[].keys())?(e=u(u(r)))!==Object.prototype&&(t=e):v=!0),!i(t)||n(function(){var e={};return t[s].call(e)!==e})?t={}:f&&(t=a(t)),o(t[s])||c(t,s,function(){return this}),Gi={IteratorPrototype:t,BUGGY_SAFARI_ITERATORS:v}}function pa(){if(Xi)return Yi;Xi=1;var t=tr().f,e=Re(),r=De()("toStringTag");return Yi=function(n,o,i){n&&!i&&(n=n.prototype),n&&!e(n,r)&&t(n,r,{configurable:!0,value:o})}}function ga(){if(ea)return ta;ea=1;var t=Yt();return ta=function(e){return t(e)||null===e}}function ya(){if(na)return ra;na=1;var t=ga(),e=String,r=TypeError;return ra=function(n){if(t(n))return n;throw new r("Can't set "+e(n)+" as a prototype")}}function ba(){if(ia)return oa;ia=1;var t=function(){if(Zi)return Qi;Zi=1;var t=Wt(),e=ne();return Qi=function(r,n,o){try{return t(e(Object.getOwnPropertyDescriptor(r,n)[o]))}catch(t){}}}(),e=Yt(),r=$t(),n=ya();return oa=Object.setPrototypeOf||("__proto__"in{}?function(){var o,i=!1,a={};try{(o=t(Object.prototype,"__proto__","set"))(a,[]),i=a instanceof Array}catch(t){}return function(t,a){return r(t),n(a),e(t)?(i?o(t,a):t.__proto__=a,t):t}}():void 0)}function ma(){if(ua)return aa;ua=1;var t=In(),e=K(),r=Ce(),n=br(),o=Ut(),i=function(){if(Ji)return Ki;Ji=1;var t=ha().IteratorPrototype,e=Io(),r=Bt(),n=pa(),o=mi(),i=function(){return this};return Ki=function(a,u,c,l){var f=u+" Iterator";return a.prototype=e(t,{next:r(+!l,c)}),n(a,f,!1,!0),o[f]=i,a}}(),a=da(),u=ba(),c=pa(),l=er(),f=Tr(),s=De(),v=mi(),d=ha(),h=n.PROPER,p=n.CONFIGURABLE,g=d.IteratorPrototype,y=d.BUGGY_SAFARI_ITERATORS,b=s("iterator"),m="keys",w="values",x="entries",S=function(){return this};return aa=function(n,s,d,N,M,T,z){i(d,s,N);var E,k,O,A=function(t){if(t===M&&P)return P;if(!y&&t&&t in H)return H[t];switch(t){case m:case w:case x:return function(){return new d(this,t)}}return function(){return new d(this)}},C=s+" Iterator",I=!1,H=n.prototype,j=H[b]||H["@@iterator"]||M&&H[M],P=!y&&j||A(M),R="Array"===s&&H.entries||j;if(R&&(E=a(R.call(new n)))!==Object.prototype&&E.next&&(r||a(E)===g||(u?u(E,g):o(E[b])||f(E,b,S)),c(E,C,!0,!0),r&&(v[C]=S)),h&&M===w&&j&&j.name!==w&&(!r&&p?l(H,"name",w):(I=!0,P=function(){return e(j,this)})),M)if(k={values:A(w),keys:T?P:A(m),entries:A(x)},z)for(O in k)(y||I||!(O in H))&&f(H,O,k[O]);else t({target:s,proto:!0,forced:y||I},k);return r&&!z||H[b]===P||f(H,b,P,{name:M}),v[s]=P,k}}function wa(){return la?ca:(la=1,ca=function(t,e){return{value:t,done:e}})}!function(){if(fa)return sa;fa=1;var t=va().charAt,e=$o(),r=Nr(),n=ma(),o=wa(),i="String Iterator",a=r.set,u=r.getterFor(i);n(String,"String",function(t){a(this,{type:i,string:e(t),index:0})},function(){var e,r=u(this),n=r.string,i=r.index;return i>=n.length?o(void 0,!0):(e=t(n,i),r.index+=e.length,o(e,!1))})}();var xa,Sa,Na,Ma,Ta,za,Ea,ka={};function Oa(){return Sa?xa:(Sa=1,xa={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0})}function Aa(){if(Ma)return Na;Ma=1;var t=We()("span").classList,e=t&&t.constructor&&t.constructor.prototype;return Na=e===Object.prototype?void 0:e}!function(){if(Ea)return ka;Ea=1;var t=V(),e=Oa(),r=Aa(),n=function(){if(za)return Ta;za=1;var t=ro().forEach,e=Gn()("forEach");return Ta=e?[].forEach:function(e){return t(this,e,arguments.length>1?arguments[1]:void 0)},Ta}(),o=er(),i=function(t){if(t&&t.forEach!==n)try{o(t,"forEach",n)}catch(e){t.forEach=n}};for(var a in e)e[a]&&i(t[a]&&t[a].prototype);i(r)}();var Ca,Ia,Ha,ja,Pa,Ra,Va,Da={};function La(){return Ia?Ca:(Ia=1,Ca="\t\n\v\f\r                　\u2028\u2029\ufeff")}function Ba(){if(ja)return Ha;ja=1;var t=Wt(),e=$t(),r=$o(),n=La(),o=t("".replace),i=RegExp("^["+n+"]+"),a=RegExp("(^|[^"+n+"])["+n+"]+$"),u=function(t){return function(n){var u=r(e(n));return 1&t&&(u=o(u,i,"")),2&t&&(u=o(u,a,"$1")),u}};return Ha={start:u(1),end:u(2),trim:u(3)}}!function(){if(Va)return Da;Va=1;var t=In(),e=Ba().trim,r=function(){if(Ra)return Pa;Ra=1;var t=br().PROPER,e=U(),r=La();return Pa=function(n){return e(function(){return!!r[n]()||"​᠎"!=="​᠎"[n]()||t&&r[n].name!==n})}}();t({target:"String",proto:!0,forced:r("trim")},{trim:function(){return e(this)}})}();var Wa,_a,Fa,qa,$a={};function Ga(t){return t.length?t[0].tagName.toLowerCase():""}function Ua(t,e){for(var r="",n=(t.attr("style")||"").split(";"),o=n.length,i=0;i<o;i+=1){var a=n[i];if(a){var u=a.split(":");u[0].trim()===e&&(r=u[1].trim())}}return r}function Ya(){if(qa)return Fa;qa=1;var t=Gt(),e=Ho(),r=mi(),n=Nr(),o=tr().f,i=ma(),a=wa(),u=Ce(),c=Y(),l="Array Iterator",f=n.set,s=n.getterFor(l);Fa=i(Array,"Array",function(e,r){f(this,{type:l,target:t(e),index:0,kind:r})},function(){var t=s(this),e=t.target,r=t.index++;if(!e||r>=e.length)return t.target=null,a(void 0,!0);switch(t.kind){case"keys":return a(r,!1);case"values":return a(e[r],!1)}return a([r,e[r]],!1)},"values");var v=r.Arguments=r.Array;if(e("keys"),e("values"),e("entries"),!u&&c&&"values"!==v.name)try{o(v,"name",{value:"values"})}catch(t){}return Fa}_a||(_a=1,function(){if(Wa)return $a;Wa=1;var t=In(),e=V();t({global:!0,forced:e.globalThis!==e},{globalThis:e})}()),h&&d.fn&&(d.fn.append=h),p&&d.fn&&(d.fn.on=p),g&&d.fn&&(d.fn.focus=g),y&&d.fn&&(d.fn.attr=y),b&&d.fn&&(d.fn.val=b),m&&d.fn&&(d.fn.html=m),w&&d.fn&&(d.fn.dataset=w),x&&d.fn&&(d.fn.addClass=x),S&&d.fn&&(d.fn.removeClass=S),N&&d.fn&&(d.fn.children=N),M&&d.fn&&(d.fn.each=M),T&&d.fn&&(d.fn.find=T),z&&d.fn&&(d.fn.data=z),E&&d.fn&&(d.fn.hide=E),k&&d.fn&&(d.fn.show=k),Ya();var Xa,Ka,Ja,Qa,Za={};function tu(){if(Ka)return Xa;Ka=1;var t=U();return Xa=!t(function(){return Object.isExtensible(Object.preventExtensions({}))})}function eu(){if(Qa)return Ja;Qa=1;var t=Tr();return Ja=function(e,r,n){for(var o in r)t(e,o,r[o],n);return e}}var ru,nu,ou,iu,au,uu,cu,lu,fu,su,vu,du,hu,pu,gu,yu,bu,mu,wu,xu,Su={exports:{}},Nu={};function Mu(){if(nu)return ru;nu=1;var t=Wt();return ru=t([].slice)}function Tu(){if(ou)return Nu;ou=1;var t=_t(),e=Gt(),r=Jr().f,n=Mu(),o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];return Nu.f=function(i){return o&&"Window"===t(i)?function(t){try{return r(t)}catch(t){return n(o)}}(i):r(e(i))},Nu}function zu(){if(cu)return uu;cu=1;var t=U(),e=Yt(),r=_t(),n=function(){if(au)return iu;au=1;var t=U();return iu=t(function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}})}(),o=Object.isExtensible,i=t(function(){});return uu=i||n?function(t){return!!e(t)&&((!n||"ArrayBuffer"!==r(t))&&(!o||o(t)))}:o}function Eu(){if(lu)return Su.exports;lu=1;var t=In(),e=Wt(),r=Sr(),n=Yt(),o=Re(),i=tr().f,a=Jr(),u=Tu(),c=zu(),l=Ve(),f=tu(),s=!1,v=l("meta"),d=0,h=function(t){i(t,v,{value:{objectID:"O"+d++,weakData:{}}})},p=Su.exports={enable:function(){p.enable=function(){},s=!0;var r=a.f,n=e([].splice),o={};o[v]=1,r(o).length&&(a.f=function(t){for(var e=r(t),o=0,i=e.length;o<i;o++)if(e[o]===v){n(e,o,1);break}return e},t({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:u.f}))},fastKey:function(t,e){if(!n(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,v)){if(!c(t))return"F";if(!e)return"E";h(t)}return t[v].objectID},getWeakData:function(t,e){if(!o(t,v)){if(!c(t))return!0;if(!e)return!1;h(t)}return t[v].weakData},onFreeze:function(t){return f&&s&&c(t)&&!o(t,v)&&h(t),t}};return r[v]=!0,Su.exports}function ku(){if(su)return fu;su=1;var t=eo(),e=K(),r=Ze(),n=re(),o=wi(),i=Ur(),a=Kt(),u=Si(),c=xi(),l=yi(),f=TypeError,s=function(t,e){this.stopped=t,this.result=e},v=s.prototype;return fu=function(d,h,p){var g,y,b,m,w,x,S,N=p&&p.that,M=!(!p||!p.AS_ENTRIES),T=!(!p||!p.IS_RECORD),z=!(!p||!p.IS_ITERATOR),E=!(!p||!p.INTERRUPTED),k=t(h,N),O=function(t){return g&&l(g,"normal"),new s(!0,t)},A=function(t){return M?(r(t),E?k(t[0],t[1],O):k(t[0],t[1])):E?k(t,O):k(t)};if(T)g=d.iterator;else if(z)g=d;else{if(!(y=c(d)))throw new f(n(d)+" is not iterable");if(o(y)){for(b=0,m=i(d);m>b;b++)if((w=A(d[b]))&&a(v,w))return w;return new s(!1)}g=u(d,y)}for(x=T?d.next:g.next;!(S=e(x,g)).done;){try{w=A(S.value)}catch(t){l(g,"throw",t)}if("object"==typeof w&&w&&a(v,w))return w}return new s(!1)}}function Ou(){if(du)return vu;du=1;var t=Kt(),e=TypeError;return vu=function(r,n){if(t(n,r))return r;throw new e("Incorrect invocation")}}function Au(){if(pu)return hu;pu=1;var t=Ut(),e=Yt(),r=ba();return hu=function(n,o,i){var a,u;return r&&t(a=o.constructor)&&a!==i&&e(u=a.prototype)&&u!==i.prototype&&r(n,u),n}}function Cu(){if(yu)return gu;yu=1;var t=In(),e=V(),r=Wt(),n=Cn(),o=Tr(),i=Eu(),a=ku(),u=Ou(),c=Ut(),l=qt(),f=Yt(),s=U(),v=Ni(),d=pa(),h=Au();return gu=function(p,g,y){var b=-1!==p.indexOf("Map"),m=-1!==p.indexOf("Weak"),w=b?"set":"add",x=e[p],S=x&&x.prototype,N=x,M={},T=function(t){var e=r(S[t]);o(S,t,"add"===t?function(t){return e(this,0===t?0:t),this}:"delete"===t?function(t){return!(m&&!f(t))&&e(this,0===t?0:t)}:"get"===t?function(t){return m&&!f(t)?void 0:e(this,0===t?0:t)}:"has"===t?function(t){return!(m&&!f(t))&&e(this,0===t?0:t)}:function(t,r){return e(this,0===t?0:t,r),this})};if(n(p,!c(x)||!(m||S.forEach&&!s(function(){(new x).entries().next()}))))N=y.getConstructor(g,p,b,w),i.enable();else if(n(p,!0)){var z=new N,E=z[w](m?{}:-0,1)!==z,k=s(function(){z.has(1)}),O=v(function(t){new x(t)}),A=!m&&s(function(){for(var t=new x,e=5;e--;)t[w](e,e);return!t.has(-0)});O||((N=g(function(t,e){u(t,S);var r=h(new x,t,N);return l(e)||a(e,r[w],{that:r,AS_ENTRIES:b}),r})).prototype=S,S.constructor=N),(k||A)&&(T("delete"),T("has"),b&&T("get")),(A||E)&&T(w),m&&S.clear&&delete S.clear}return M[p]=N,t({global:!0,constructor:!0,forced:N!==x},M),d(N,p),m||y.setStrong(N,p,b),N}}function Iu(){if(mu)return bu;mu=1;var t=Wt(),e=eu(),r=Eu().getWeakData,n=Ou(),o=Ze(),i=qt(),a=Yt(),u=ku(),c=ro(),l=Re(),f=Nr(),s=f.set,v=f.getterFor,d=c.find,h=c.findIndex,p=t([].splice),g=0,y=function(t){return t.frozen||(t.frozen=new b)},b=function(){this.entries=[]},m=function(t,e){return d(t.entries,function(t){return t[0]===e})};return b.prototype={get:function(t){var e=m(this,t);if(e)return e[1]},has:function(t){return!!m(this,t)},set:function(t,e){var r=m(this,t);r?r[1]=e:this.entries.push([t,e])},delete:function(t){var e=h(this.entries,function(e){return e[0]===t});return~e&&p(this.entries,e,1),!!~e}},bu={getConstructor:function(t,c,f,d){var h=t(function(t,e){n(t,p),s(t,{type:c,id:g++,frozen:null}),i(e)||u(e,t[d],{that:t,AS_ENTRIES:f})}),p=h.prototype,b=v(c),m=function(t,e,n){var i=b(t),a=r(o(e),!0);return!0===a?y(i).set(e,n):a[i.id]=n,t};return e(p,{delete:function(t){var e=b(this);if(!a(t))return!1;var n=r(t);return!0===n?y(e).delete(t):n&&l(n,e.id)&&delete n[e.id]},has:function(t){var e=b(this);if(!a(t))return!1;var n=r(t);return!0===n?y(e).has(t):n&&l(n,e.id)}}),e(p,f?{get:function(t){var e=b(this);if(a(t)){var n=r(t);if(!0===n)return y(e).get(t);if(n)return n[e.id]}},set:function(t,e){return m(this,t,e)}}:{add:function(t){return m(this,t,!0)}}),h}},bu}xu||(xu=1,function(){if(wu)return Za;wu=1;var t,e=tu(),r=V(),n=Wt(),o=eu(),i=Eu(),a=Cu(),u=Iu(),c=Yt(),l=Nr().enforce,f=U(),s=wr(),v=Object,d=Array.isArray,h=v.isExtensible,p=v.isFrozen,g=v.isSealed,y=v.freeze,b=v.seal,m=!r.ActiveXObject&&"ActiveXObject"in r,w=function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},x=a("WeakMap",w,u),S=x.prototype,N=n(S.set);if(s)if(m){t=u.getConstructor(w,"WeakMap",!0),i.enable();var M=n(S.delete),T=n(S.has),z=n(S.get);o(S,{delete:function(e){if(c(e)&&!h(e)){var r=l(this);return r.frozen||(r.frozen=new t),M(this,e)||r.frozen.delete(e)}return M(this,e)},has:function(e){if(c(e)&&!h(e)){var r=l(this);return r.frozen||(r.frozen=new t),T(this,e)||r.frozen.has(e)}return T(this,e)},get:function(e){if(c(e)&&!h(e)){var r=l(this);return r.frozen||(r.frozen=new t),T(this,e)?z(this,e):r.frozen.get(e)}return z(this,e)},set:function(e,r){if(c(e)&&!h(e)){var n=l(this);n.frozen||(n.frozen=new t),T(this,e)?N(this,e,r):n.frozen.set(e,r)}else N(this,e,r);return this}})}else e&&f(function(){var t=y([]);return N(new x,t,1),!p(t)})&&o(S,{set:function(t,e){var r;return d(t)&&(p(t)?r=y:g(t)&&(r=b)),N(this,t,e),r&&r(t),this}})}());var Hu,ju={};!function(){if(Hu)return ju;Hu=1;var t=V(),e=Oa(),r=Aa(),n=Ya(),o=er(),i=pa(),a=De()("iterator"),u=n.values,c=function(t,r){if(t){if(t[a]!==u)try{o(t,a,u)}catch(e){t[a]=u}if(i(t,r,!0),e[r])for(var c in n)if(t[c]!==n[c])try{o(t,c,n[c])}catch(e){t[c]=n[c]}}};for(var l in e)c(t[l]&&t[l].prototype,l);c(r,"DOMTokenList")}();var Pu,Ru,Vu,Du,Lu,Bu,Wu,_u,Fu,qu,$u,Gu=new WeakMap,Uu=new WeakMap,Yu=function(){function t(){this.title=r("tableModule.tableProperty"),this.iconSvg='<svg viewBox="0 0 20 20"><path d="M8 2v5h4V2h1v5h5v1h-5v4h.021l-.172.351-1.916.28-.151.027c-.287.063-.54.182-.755.341L8 13v5H7v-5H2v-1h5V8H2V7h5V2h1zm4 6H8v4h4V8z" opacity=".6"/><path d="m15.5 11.5 1.323 2.68 2.957.43-2.14 2.085.505 2.946L15.5 18.25l-2.645 1.39.505-2.945-2.14-2.086 2.957-.43L15.5 11.5zM17 1a2 2 0 0 1 2 2v9.475l-.85-.124-.857-1.736a2.048 2.048 0 0 0-.292-.44L17 3H3v14h7.808l.402.392L10.935 19H3a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h14z"/></svg>',this.tag="button",this.showModal=!0,this.modalWidth=300,this.menu="table",this.borderStyle=[{value:"none",label:r("tableModule.borderStyle.none")},{value:"solid",label:r("tableModule.borderStyle.solid")},{value:"dotted",label:r("tableModule.borderStyle.dotted")},{value:"dashed",label:r("tableModule.borderStyle.dashed")},{value:"double",label:r("tableModule.borderStyle.double")},{value:"groove",label:r("tableModule.borderStyle.groove")},{value:"ridge",label:r("tableModule.borderStyle.ridge")},{value:"inset",label:r("tableModule.borderStyle.inset")},{value:"outset",label:r("tableModule.borderStyle.outset")}],this.textAlignOptions=[{value:"left",label:r("justify.left"),svg:'<svg viewBox="0 0 1024 1024"><path d="M768 793.6v102.4H51.2v-102.4h716.8z m204.8-230.4v102.4H51.2v-102.4h921.6z m-204.8-230.4v102.4H51.2v-102.4h716.8zM972.8 102.4v102.4H51.2V102.4h921.6z"></path></svg>'},{value:"center",label:r("justify.center"),svg:'<svg viewBox="0 0 1024 1024"><path d="M870.4 793.6v102.4H153.6v-102.4h716.8z m102.4-230.4v102.4H51.2v-102.4h921.6z m-102.4-230.4v102.4H153.6v-102.4h716.8zM972.8 102.4v102.4H51.2V102.4h921.6z"></path></svg>'},{value:"right",label:r("justify.right"),svg:'<svg viewBox="0 0 1024 1024"><path d="M972.8 793.6v102.4H256v-102.4h716.8z m0-230.4v102.4H51.2v-102.4h921.6z m0-230.4v102.4H256v-102.4h716.8zM972.8 102.4v102.4H51.2V102.4h921.6z"></path></svg>'},{value:"justify",label:r("justify.justify"),svg:'<svg viewBox="0 0 1024 1024"><path d="M0 64h1024v128H0z m0 192h1024v128H0z m0 192h1024v128H0z m0 192h1024v128H0z m0 192h1024v128H0z"></path></svg>'}]}return t.prototype.getValue=function(t){return""},t.prototype.isActive=function(t){return!1},t.prototype.isDisabled=function(t){return null==e.getSelectedNodeByType(t,"table")},t.prototype.exec=function(t,e){},t.prototype.getModalContentNode=function(t){return po(i.nodes(t,{match:Uo(t,"table")}),1)[0]},t.prototype.getModalPositionNode=function(t){return null},t.prototype.getModalContentElem=function(t){var e=this,n=this.getModalContentNode(t);if(!n)return null;var o=po(n,2),i=o[0],a=o[1],c=d('<div>\n      <label class="babel-container">\n        <span>'.concat(r("tableModule.modal.border"),'</span>\n        <span class="babel-container-border">\n          <select name="borderStyle">\n            ').concat(this.borderStyle.map(function(t){return'<option value="'.concat(t.value,'">').concat(t.label,"</option>")}).join(""),'\n          </select>\n          <span class="color-group" data-mark="color">\n            <span class="color-group-block"></span>\n            <input name="borderColor" type="hidden">\n          </span>\n          <input name="borderWidth" type="number" placeholder="').concat(r("tableModule.modal.borderWidth"),'">\n        </span>\n      </label>\n      <div class="babel-container">\n        <span>').concat(r("tableModule.modal.bgColor"),'</span>\n        <span class="babel-container-background">\n          <span class="color-group" data-mark="bgColor">\n            <span class="color-group-block"></span>\n            <input name="backgroundColor" type="hidden">\n          </span>\n        </span>\n      </div>\n      <label class="babel-container">\n        <span>').concat(r("tableModule.modal.align"),'</span>\n        <span class="babel-container-align">\n          <select name="textAlign">\n            ').concat(this.textAlignOptions.map(function(t){return'<option value="'.concat(t.value,'">').concat(t.label,"</option>")}).join(""),'\n          </select>\n        </span>\n      </label>\n      <div class="button-container">\n        <button type="button">').concat(r("tableModule.modal.ok"),"</button>\n      </div>\n    </div>"));c.find("[name]").each(function(t){d(t).val(i[d(t).attr("name")])});var l=function(t,e){e?d(".color-group-block",t).css("background-color",e).empty():d(".color-group-block",t).css("background-color","").html(Eo)};return c.find(".color-group").each(function(r){var n=d('[type="hidden"]',r).val()||"";l(r,n);var o=d(r);o.on("click",function(){c.find(".color-group .w-e-drop-panel").hide();var i=o.data("panel");i?i.show():(i=e.getPanelContentElem(t,{mark:o.data("mark"),selectedColor:n,callback:function(t){d('[type="hidden"]',r).val(t||""),l(r,t),i.hide()}}),o.append(i),o.data("panel",i))})}),c.find("button").on("click",function(){var r=Array.from(c.find("[name]")).reduce(function(t,e){return t[d(e).attr("name")]=d(e).val(),t},{}),n=Gu.get(t);"cell"===e.menu&&(null==n?void 0:n.length)?n.forEach(function(e){e.forEach(function(e){u.setNodes(t,r,{at:e[0][1]})})}):u.setNodes(t,r,{at:a}),setTimeout(function(){t.focus()})}),c[0]},t.prototype.getPanelContentElem=function(t,e){var n=e.mark,o=e.selectedColor,i=e.callback,a=d('<ul class="w-e-panel-content-color"></ul>');a.on("click","li",function(t){var e=t.target;if(e){t.preventDefault(),t.stopPropagation();var r=d(e).attr("data-value");i(r)}});var u=t.getMenuConfig(n).colors;(void 0===u?[]:u).forEach(function(t){var e=d('<div class="color-block" data-value="'.concat(t,'"></div>'));e.css("background-color",t);var r=d('<li data-value="'.concat(t,'"></li>'));o===t&&r.addClass("active"),r.append(e),a.append(r)});var c="";"color"===n&&(c=r("tableModule.color.default")),"bgColor"===n&&(c=r("tableModule.color.clear"));var l=d('\n      <li data-value="" class="clear">\n        '.concat(Eo,"\n        ").concat(c,"\n      </li>\n    "));a.prepend(l);var f=d('<div class="w-e-drop-panel"></div>');return f.append(a),f},t}(),Xu=function(t){function e(){var e=t.apply(this,go([],po(arguments),!1))||this;return e.title=r("tableModule.cellProperty"),e.iconSvg='<svg viewBox="0 0 20 20"><path d="m11.105 18-.17 1H2.5A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1h15A1.5 1.5 0 0 1 19 2.5v9.975l-.85-.124-.15-.302V8h-5v4h.021l-.172.351-1.916.28-.151.027c-.287.063-.54.182-.755.341L8 13v5h3.105zM2 12h5V8H2v4zm10-4H8v4h4V8zM2 2v5h5V2H2zm0 16h5v-5H2v5zM13 7h5V2h-5v5zM8 2v5h4V2H8z" opacity=".6"/><path d="m15.5 11.5 1.323 2.68 2.957.43-2.14 2.085.505 2.946L15.5 18.25l-2.645 1.39.505-2.945-2.14-2.086 2.957-.43L15.5 11.5zM13 6a1 1 0 0 1 1 1v3.172a2.047 2.047 0 0 0-.293.443l-.858 1.736-1.916.28-.151.027A1.976 1.976 0 0 0 9.315 14H7a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h6zm-1 2H8v4h4V8z"/></svg>',e.tag="button",e.showModal=!0,e.modalWidth=300,e.menu="cell",e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}fo(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),e.prototype.getModalContentNode=function(t){return po(i.nodes(t,{match:Uo(t,"td")}),1)[0]},e}(Yu),Ku={};function Ju(){if(Ru)return Pu;Ru=1;var t=re(),e=TypeError;return Pu=function(r,n){if(!delete r[n])throw new e("Cannot delete property "+t(n)+" of "+t(r))}}!function(){if($u)return Ku;$u=1;var t=In(),e=Wt(),r=ne(),n=Pe(),o=Ur(),i=Ju(),a=$o(),u=U(),c=function(){if(Du)return Vu;Du=1;var t=Mu(),e=Math.floor,r=function(n,o){var i=n.length;if(i<8)for(var a,u,c=1;c<i;){for(u=c,a=n[c];u&&o(n[u-1],a)>0;)n[u]=n[--u];u!==c++&&(n[u]=a)}else for(var l=e(i/2),f=r(t(n,0,l),o),s=r(t(n,l),o),v=f.length,d=s.length,h=0,p=0;h<v||p<d;)n[h+p]=h<v&&p<d?o(f[h],s[p])<=0?f[h++]:s[p++]:h<v?f[h++]:s[p++];return n};return Vu=r}(),l=Gn(),f=function(){if(Bu)return Lu;Bu=1;var t=Jt().match(/firefox\/(\d+)/i);return Lu=!!t&&+t[1]}(),s=function(){if(_u)return Wu;_u=1;var t=Jt();return Wu=/MSIE|Trident/.test(t)}(),v=Qt(),d=function(){if(qu)return Fu;qu=1;var t=Jt().match(/AppleWebKit\/(\d+)\./);return Fu=!!t&&+t[1]}(),h=[],p=e(h.sort),g=e(h.push),y=u(function(){h.sort(void 0)}),b=u(function(){h.sort(null)}),m=l("sort"),w=!u(function(){if(v)return v<70;if(!(f&&f>3)){if(s)return!0;if(d)return d<603;var t,e,r,n,o="";for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:r=3;break;case 68:case 71:r=4;break;default:r=2}for(n=0;n<47;n++)h.push({k:e+n,v:r})}for(h.sort(function(t,e){return e.v-t.v}),n=0;n<h.length;n++)e=h[n].k.charAt(0),o.charAt(o.length-1)!==e&&(o+=e);return"DGBEFHACIJK"!==o}});t({target:"Array",proto:!0,forced:y||!b||!m||!w},{sort:function(t){void 0!==t&&r(t);var e=n(this);if(w)return void 0===t?p(e):p(e,t);var u,l,f=[],s=o(e);for(l=0;l<s;l++)l in e&&g(f,e[l]);for(c(f,function(t){return function(e,r){return void 0===r?-1:void 0===e?1:void 0!==t?+t(e,r)||0:a(e)>a(r)?1:-1}}(t)),u=o(f),l=0;l<u;)e[l]=f[l++];for(;l<s;)i(e,l++);return e}})}();var Qu,Zu,tc,ec={};!function(){if(tc)return ec;tc=1;var t=In(),e=Pe(),r=$r(),n=qr(),o=Ur(),i=function(){if(Zu)return Qu;Zu=1;var t=Y(),e=Hn(),r=TypeError,n=Object.getOwnPropertyDescriptor,o=t&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}();return Qu=o?function(t,o){if(e(t)&&!n(t,"length").writable)throw new r("Cannot set read only .length");return t.length=o}:function(t,e){return t.length=e}}(),a=jn(),u=Bn(),c=Pn(),l=Ju(),f=Wn()("splice"),s=Math.max,v=Math.min;t({target:"Array",proto:!0,forced:!f},{splice:function(t,f){var d,h,p,g,y,b,m=e(this),w=o(m),x=r(t,w),S=arguments.length;for(0===S?d=h=0:1===S?(d=0,h=w-x):(d=S-2,h=v(s(n(f),0),w-x)),a(w+d-h),p=u(m,h),g=0;g<h;g++)(y=x+g)in m&&c(p,g,m[y]);if(p.length=h,d<h){for(g=x;g<w-h;g++)b=g+d,(y=g+h)in m?m[b]=m[y]:l(m,b);for(g=w;g>w-h+d;g--)l(m,g-1)}else if(d>h)for(g=w-h;g>x;g--)b=g+d-1,(y=g+h-1)in m?m[b]=m[y]:l(m,b);for(g=0;g<d;g++)m[g+x]=arguments[g+2];return i(m,w-h+d),p}})}();var rc,nc,oc,ic,ac,uc={};function cc(){if(nc)return rc;nc=1;var t=V();return rc=t}function lc(){if(ic)return oc;ic=1;var t=Wt();return oc=t(1.1.valueOf)}!function(){if(ac)return uc;ac=1;var t=In(),e=Ce(),r=Y(),n=V(),o=cc(),i=Wt(),a=Cn(),u=Re(),c=Au(),l=Kt(),f=ee(),s=Le(),v=U(),d=Jr().f,h=Fe().f,p=tr().f,g=lc(),y=Ba().trim,b="Number",m=n[b],w=o[b],x=m.prototype,S=n.TypeError,N=i("".slice),M=i("".charCodeAt),T=function(t){var e,r,n,o,i,a,u,c,l=s(t,"number");if(f(l))throw new S("Cannot convert a Symbol value to a number");if("string"==typeof l&&l.length>2)if(l=y(l),43===(e=M(l,0))||45===e){if(88===(r=M(l,2))||120===r)return NaN}else if(48===e){switch(M(l,1)){case 66:case 98:n=2,o=49;break;case 79:case 111:n=8,o=55;break;default:return+l}for(a=(i=N(l,2)).length,u=0;u<a;u++)if((c=M(i,u))<48||c>o)return NaN;return parseInt(i,n)}return+l},z=a(b,!m(" 0o1")||!m("0b1")||m("+0x1")),E=function(t){var e,r=arguments.length<1?0:m(function(t){var e=s(t,"number");return"bigint"==typeof e?e:T(e)}(t));return l(x,e=this)&&v(function(){g(e)})?c(Object(r),this,E):r};E.prototype=x,z&&!e&&(x.constructor=E),t({global:!0,constructor:!0,wrap:!0,forced:z},{Number:E});var k=function(t,e){for(var n,o=r?d(e):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),i=0;o.length>i;i++)u(e,n=o[i])&&!u(t,n)&&p(t,n,h(e,n))};e&&w&&k(o[b],w),(z||e)&&k(o[b],m)}();var fc,sc,vc,dc,hc,pc,gc,yc;function bc(){if(sc)return fc;sc=1;var t=Mr(),e=tr();return fc=function(r,n,o){return o.get&&t(o.get,n,{getter:!0}),o.set&&t(o.set,n,{setter:!0}),e.f(r,n,o)}}function mc(){if(dc)return vc;dc=1;var t=Xt(),e=bc(),r=De(),n=Y(),o=r("species");return vc=function(r){var i=t(r);n&&i&&!i[o]&&e(i,o,{configurable:!0,get:function(){return this}})}}function wc(){if(pc)return hc;pc=1;var t=Io(),e=bc(),r=eu(),n=eo(),o=Ou(),i=qt(),a=ku(),u=ma(),c=wa(),l=mc(),f=Y(),s=Eu().fastKey,v=Nr(),d=v.set,h=v.getterFor;return hc={getConstructor:function(u,c,l,v){var p=u(function(e,r){o(e,g),d(e,{type:c,index:t(null),first:null,last:null,size:0}),f||(e.size=0),i(r)||a(r,e[v],{that:e,AS_ENTRIES:l})}),g=p.prototype,y=h(c),b=function(t,e,r){var n,o,i=y(t),a=m(t,e);return a?a.value=r:(i.last=a={index:o=s(e,!0),key:e,value:r,previous:n=i.last,next:null,removed:!1},i.first||(i.first=a),n&&(n.next=a),f?i.size++:t.size++,"F"!==o&&(i.index[o]=a)),t},m=function(t,e){var r,n=y(t),o=s(e);if("F"!==o)return n.index[o];for(r=n.first;r;r=r.next)if(r.key===e)return r};return r(g,{clear:function(){for(var e=y(this),r=e.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=null),r=r.next;e.first=e.last=null,e.index=t(null),f?e.size=0:this.size=0},delete:function(t){var e=this,r=y(e),n=m(e,t);if(n){var o=n.next,i=n.previous;delete r.index[n.index],n.removed=!0,i&&(i.next=o),o&&(o.previous=i),r.first===n&&(r.first=o),r.last===n&&(r.last=i),f?r.size--:e.size--}return!!n},forEach:function(t){for(var e,r=y(this),o=n(t,arguments.length>1?arguments[1]:void 0);e=e?e.next:r.first;)for(o(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!m(this,t)}}),r(g,l?{get:function(t){var e=m(this,t);return e&&e.value},set:function(t,e){return b(this,0===t?0:t,e)}}:{add:function(t){return b(this,t=0===t?0:t,t)}}),f&&e(g,"size",{configurable:!0,get:function(){return y(this).size}}),p},setStrong:function(t,e,r){var n=e+" Iterator",o=h(e),i=h(n);u(t,e,function(t,e){d(this,{type:n,target:t,state:o(t),kind:e,last:null})},function(){for(var t=i(this),e=t.kind,r=t.last;r&&r.removed;)r=r.previous;return t.target&&(t.last=r=r?r.next:t.state.first)?c("keys"===e?r.key:"values"===e?r.value:[r.key,r.value],!1):(t.target=null,c(void 0,!0))},r?"entries":"values",!r,!0),l(e)}},hc}yc||(yc=1,gc||(gc=1,Cu()("Set",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},wc())));var xc=function(){function t(){this.title=r("tableModule.deleteCol"),this.iconSvg='<svg viewBox="0 0 1048 1024"><path d="M327.68 510.976L393.216 445.44v-13.1072L327.68 366.7968V510.976z m327.68-78.4384l65.536-65.536V507.904L655.36 442.368v-9.8304z m393.216 484.9664V0H0v917.504h1048.576z m-65.536-131.072h-262.144v-52.4288l-13.1072 13.1072-52.4288-52.4288v91.7504H393.216v-91.7504l-52.4288 52.4288-13.1072-13.1072v52.4288H65.536V65.536H327.68v121.2416l36.0448-36.0448 29.4912 29.4912V62.2592h262.144V180.224l49.152-49.152 16.384 16.384V62.2592h262.144V786.432z m-294.912-108.1344l-160.5632-160.5632-167.1168 167.1168-78.6432-78.6432 167.1168-167.1168L288.3584 278.528l78.6432-78.6432 160.5632 160.5632 163.84-163.84 78.6432 78.6432-163.84 163.84 160.5632 160.5632-78.6432 78.6432z"></path></svg>',this.tag="button"}return t.prototype.getValue=function(t){return""},t.prototype.isActive=function(t){return!1},t.prototype.isDisabled=function(t){var r=t.selection;return null==r||(!c.isCollapsed(r)||null==e.getSelectedNodeByType(t,"table-cell"))},t.prototype.exec=function(t,r){if(!this.isDisabled(t)){var n=po(i.nodes(t,{match:function(t){return e.checkNodeType(t,"table-cell")},universal:!0}),1),o=po(n[0],2),a=o[0],c=o[1],f=e.getParentNode(t,a),s=(null==f?void 0:f.children.length)||0;if(!f||s<=1)u.removeNodes(t,{mode:"highest"});else if(null!=e.getParentNode(t,f)){var v=Xo(t),d=0;t:for(var h=0;h<v.length;h+=1)for(var p=0;p<v[h].length;p+=1){var g=po(v[h][p],1),y=po(g[0],2)[1];if(l.equals(c,y)){d=p;break t}}i.withoutNormalizing(t,function(){for(var r,n,o=new Set,a=new Set,c=0;c<v.length;c+=1)if(v[c]&&v[c][d]){var l=po(v[c][d],2),f=po(l[0],2)[1],s=l[1],h=s.rtl,p=s.ltr,g=s.ttb,y=s.btt,b=f.join(",");if(h>1||p>1||g>1||y>1){var m=c-(g-1),w=d-(h-1);if(m<0||m>=v.length||!v[m]||!v[m][w])continue;var x=po(v[m][w],1),S=po(x[0],2),N=S[0],M=S[1],T=M.join(",");if(!a.has(T)){a.add(T);var z=N.rowSpan,E=void 0===z?1:z,k=N.colSpan,O=void 0===k?1:k,A=Math.max(O-1,1);u.setNodes(t,{rowSpan:E,colSpan:A},{at:M})}}else o.add(b)}var C=Array.from(o);C.sort(function(t,e){var r=t.split(",").map(Number),n=e.split(",").map(Number);return r[r.length-2]!==n[n.length-2]?n[n.length-2]-r[r.length-2]:n[n.length-1]-r[r.length-1]});try{for(var I=ho(C),H=I.next();!H.done;H=I.next()){var j=H.value.split(",").map(Number);try{i.hasPath(t,j)&&u.removeNodes(t,{at:j})}catch(t){console.warn("删除单元格失败:",j,t)}}}catch(t){r={error:t}}finally{try{H&&!H.done&&(n=I.return)&&n.call(I)}finally{if(r)throw r.error}}var P=po(i.nodes(t,{match:function(t){return e.checkNodeType(t,"table")},universal:!0}),1)[0];if(P){var R=po(P,2),V=R[0],D=R[1],L=V.columnWidths,B=go([],po(void 0===L?[]:L),!1);B.splice(d,1),u.setNodes(t,{columnWidths:B},{at:D})}})}}},t}(),Sc=function(){function t(){this.title=r("tableModule.deleteRow"),this.iconSvg='<svg viewBox="0 0 1048 1024"><path d="M907.6736 586.5472L747.1104 425.984l163.84-163.84-78.6432-78.6432-163.84 163.84L507.904 186.7776 429.2608 262.144l163.84 163.84-167.1168 167.1168 78.6432 78.6432 167.1168-167.1168 160.5632 160.5632 75.3664-78.6432zM0 917.504V0h1048.576v917.504H0z m983.04-327.68h-22.9376l-65.536-65.536H983.04V327.68h-91.7504l65.536-65.536h26.2144V65.536H65.536v196.608h317.8496l65.536 65.536H65.536v196.608h380.1088l-65.536 65.536H65.536v196.608H983.04v-196.608z"></path></svg>',this.tag="button"}return t.prototype.getValue=function(t){return""},t.prototype.isActive=function(t){return!1},t.prototype.isDisabled=function(t){var r=t.selection;return null==r||(!c.isCollapsed(r)||null==e.getSelectedNodeByType(t,"table-row"))},t.prototype.exec=function(t,r){if(!this.isDisabled(t)){var n=po(i.nodes(t,{match:function(t){return e.checkNodeType(t,"table-row")},universal:!0}),1),o=po(n[0],2),a=o[0],c=o[1],f=e.getParentNode(t,a);if(((null==f?void 0:f.children.length)||0)<=1)u.removeNodes(t,{mode:"highest"});else{var s=po(i.nodes(t,{match:function(t){return e.checkNodeType(t,"table-cell")},universal:!0}),1),v=po(s[0],2)[1],d=Xo(t),h=0;t:for(var p=0;p<d.length;p+=1)for(var g=0;g<d[p].length;g+=1){var y=po(d[p][g],1),b=po(y[0],2)[1];if(l.equals(v,b)){h=p;break t}}i.withoutNormalizing(t,function(){for(var e,r,n=[],o=0;o<d[h].length;o+=1){var a=po(d[h][o],2),l=po(a[0],1)[0].hidden,f=a[1],s=f.ttb,v=f.btt,p=f.rtl;if(s>1||v>1){var g=h-(s-1);if(g<0||g>=d.length||!d[g]||!d[g][o])continue;var y=po(d[g][o],1),b=po(y[0],2),m=b[0],w=b[1],x=m,S=x.rowSpan,N=void 0===S?1:S,M=x.colSpan,T=void 0===M?1:M;if(l)u.setNodes(t,{rowSpan:Math.max(N-1,1),colSpan:T},{at:w});else if(1===s&&1===p){if(h+1<d.length&&N>1){var z={type:"table-cell",rowSpan:N-1,colSpan:T,hidden:!1,children:x.children.map(function(t){return so({},t)})};x.isHeader&&(z.isHeader=x.isHeader),x.width&&(z.width=x.width),x.backgroundColor&&(z.backgroundColor=x.backgroundColor),x.borderWidth&&(z.borderWidth=x.borderWidth),x.borderStyle&&(z.borderStyle=x.borderStyle),x.borderColor&&(z.borderColor=x.borderColor),x.textAlign&&(z.textAlign=x.textAlign),n.push({cell:z,columnIndex:o})}else u.setNodes(t,{rowSpan:Math.max(N-1,1),colSpan:T},{at:w})}else u.setNodes(t,{rowSpan:Math.max(N-1,1),colSpan:T},{at:w})}}if(u.removeNodes(t,{at:c}),n.length>0){var E=c;try{n.sort(function(t,e){return t.columnIndex-e.columnIndex});try{for(var k=ho(n),O=k.next();!O.done;O=k.next()){var A=O.value,C=A.cell,I=A.columnIndex;try{var H=go(go([],po(E),!1),[I],!1);u.insertNodes(t,C,{at:H})}catch(e){try{var j=po(i.node(t,E),1)[0].children.length,P=go(go([],po(E),!1),[j],!1);u.insertNodes(t,C,{at:P})}catch(t){console.warn("插入新单元格失败:",t)}}}}catch(t){e={error:t}}finally{try{O&&!O.done&&(r=k.return)&&r.call(k)}finally{if(e)throw e.error}}}catch(t){console.warn("插入新单元格失败:",t)}}})}}},t}(),Nc=function(){function t(){this.title=r("tableModule.deleteTable"),this.iconSvg='<svg viewBox="0 0 1024 1024"><path d="M826.8032 356.5312c-19.328 0-36.3776 15.6928-36.3776 35.0464v524.2624c0 19.328-16 34.56-35.328 34.56H264.9344c-19.328 0-35.5072-15.3088-35.5072-34.56V390.0416c0-19.328-14.1568-35.0464-33.5104-35.0464s-33.5104 15.6928-33.5104 35.0464V915.712c0 57.9328 44.6208 108.288 102.528 108.288H755.2c57.9328 0 108.0832-50.4576 108.0832-108.288V391.4752c-0.1024-19.2512-17.1264-34.944-36.48-34.944z" p-id="9577"></path><path d="M437.1712 775.7568V390.6048c0-19.328-14.1568-35.0464-33.5104-35.0464s-33.5104 15.616-33.5104 35.0464v385.152c0 19.328 14.1568 35.0464 33.5104 35.0464s33.5104-15.7184 33.5104-35.0464zM649.7024 775.7568V390.6048c0-19.328-17.0496-35.0464-36.3776-35.0464s-36.3776 15.616-36.3776 35.0464v385.152c0 19.328 17.0496 35.0464 36.3776 35.0464s36.3776-15.7184 36.3776-35.0464zM965.0432 217.0368h-174.6176V145.5104c0-57.9328-47.2064-101.76-104.6528-101.76h-350.976c-57.8304 0-105.3952 43.8528-105.3952 101.76v71.5264H54.784c-19.4304 0-35.0464 14.1568-35.0464 33.5104 0 19.328 15.616 33.5104 35.0464 33.5104h910.3616c19.328 0 35.0464-14.1568 35.0464-33.5104 0-19.3536-15.6928-33.5104-35.1488-33.5104z m-247.3728 0H297.3952V145.5104c0-19.328 18.2016-34.7648 37.4272-34.7648h350.976c19.1488 0 31.872 15.1296 31.872 34.7648v71.5264z"></path></svg>',this.tag="button"}return t.prototype.getValue=function(t){return""},t.prototype.isActive=function(t){return!1},t.prototype.isDisabled=function(t){return null==t.selection||null==e.getSelectedNodeByType(t,"table")},t.prototype.exec=function(t,e){this.isDisabled(t)||u.removeNodes(t,{mode:"highest"})},t}(),Mc=function(){function t(){this.title=r("tableModule.widthAuto"),this.iconSvg='<svg viewBox="0 0 1228 1024"><path d="M862.514337 563.200461H404.581995v121.753478a13.311987 13.311987 0 0 1-6.655993 11.468789 10.23999 10.23999 0 0 1-12.083188-1.433599l-204.799795-179.199821a13.721586 13.721586 0 0 1 0-20.479979l204.799795-179.302221a10.23999 10.23999 0 0 1 12.185588-1.535998 13.209587 13.209587 0 0 1 6.553593 11.673588v115.097485h457.932342V319.693504a11.571188 11.571188 0 0 1 18.841582-10.239989l204.799795 179.19982a13.721586 13.721586 0 0 1 0 20.47998l-204.799795 179.199821a10.23999 10.23999 0 0 1-12.185588 1.535998 13.311987 13.311987 0 0 1-6.655994-11.571188V563.200461zM136.499064 14.951409v993.893406a15.257585 15.257585 0 0 1-15.155185 15.052785H15.155185A15.155185 15.155185 0 0 1 0 1008.844815V14.951409a15.257585 15.257585 0 0 1 15.155185-15.052785h106.086294a15.155185 15.155185 0 0 1 15.257585 15.155185zM1228.798771 14.951409v993.893406a15.257585 15.257585 0 0 1-15.155185 15.052785h-106.188693a15.155185 15.155185 0 0 1-15.155185-15.052785V14.951409a15.257585 15.257585 0 0 1 15.155185-15.052785h106.086293A15.155185 15.155185 0 0 1 1228.798771 15.053809z"></path></svg>',this.tag="button"}return t.prototype.getValue=function(t){return!1},t.prototype.isActive=function(t){return!1},t.prototype.isDisabled=function(t){var r=t.selection;return null==r||(!c.isCollapsed(r)||null==e.getSelectedNodeByType(t,"table"))},t.prototype.exec=function(t,r){if(!this.isDisabled(t)){var n=e.getSelectedNodeByType(t,"table");if(n){var o=n.columnWidths,i=void 0===o?[]:o,a=e.toDOMNode(t,n).querySelector(".table-container");if(a&&0!==i.length){var c=a.clientWidth,l=i.reduce(function(t,e){return t+e},0),f=i.map(function(t){var e=t/l;return Math.floor(e*c)}),s=t.getMenuConfig("insertTable").minWidth,v=parseInt(String(void 0===s?60:s),10)||60,d=f.map(function(t){return Math.max(v,t)}),h=d.reduce(function(t,e){return t+e},0);if(h>c){var p=c/h;b={width:"auto",columnWidths:g=d.map(function(t){return Math.max(v,Math.floor(t*p))})};u.setNodes(t,b,{mode:"highest"})}else{var g=go([],po(d),!1),y=c-h-1;y>0&&g.length>0&&(g[g.length-1]+=y);b={width:"auto",columnWidths:g};u.setNodes(t,b,{mode:"highest"})}}else{var b={width:"auto"};u.setNodes(t,b,{mode:"highest"})}}}},t}();function Tc(t){var e=t.children||[];return 0===e.length?[]:(e[0]||{}).children||[]}function zc(t){return Tc(t).every(function(t){return!!t.isHeader})}var Ec,kc,Oc,Ac,Cc,Ic=function(){function t(){this.title=r("tableModule.insertCol"),this.iconSvg='<svg viewBox="0 0 1048 1024"><path d="M327.68 193.3312v186.7776H140.9024v91.7504H327.68v186.7776h88.4736V471.8592h190.0544V380.1088H416.1536V193.3312zM0 917.504V0h1048.576v917.504H0zM655.36 65.536H65.536v720.896H655.36V65.536z m327.68 0h-262.144v196.608h262.144V65.536z m0 262.144h-262.144v196.608h262.144V327.68z m0 262.144h-262.144v196.608h262.144v-196.608z"></path></svg>',this.tag="button"}return t.prototype.getValue=function(t){return""},t.prototype.isActive=function(t){return!1},t.prototype.isDisabled=function(t){var r=t.selection;if(null==r)return!0;if(!c.isCollapsed(r))return!0;var n=e.getSelectedNodeByType(t,"table");if(null==n)return!0;try{var o=po(i.nodes(t,{match:function(t){return e.checkNodeType(t,"table-cell")},universal:!0}),1)[0];if(!o)return!0;for(var a=po(o,2)[1],u=Xo(t),f=-1,s=0;s<u.length;s+=1){for(var v=0;v<u[s].length;v+=1){var d=po(u[s][v],1),h=po(d[0],2)[1];if(l.equals(a,h)){f=v;break}}if(-1!==f)break}if(-1===f)return!0;var p=n.columnWidths,g=(void 0===p?[]:p)[f];if(g&&g<20)return!0}catch(t){return!0}return!1},t.prototype.exec=function(t,r){if(!this.isDisabled(t)){var n=po(i.nodes(t,{match:function(t){return e.checkNodeType(t,"table-cell")},universal:!0}),1),o=po(n[0],2),a=o[0],c=o[1],f=e.getParentNode(t,a);if(null!=f){var s=e.getParentNode(t,f);if(null!=s){for(var v=Xo(t),d=0,h=0;h<v.length;h+=1)for(var p=0;p<v[h].length;p+=1){var g=po(v[h][p],1),y=po(g[0],2)[1];if(l.equals(c,y)){d=p;break}}i.withoutNormalizing(t,function(){for(var r=new Set,n=new Set,o=0;o<v.length;o+=1)if(v[o]&&v[o][d]){var a=po(v[o][d],2);po(a[0],1);var c=a[1],l=c.rtl,f=c.ltr,h=c.ttb,p=c.btt;if(l>1||f>1||h>1||p>1){var g=o-(h-1),y=d-(l-1);if(g<0||g>=v.length||!v[g]||!v[g][y])continue;var b=po(v[g][y],1),m=po(b[0],2),w=m[0],x=m[1],S=x.join(",");if(r.has(S))n.add(o);else{r.add(S);var N=w.rowSpan,M=void 0===N?1:N,T=w.colSpan,z=(void 0===T?1:T)+1;w.hidden||u.setNodes(t,{colSpan:z},{at:x});for(var E=0;E<M;E+=1)n.add(g+E)}}}for(o=0;o<v.length;o+=1)if(!n.has(o)&&v[o]&&v[o][d]){var k={type:"table-cell",children:[{text:""}]};0===o&&zc(s)&&(k.isHeader=!0);var O=po(v[o][d],1),A=po(O[0],2)[1];u.insertNodes(t,k,{at:A})}var C=po(i.nodes(t,{match:function(t){return e.checkNodeType(t,"table")},universal:!0}),1)[0];if(C){var I=po(C,2),H=I[0],j=I[1],P=H.columnWidths,R=void 0===P?[]:P,V=go([],po(R),!1),D=t.getMenuConfig("insertTable").minWidth,L=void 0===D?60:D,B=R[d]||parseInt(L,10)||60,W=Math.floor(B/2),_=B-W;V.splice(d,0,W),V[d+1]=_,u.setNodes(t,{columnWidths:V},{at:j})}})}}}},t}(),Hc={};function jc(){if(Ac)return Oc;Ac=1;var t=K(),e=Re(),r=Kt(),n=function(){if(kc)return Ec;kc=1;var t=V(),e=U(),r=t.RegExp,n=!e(function(){var t=!0;try{r(".","d")}catch(e){t=!1}var e={},n="",o=t?"dgimsy":"gimsy",i=function(t,r){Object.defineProperty(e,t,{get:function(){return n+=r,!0}})},a={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var u in t&&(a.hasIndices="d"),a)i(u,a[u]);return Object.getOwnPropertyDescriptor(r.prototype,"flags").get.call(e)!==o||n!==o});return Ec={correct:n}}(),o=Ri(),i=RegExp.prototype;return Oc=n.correct?function(t){return t.flags}:function(a){return n.correct||!r(i,a)||e(a,"flags")?a.flags:t(o,a)}}!function(){if(Cc)return Hc;Cc=1;var t=br().PROPER,e=Tr(),r=Ze(),n=$o(),o=U(),i=jc(),a="toString",u=RegExp.prototype,c=u[a],l=o(function(){return"/a/b"!==c.call({source:"a",flags:"b"})}),f=t&&c.name!==a;(l||f)&&e(u,a,function(){var t=r(this);return"/"+n(t.source)+"/"+n(i(t))},{unsafe:!0})}();var Pc,Rc,Vc,Dc=function(){function t(){this.title=r("tableModule.insertRow"),this.iconSvg='<svg viewBox="0 0 1048 1024"><path d="M707.7888 521.0112h-147.456v-147.456H488.2432v147.456h-147.456v68.8128h147.456v147.456h72.0896v-147.456h147.456zM0 917.504V0h1048.576v917.504H0zM327.68 65.536H65.536v196.608H327.68V65.536z m327.68 0H393.216v196.608h262.144V65.536z m327.68 0h-262.144v196.608h262.144V65.536z m0 258.8672H65.536v462.0288H983.04V324.4032z"></path></svg>',this.tag="button"}return t.prototype.getValue=function(t){return""},t.prototype.isActive=function(t){return!1},t.prototype.isDisabled=function(t){var r=t.selection;return null==r||(!c.isCollapsed(r)||null==e.getSelectedNodeByType(t,"table"))},t.prototype.exec=function(t,r){var n;if(!this.isDisabled(t)){var o=po(i.nodes(t,{match:function(t){return e.checkNodeType(t,"table-cell")},universal:!0}),1),a=po(o[0],2)[1],c=Xo(t),f=0;t:for(var s=0;s<c.length;s+=1)for(var v=0;v<c[s].length;v+=1){var d=po(c[s][v],1),h=po(d[0],2)[1];if(l.equals(a,h)){f=s;break t}}var p=(null===(n=c[f])||void 0===n?void 0:n.length)||0;0!==p&&i.withoutNormalizing(t,function(){for(var e=f+1,r=e>=0&&e<c.length,n=[],o=0;r&&o<c[f].length;o+=1){var i=po(c[f][o],2)[1],s=i.ttb,v=i.btt;if(s>1||v>1){var d=f-(s-1);if(d<0||d>=c.length||!c[d]||!c[d][o])continue;var h=po(c[d][o],1),g=po(h[0],2),y=g[0],b=g[1],m=y.rowSpan||1;n.push(o),y.hidden||u.setNodes(t,{rowSpan:m+1},{at:b})}}for(var w=(t.getMenuConfig("insertTable")||{}).minRowHeight,x={type:"table-row",children:[],height:parseInt((void 0===w?30:w).toString(),10)||30},S=0;S<p;S+=1)if(!n.includes(S)){x.children.push({type:"table-cell",children:[{text:""}]})}var N=l.parent(a),M=l.next(N);u.insertNodes(t,x,{at:M})})}},t}(),Lc={};!function(){if(Vc)return Lc;Vc=1;var t=In(),e=function(){if(Rc)return Pc;Rc=1;var t=Pe(),e=$r(),r=Ur();return Pc=function(n){for(var o=t(this),i=r(o),a=arguments.length,u=e(a>1?arguments[1]:void 0,i),c=a>2?arguments[2]:void 0,l=void 0===c?i:e(c,i);l>u;)o[u++]=n;return o},Pc}(),r=Ho();t({target:"Array",proto:!0},{fill:e}),r("fill")}();var Bc,Wc,_c=function(){function t(){this.title=r("tableModule.insertTable"),this.iconSvg='<svg viewBox="0 0 1024 1024"><path d="M0 64v896h1024V64H0z m384 576v-192h256v192h-256z m256 64v192h-256v-192h256z m0-512v192h-256V192h256zM320 192v192H64V192h256z m-256 256h256v192H64v-192z m640 0h256v192h-256v-192z m0-64V192h256v192h-256zM64 704h256v192H64v-192z m640 192v-192h256v192h-256z"></path></svg>',this.tag="button",this.showDropPanel=!0,this.$content=null}return t.prototype.getValue=function(t){return""},t.prototype.isActive=function(t){return!1},t.prototype.exec=function(t,e){},t.prototype.isDisabled=function(t){var r=t.selection;return null==r||(!c.isCollapsed(r)||!!e.getSelectedElems(t).some(function(r){var n=e.getNodeType(r);return"pre"===n||("table"===n||("list-item"===n||!!t.isVoid(r)))}))},t.prototype.getPanelContentElem=function(t){var e=this;if(this.$content)return this.$content[0];for(var r=d('<div class="w-e-panel-content-table"></div>'),n=d("<span>0 &times; 0</span>"),o=d("<table></table>"),i=0;i<10;i+=1){for(var a=d("<tr></tr>"),u=0;u<10;u+=1){var c=d("<td></td>");c.attr("data-x",u.toString()),c.attr("data-y",i.toString()),a.append(c),c.on("mouseenter",function(t){var e=t.target;if(null!=e){var r=d(e).dataset(),i=r.x,a=r.y;n[0].innerHTML="".concat(i+1," &times; ").concat(a+1),o.children().each(function(t){d(t).children().each(function(t){var e=d(t),r=e.dataset(),n=r.x,o=r.y;n<=i&&o<=a?e.addClass("active"):e.removeClass("active")})})}}),c.on("click",function(r){r.preventDefault();var n=r.target;if(null!=n){var o=d(n).dataset(),i=o.x,a=o.y;e.insertTable(t,a+1,i+1)}})}o.append(a)}return r.append(o),r.append(n),this.$content=r,r[0]},t.prototype.insertTable=function(t,r,n){var o=parseInt(r,10),i=parseInt(n,10);if(o&&i&&!(o<=0||i<=0)){if(e.isSelectedEmptyParagraph(t)&&u.removeNodes(t,{mode:"highest"}),0===t.children.length){u.insertNodes(t,{type:"paragraph",children:[{text:""}]},{mode:"highest"})}var a=function(t,e,r){for(var n,o=[],i=t.getMenuConfig("insertTable"),a=i.minWidth,u=void 0===a?60:a,c=i.minRowHeight,l=void 0===c?30:c,f=i.tableFullWidth,s=i.tableHeader,v=Array(r).fill(parseInt(u,10)||60),d=0;d<e;d+=1){for(var h=[],p=0;p<r;p+=1){var g={type:"table-cell",children:[{text:""}]};0===d&&(g.isHeader=null===(n=null==s?void 0:s.selected)||void 0===n||n),h.push(g)}o.push({type:"table-row",children:h,height:parseInt(l,10)||30})}return{type:"table",width:(null==f?void 0:f.selected)?"100%":"auto",children:o,columnWidths:v}}(t,o,i);u.insertNodes(t,a,{mode:"highest"})}},t}();Wc||(Wc=1,Bc||(Bc=1,Cu()("Map",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},wc())));var Fc,qc={isInTable:function(t,e){return void 0===e&&(e={}),!!po(i.nodes(t,{match:Uo(t,"table"),at:e.at}),1)[0]},selection:function(t){var e,r,n,o,i,a,u,c;return vo(this,function(l){switch(l.label){case 0:e=Gu.get(t),r=0,l.label=1;case 1:if(!(e&&r<e.length))return[3,4];for(n=[],o=0;o<e[r].length;o+=1)i=po(e[r][o],2),a=i[0],u=i[1],c=u.ltr,1===u.ttb&&n.push(a),o+=c-1;return[4,n];case 2:l.sent(),l.label=3;case 3:return r+=1,[3,1];case 4:return[2]}})},unselect:function(t){Uu.delete(t),Gu.delete(t)},isSelected:function(t,e){var r=Uu.get(t);return!!r&&r.has(e)}},$c=function(){function t(){this.title=r("tableModule.mergeCell"),this.iconSvg='<svg viewBox="0 0 1024 1024"><path d="M482.2 508.4 331.3 389c-3-2.4-7.3-.2-7.3 3.6V478H184V184h204v128c0 2.2 1.8 4 4 4h60c2.2 0 4-1.8 4-4V144c0-15.5-12.5-28-28-28H144c-15.5 0-28 12.5-28 28v736c0 15.5 12.5 28 28 28h284c15.5 0 28-12.5 28-28V712c0-2.2-1.8-4-4-4h-60c-2.2 0-4 1.8-4 4v128H184V546h140v85.4c0 3.8 4.4 6 7.3 3.6l150.9-119.4c2.4-1.8 2.4-5.4 0-7.2zM880 116H596c-15.5 0-28 12.5-28 28v168c0 2.2 1.8 4 4 4h60c2.2 0 4-1.8 4-4V184h204v294H700v-85.4c0-3.8-4.3-6-7.3-3.6l-151 119.4c-2.3 1.8-2.3 5.3 0 7.1l151 119.5c2.9 2.3 7.3.2 7.3-3.6V546h140v294H636V712c0-2.2-1.8-4-4-4h-60c-2.2 0-4 1.8-4 4v168c0 15.5 12.5 28 28 28h284c15.5 0 28-12.5 28-28V144c0-15.5-12.5-28-28-28z"/></svg>',this.tag="button"}return t.prototype.getValue=function(t){return""},t.prototype.isActive=function(t){return!1},t.prototype.isDisabled=function(t){return!this.canMerge(t)},t.prototype.exec=function(t,e){this.isDisabled(t)||(this.merge(t),qc.unselect(t))},t.prototype.canMerge=function(t){var e=Gu.get(t);if(!e||!e.length)return!1;var r=po(e[e.length-1][e[e.length-1].length-1],1),n=po(r[0],2)[1],o=po(e[0][0],1);return!!Yo(t,[po(o[0],2)[1],n],"table")},t.prototype.merge=function(t){if(this.canMerge(t)){var e=Gu.get(t);if(e&&e.length){var r=po(e[0][0],1),n=po(r[0],2)[1],o=po(a.children(t,n,{reverse:!0}),1),c=po(o[0],2)[1];i.withoutNormalizing(t,function(){for(var r,o,f,s,v,d,h=new Map,p=[],g=1/0,y=-1/0,b=1/0,m=-1/0,w=0;w<e.length;w+=1)for(var x=0;x<e[w].length;x+=1){var S=po(e[w][x],2),N=po(S[0],2),M=N[0],T=N[1],z=S[1].ttb,E=T.join(",");if(1===z&&!h.has(E)){h.set(E,{path:T,x:w,y:x,element:M});var k=M.rowSpan,O=void 0===k?1:k,A=M.colSpan,C=w,I=w+O-1,H=x,j=x+(void 0===A?1:A)-1;g=Math.min(g,C),y=Math.max(y,I),b=Math.min(b,H),m=Math.max(m,j)}}var P=y-g+1,R=m-b+1;try{for(var V=ho(h),D=V.next();!D.done;D=V.next()){T=po(D.value,2)[1].path;l.equals(n,T)||p.push(T)}}catch(t){r={error:t}}finally{try{D&&!D.done&&(o=V.return)&&o.call(V)}finally{if(r)throw r.error}}p.sort(function(t,e){for(var r=0;r<Math.min(t.length,e.length);r+=1)if(t[r]!==e[r])return e[r]-t[r];return e.length-t.length});try{for(var L=ho(p),B=L.next();!B.done;B=L.next()){T=B.value;try{if(!i.hasPath(t,T))continue;try{for(var W=(v=void 0,ho(a.children(t,T,{reverse:!0}))),_=W.next();!_.done;_=W.next()){var F=po(_.value,2)[1];u.moveNodes(t,{to:l.next(c),at:F})}}catch(t){v={error:t}}finally{try{_&&!_.done&&(d=W.return)&&d.call(W)}finally{if(v)throw v.error}}u.removeNodes(t,{at:T})}catch(t){}}}catch(t){f={error:t}}finally{try{B&&!B.done&&(s=L.return)&&s.call(L)}finally{if(f)throw f.error}}u.setNodes(t,{rowSpan:P,colSpan:R},{at:n})})}}},t}(),Gc={};!function(){if(Fc)return Gc;Fc=1;var t=In(),e=Hn(),r=Dn(),n=Yt(),o=$r(),i=Ur(),a=Gt(),u=Pn(),c=De(),l=Wn(),f=Mu(),s=l("slice"),v=c("species"),d=Array,h=Math.max;t({target:"Array",proto:!0,forced:!s},{slice:function(t,c){var l,s,p,g=a(this),y=i(g),b=o(t,y),m=o(void 0===c?y:c,y);if(e(g)&&(l=g.constructor,(r(l)&&(l===d||e(l.prototype))||n(l)&&null===(l=l[v]))&&(l=void 0),l===d||void 0===l))return f(g,b,m);for(s=new(void 0===l?d:l)(h(m-b,0)),p=0;b<m;b++,p++)b in g&&u(s,p,g[b]);return s.length=p,s}})}();var Uc,Yc,Xc,Kc,Jc,Qc,Zc,tl,el,rl,nl,ol={};function il(){if(Yc)return Uc;Yc=1,Li();var t=K(),e=Tr(),r=Di(),n=U(),o=De(),i=er(),a=o("species"),u=RegExp.prototype;return Uc=function(c,l,f,s){var v=o(c),d=!n(function(){var t={};return t[v]=function(){return 7},7!==""[c](t)}),h=d&&!n(function(){var t=!1,e=/a/;return"split"===c&&((e={}).constructor={},e.constructor[a]=function(){return e},e.flags="",e[v]=/./[v]),e.exec=function(){return t=!0,null},e[v](""),!t});if(!d||!h||f){var p=/./[v],g=l(v,""[c],function(e,n,o,i,a){var c=n.exec;return c===r||c===u.exec?d&&!a?{done:!0,value:t(p,n,o,i)}:{done:!0,value:t(e,o,n,i)}:{done:!1}});e(String.prototype,c,g[0]),e(u,v,g[1])}s&&i(u[v],"sham",!0)}}function al(){if(Kc)return Xc;Kc=1;var t=Dn(),e=re(),r=TypeError;return Xc=function(n){if(t(n))return n;throw new r(e(n)+" is not a constructor")}}function ul(){if(Qc)return Jc;Qc=1;var t=Ze(),e=al(),r=qt(),n=De()("species");return Jc=function(o,i){var a,u=t(o).constructor;return void 0===u||r(a=t(u)[n])?i:e(a)}}function cl(){if(tl)return Zc;tl=1;var t=va().charAt;return Zc=function(e,r,n){return r+(n?t(e,r).length:1)}}function ll(){if(rl)return el;rl=1;var t=K(),e=Ze(),r=Ut(),n=_t(),o=Di(),i=TypeError;return el=function(a,u){var c=a.exec;if(r(c)){var l=t(c,a,u);return null!==l&&e(l),l}if("RegExp"===n(a))return t(o,a,u);throw new i("RegExp#exec called on incompatible receiver")}}!function(){if(nl)return ol;nl=1;var t=K(),e=Wt(),r=il(),n=Ze(),o=Yt(),i=$t(),a=ul(),u=cl(),c=Gr(),l=$o(),f=oe(),s=ll(),v=Vi(),d=U(),h=v.UNSUPPORTED_Y,p=Math.min,g=e([].push),y=e("".slice),b=!d(function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var r="ab".split(t);return 2!==r.length||"a"!==r[0]||"b"!==r[1]}),m="c"==="abbc".split(/(b)*/)[1]||4!=="test".split(/(?:)/,-1).length||2!=="ab".split(/(?:ab)*/).length||4!==".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length;r("split",function(e,r,v){var d="0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:t(r,this,e,n)}:r;return[function(r,n){var a=i(this),u=o(r)?f(r,e):void 0;return u?t(u,r,a,n):t(d,l(a),r,n)},function(t,e){var o=n(this),i=l(t);if(!m){var f=v(d,o,i,e,d!==r);if(f.done)return f.value}var b=a(o,RegExp),w=o.unicode,x=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(h?"g":"y"),S=new b(h?"^(?:"+o.source+")":o,x),N=void 0===e?4294967295:e>>>0;if(0===N)return[];if(0===i.length)return null===s(S,i)?[i]:[];for(var M=0,T=0,z=[];T<i.length;){S.lastIndex=h?0:T;var E,k=s(S,h?y(i,T):i);if(null===k||(E=p(c(S.lastIndex+(h?T:0)),i.length))===M)T=u(i,T,w);else{if(g(z,y(i,M,T)),z.length===N)return z;for(var O=1;O<=k.length-1;O++)if(g(z,k[O]),z.length===N)return z;T=M=E}}return g(z,y(i,M)),z}]},m||!b,h)}();var fl,sl=function(){function t(){this.title=r("tableModule.splitCell"),this.iconSvg='<svg viewBox="0 0 1024 1024"><path d="M362.667 494.933v53.334l25.6-25.6zm0-241.066L460.8 352V78.933H57.6v98.134h305.067zm0 535.466v57.6H57.6v98.134h403.2V691.2zM661.333 494.933v53.334l-25.6-25.6zm0-241.066L563.2 352V78.933h403.2v98.134H661.333zm0 535.466v57.6H966.4v98.134H563.2V691.2z"/><path d="M753.067 341.333 693.333 281.6 512 460.8 330.667 281.6l-59.734 59.733 181.334 181.334L270.933 704l59.734 59.733L512 582.4l181.333 181.333L753.067 704 571.733 522.667z"/></svg>',this.tag="button"}return t.prototype.getValue=function(t){return""},t.prototype.isActive=function(t){return!1},t.prototype.isDisabled=function(t){var r=po(i.nodes(t,{match:function(t){return e.checkNodeType(t,"table-cell")}}),1)[0];if(!r)return!0;var n=po(r,1)[0],o=n.rowSpan,a=void 0===o?1:o,u=n.colSpan;return!(a>1||(void 0===u?1:u)>1)},t.prototype.exec=function(t,e){this.isDisabled(t)||this.split(t)},t.prototype.split=function(t,e){void 0===e&&(e={});var r=po(i.nodes(t,{match:Uo(t,"table","th","td"),at:e.at}),2),n=r[0],o=r[1];if(n&&o){var a=zc(po(n,1)[0]),c=po(o,2),l=c[0],f=c[1],s=l.rowSpan,v=void 0===s?1:s,d=l.colSpan,h=void 0===d?1:d;1===v&&1===h||i.withoutNormalizing(t,function(){u.setNodes(t,{rowSpan:1,colSpan:1},{at:f});for(var e=1;e<h;e+=1){var r={type:"table-cell",children:[{text:""}]};0===f[f.length-2]&&a&&(r.isHeader=!0);var n=f.slice(0,-1),o=f[f.length-1]+e,c=go(go([],po(n),!1),[o],!1);try{u.insertNodes(t,r,{at:c})}catch(e){try{var l=po(i.node(t,n),1)[0].children.length,s=go(go([],po(n),!1),[l],!1);u.insertNodes(t,r,{at:s})}catch(t){console.warn("插入同行单元格失败: ".concat(t instanceof Error?t.message:String(t)))}}}for(var d=1;d<v;d+=1){var p=f[f.length-2]+d,g=go(go([],po(f.slice(0,-2)),!1),[p],!1);try{var y=po(i.node(t,g),1)[0];if(!y){console.warn("目标行 ".concat(p," 不存在"));continue}for(e=0;e<h;e+=1){r={type:"table-cell",children:[{text:""}]},o=f[f.length-1]+e,c=go(go([],po(g),!1),[o],!1);try{var b=y.children.length;if(o>=b){var m=go(go([],po(g),!1),[b],!1);u.insertNodes(t,r,{at:m})}else u.insertNodes(t,r,{at:c})}catch(e){try{var w=y.children.length;s=go(go([],po(g),!1),[w],!1);u.insertNodes(t,r,{at:s})}catch(t){console.warn("插入单元格到第".concat(d,"行失败: ").concat(t instanceof Error?t.message:String(t)))}}}}catch(t){console.warn("处理第".concat(d,"行时出错: ").concat(t instanceof Error?t.message:String(t)))}}})}},t}(),vl=function(){function t(){this.title=r("tableModule.header"),this.iconSvg='<svg viewBox="0 0 1024 1024"><path d="M704 128l-64 0L384 128 320 128 0 128l0 256 0 64 0 192 0 64 0 256 320 0 64 0 256 0 64 0 320 0 0-256 0-64L1024 448 1024 384 1024 128 704 128zM640 640 384 640 384 448l256 0L640 640zM64 448l256 0 0 192L64 640 64 448zM320 896 64 896l0-192 256 0L320 896zM640 896 384 896l0-192 256 0L640 896zM960 896l-256 0 0-192 256 0L960 896zM960 640l-256 0L704 448l256 0L960 640z"></path></svg>',this.tag="button"}return t.prototype.getValue=function(t){var r=e.getSelectedNodeByType(t,"table");return null!=r&&zc(r)},t.prototype.isActive=function(t){return!!this.getValue(t)},t.prototype.isDisabled=function(t){var r=t.selection;return null==r||(!c.isCollapsed(r)||null==e.getSelectedNodeByType(t,"table"))},t.prototype.exec=function(t,r){if(!this.isDisabled(t)){var n=!r,o=e.getSelectedNodeByType(t,"table");if(null!=o)Tc(o).forEach(function(r){return u.setNodes(t,{isHeader:n},{at:e.findPath(t,r)})})}},t}(),dl={key:"insertTable",factory:function(){return new _c}},hl={key:"deleteTable",factory:function(){return new Nc}},pl={key:"insertTableRow",factory:function(){return new Dc}},gl={key:"deleteTableRow",factory:function(){return new Sc}},yl={key:"insertTableCol",factory:function(){return new Ic}},bl={key:"deleteTableCol",factory:function(){return new xc}},ml={key:"tableHeader",factory:function(){return new vl}},wl={key:"tableFullWidth",factory:function(){return new Mc}},xl={key:"mergeTableCell",factory:function(){return new $c}},Sl={key:"splitTableCell",factory:function(){return new sl}},Nl={key:"setTableProperty",factory:function(){return new Yu}},Ml={key:"setTableCellProperty",factory:function(){return new Xu}},Tl={};!function(){if(fl)return Tl;fl=1;var t=In(),e=ro().filter;t({target:"Array",proto:!0,forced:!Wn()("filter")},{filter:function(t){return e(this,t,arguments.length>1?arguments[1]:void 0)}})}();var zl,El,kl,Ol,Al,Cl={};function Il(){if(Ol)return kl;Ol=1;var t=Wt(),e=Pe(),r=Math.floor,n=t("".charAt),o=t("".replace),i=t("".slice),a=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,u=/\$([$&'`]|\d{1,2})/g;return kl=function(t,c,l,f,s,v){var d=l+t.length,h=f.length,p=u;return void 0!==s&&(s=e(s),p=a),o(v,p,function(e,o){var a;switch(n(o,0)){case"$":return"$";case"&":return t;case"`":return i(c,0,l);case"'":return i(c,d);case"<":a=s[i(o,1,-1)];break;default:var u=+o;if(0===u)return e;if(u>h){var v=r(u/10);return 0===v?e:v<=h?void 0===f[v-1]?n(o,1):f[v-1]+n(o,1):e}a=f[u-1]}return void 0===a?"":a})}}!function(){if(Al)return Cl;Al=1;var t=function(){if(El)return zl;El=1;var t=X(),e=Function.prototype,r=e.apply,n=e.call;return zl="object"==typeof Reflect&&Reflect.apply||(t?n.bind(r):function(){return n.apply(r,arguments)}),zl}(),e=K(),r=Wt(),n=il(),o=U(),i=Ze(),a=Ut(),u=Yt(),c=qr(),l=Gr(),f=$o(),s=$t(),v=cl(),d=oe(),h=Il(),p=jc(),g=ll(),y=De()("replace"),b=Math.max,m=Math.min,w=r([].concat),x=r([].push),S=r("".indexOf),N=r("".slice),M=function(t){return void 0===t?t:String(t)},T="$0"==="a".replace(/./,"$0"),z=!!/./[y]&&""===/./[y]("a","$0");n("replace",function(r,n,o){var T=z?"$":"$0";return[function(t,r){var o=s(this),i=u(t)?d(t,y):void 0;return i?e(i,t,o,r):e(n,f(o),t,r)},function(e,r){var u=i(this),s=f(e);if("string"==typeof r&&-1===S(r,T)&&-1===S(r,"$<")){var d=o(n,u,s,r);if(d.done)return d.value}var y=a(r);y||(r=f(r));var z,E=f(p(u)),k=-1!==S(E,"g");k&&(z=-1!==S(E,"u"),u.lastIndex=0);for(var O,A=[];null!==(O=g(u,s))&&(x(A,O),k);){""===f(O[0])&&(u.lastIndex=v(s,l(u.lastIndex),z))}for(var C="",I=0,H=0;H<A.length;H++){for(var j,P=f((O=A[H])[0]),R=b(m(c(O.index),s.length),0),V=[],D=1;D<O.length;D++)x(V,M(O[D]));var L=O.groups;if(y){var B=w([P],V,R,s);void 0!==L&&x(B,L),j=f(t(r,void 0,B))}else j=h(P,s,R,V,L,r);R>=I&&(C+=N(s,I,R)+j,I=R+P.length)}return C+N(s,I)}]},!!o(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})||!T||z)}();var Hl={selector:"td:not([data-w-e-type]),th:not([data-w-e-type])",parseElemHtml:function(t,r,n){var o=d(t);0===(r=r.filter(function(t){return"paragraph"===e.getNodeType(t)||(!!f.isText(t)||!!n.isInline(t))})).length&&(r=[{text:o.text().replace(/\s+/gm," ")}]);var i=parseInt(o.attr("colSpan")||"1",10),a=parseInt(o.attr("rowSpan")||"1",10),u="none"===Ua(o,"display"),c=o.attr("width")||"auto";return{type:"table-cell",isHeader:"th"===Ga(o),colSpan:i,rowSpan:a,width:c,children:r,hidden:u}}};var jl={selector:"tr:not([data-w-e-type])",parseElemHtml:function(t,r,n){for(var o=d(t),i=[],a=0;a<r.length;a+=1){var u=r[a];if("table-cell"===e.getNodeType(u)){var c=u;if(c.hidden)continue;i.push(c)}}return{type:"table-row",height:parseInt(Ua(o,"height")||"0",10)||void 0,children:i}}};var Pl,Rl={selector:"table:not([data-w-e-type])",parseElemHtml:function(t,r,n){var o,i,a=d(t),u="auto";"100%"===Ua(a,"width")&&(u="100%"),"100%"===a.attr("width")&&(u="100%");var c={type:"table",width:u,height:parseInt(Ua(a,"height")||"0",10),children:r.filter(function(t){return"table-row"===e.getNodeType(t)})},l=(null===(o=a.find("tr")[0])||void 0===o?void 0:o.children)||[],f=(null===(i=a.find("colgroup")[0])||void 0===i?void 0:i.children)||null,s=r[r.length-1].children.length;if(f&&f.length===s)c.columnWidths=Array.from(f).map(function(t){return parseInt(t.getAttribute("width"),10)});else if(l.length>0){var v=[];Array.from(l).forEach(function(t){var e=parseInt(d(t).attr("colSpan")||"1",10),r=parseInt(Ua(d(t),"width")||"90",10);v.push(r);for(var n=1;n<e;n+=1)v.push(90)}),c.columnWidths=v}return c}},Vl=null===(Pl=null===window||void 0===window?void 0:window.getComputedStyle(document.documentElement))||void 0===Pl?void 0:Pl.getPropertyValue("--w-e-textarea-border-color");var Dl,Ll,Bl,Wl,_l,Fl={};!function(){if(_l)return Fl;_l=1;var t=In(),e=function(){if(Ll)return Dl;Ll=1;var t=Wt(),e=$t(),r=$o(),n=/"/g,o=t("".replace);return Dl=function(t,i,a,u){var c=r(e(t)),l="<"+i;return""!==a&&(l+=" "+a+'="'+o(r(u),n,"&quot;")+'"'),l+">"+c+"</"+i+">"}}(),r=function(){if(Wl)return Bl;Wl=1;var t=U();return Bl=function(e){return t(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})}}();t({target:"String",proto:!0,forced:r("anchor")},{anchor:function(t){return e(this,"a","name",t)}})}();var ql,$l;function Gl(t){var r=t.selection;if(null==r)return!1;var n=po(i.nodes(t,{match:function(t){return e.checkNodeType(t,"table-cell")}}),1)[0];if(n){var o=po(n,2)[1],a=i.start(t,o);if(v.equals(r.anchor,a))return!0}return!1}function Ul(t,e){var r=e.offset;if(0===r)return!1;var n=i.node(t,e);if(!f.isText(n[0]))return!1;var o=a.string(n[0]);return!(r>=o.length)&&("\n"===o[r-1]&&"\r"===o[r])}function Yl(t,r,n){var o=t.selection;if(null==o||"line"===r)return!1;var c=po(i.nodes(t,{match:function(t){return e.checkNodeType(t,"table-cell")}}),1)[0],s=o.anchor;if("backward"===n&&0===o.anchor.offset&&(s=i.before(t,o)),"forward"===n&&i.isEnd(t,o.anchor,o.anchor.path)&&(s=i.after(t,o)),null==s)return!1;var v=i.above(t,{at:s,match:function(t){return e.checkNodeType(t,"table-cell")}});if(null==v||null==c||!l.equals(v[1],c[1]))return!1;var d=i.node(t,s);if(!f.isText(d[0])||d[0].text.length<2)return!1;var h="backward"===n?[s.offset-2,s.offset]:[s.offset,s.offset+2],p=a.string(d[0]);return"\n\r"===p.slice.apply(p,go([],po(h),!1))?(u.insertText(t,p.slice(0,h[0])+p.slice(h[1]),{at:{anchor:i.start(t,s.path),focus:i.end(t,s.path)}}),!0):!!Ul(t,s)&&(u.insertText(t,p.slice(0,o.anchor.offset-1)+p.slice(o.anchor.offset+1),{at:{anchor:i.start(t,s.path),focus:i.end(t,s.path)}}),!0)}function Xl(t,r){return!!go([],po(i.nodes(t,{at:r,match:function(t){return"table"===e.getNodeType(t)}})),!1).find(function(){return!0})}function Kl(t){var r,n;try{for(var o=ho(["paragraph","header1","header2","header3","header4","header5","header6","blockquote","list-item","todo","divider"]),i=o.next();!i.done;i=o.next()){var a=i.value;if(e.getSelectedNodeByType(t,a))return!0}}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return!1}$l||($l=1,ql||(ql=1,Cu()("WeakSet",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},Iu())));var Jl={selector:"table",preParseHtml:function(t){var e=d(t);if("table"!==Ga(e))return t;var r=e.find("tbody");if(0===r.length)return t;var n=e.find("tr");e.append(n),r.remove();for(var o=e.find("td, th"),i=0;i<o.length;i+=1){var a=o[i],u=(l=d(a)).attr("style");if(u){/display\s*:\s*none/i.test(u)&&l.remove()}l.attr("width","auto")}var c=e.find("td, th");for(i=0;i<c.length;i+=1){a=c[i];var l,f=(l=d(a)).html()||"";f=(f=(f=f.replace(/<o:p[^>]*>[\s\S]*?<\/o:p>/gi,"")).replace(/<\/o:p>/gi,"")).replace(/<p[^>]*>([\s\S]*?)<\/p>/gi,function(t,e){var r=e.trim();return r&&"&nbsp;"!==r?e:""}),l.html(f)}return e[0]}};function Ql(t){var e,r,n=[],o=0;try{for(var i=ho(t),a=i.next();!a.done;a=i.next()){o+=a.value,n.push(o)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n}function Zl(t){var e,r,n=[],o=t.reduce(function(t,e){return t+e},0);try{for(var i=ho(t),a=i.next();!a.done;a=i.next()){var u=a.value;n.push(u/o)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n}var tf=null;var ef=!1,rf=!1,nf=0,of=null,af=d(window);af.on("mousedown",function(t){var e=t.target;if(e.closest('[data-block-type="table-cell"]'))ef=!0;else if("DIV"===e.tagName&&e.closest(".column-resizer-item")){if(null===of)return;rf=!0;var r=t.clientX;nf=r,document.body.style.cursor="col-resize",t.preventDefault()}af.on("mousemove",uf),af.on("mouseup",cf)});var uf=I(function(t){if(rf&&null!==of){t.preventDefault();var r,n=t.clientX,o=n-nf,a=po(i.nodes(of,{match:Uo(of,"table")}),1),c=po(a[0],1)[0],l=c.columnWidths,f=void 0===l?[]:l,s=c.resizingIndex,v=void 0===s?-1:s,d=e.getSelectedNodeByType(of,"table"),h=e.toDOMNode(of,d).querySelector(".table");if(h)r=function(t,e,r,n,o){var i=go([],po(t),!1);if(e<0||e>=t.length)return i;var a=o.getMenuConfig("insertTable").minWidth,u=parseInt((void 0===a?60:a).toString(),10)||60,c=r-(0===e?0:n[e-1]),l=Math.max(u,c);return i[e]=Math.floor(100*l)/100,i}(f,v,n-h.getBoundingClientRect().left,Ql(f),of);else r=function(t,e,r,n){var o=go([],po(t),!1),i=n.getMenuConfig("insertTable").minWidth,a=parseInt((void 0===i?60:i).toString(),10)||60,u=o[e],c=Math.max(a,u+r);return o[e]=Math.floor(100*c)/100,o}(f,v,o,of);u.setNodes(of,{columnWidths:r},{mode:"highest"})}},100);function cf(t){ef=!1,rf=!1,of=null,document.body.style.cursor="",af.off("mousemove",uf),af.off("mouseup",cf)}function lf(t,e){"mouseenter"===e.type?u.setNodes(t,{isResizing:!0},{mode:"highest"}):u.setNodes(t,{isResizing:!1},{mode:"highest"})}function ff(t){var e,r,n=[],o=0;try{for(var i=ho(t),a=i.next();!a.done;a=i.next()){o+=a.value,n.push(o)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n}var sf=!1,vf=0,df=null,hf=d(window);var pf=I(function(t){if(sf&&null!==df){t.preventDefault();var r,n=t.clientY,o=n-vf,a=po(i.nodes(df,{match:Uo(df,"table")}),1),c=po(a[0],1)[0],l=c.children,f=c.resizingRowIndex,s=void 0===f?-1:f,v=l.map(function(t){return t.height||30}),d=e.getSelectedNodeByType(df,"table"),h=e.toDOMNode(df,d).querySelector(".table");if(h)r=function(t,e,r,n,o){var i=go([],po(t),!1);if(e<0||e>=t.length)return i;var a=(o.getMenuConfig("insertTable")||{}).minRowHeight,u=parseInt((void 0===a?30:a).toString(),10)||30,c=r-(0===e?0:n[e-1]),l=Math.max(u,c);return i[e]=Math.floor(100*l)/100,i}(v,s,n-h.getBoundingClientRect().top,ff(v),df);else r=function(t,e,r,n){var o=go([],po(t),!1),i=(n.getMenuConfig("insertTable")||{}).minRowHeight,a=parseInt((void 0===i?30:i).toString(),10)||30,u=o[e],c=Math.max(a,u+r);return o[e]=Math.floor(100*c)/100,o}(v,s,o,df);var p=e.getSelectedNodeByType(df,"table");if(p&&s>=0&&s<r.length){var g=go(go([],po(e.findPath(df,p)),!1),[s],!1);try{u.setNodes(df,{height:r[s]},{at:g})}catch(t){console.warn("更新行高度失败:",t)}}}},100);function gf(t){sf=!1,df=null,document.body.style.cursor="",hf.off("mousemove",pf),hf.off("mouseup",gf)}function yf(t,e){"mouseenter"===e.type?u.setNodes(t,{isResizingRow:!0},{mode:"highest"}):u.setNodes(t,{isResizingRow:!1},{mode:"highest"})}hf.on("mousedown",function(t){var e=t.target;if("DIV"===e.tagName&&e.closest(".row-resizer-item")){if(null===df)return;sf=!0;var r=t.clientY;vf=r,document.body.style.cursor="row-resize",t.preventDefault()}hf.on("mousemove",pf),hf.on("mouseup",gf)});var bf,mf,wf,xf={type:"table",renderElem:function(t,r,o){var a=function(t,r){if(t.isDisabled())return!1;var n=t.selection;if(null==n)return!0;if(c.isCollapsed(n))return!0;var o=n.anchor,a=n.focus,u=e.findPath(t,r),f=i.start(t,u),s=i.end(t,u),d=v.compare(o,s)<=0&&v.compare(o,f)>=0,h=v.compare(a,s)<=0&&v.compare(a,f)>=0;return!!(d&&h&&l.equals(o.path.slice(0,3),a.path.slice(0,3)))}(o,t),f=t,s=f.width,d=void 0===s?"auto":s,h=f.height,p=f.columnWidths,g=void 0===p?[]:p,y=f.scrollWidth,b=void 0===y?0:y,m=f.isHoverCellBorder,w=f.resizingIndex,x=f.isResizing,S=f.isHoverRowBorder,N=f.resizingRowIndex,M=f.isResizingRow,T=e.isNodeSelected(o,t),z=po(qc.selection(o),1)[0],E=Zl(g),k=O("div",{className:"table-container","data-selected":T,on:{mousedown:function(r){if("DIV"===r.target.tagName&&r.preventDefault(),!o.isDisabled()){r.target.closest('[data-block-type="table-cell"]')&&qc.unselect(o);var n=e.findPath(o,t),a=i.start(o,n),u=o.selection;if(null!=u)u.anchor.path[0]!==n[0]&&"DIV"===r.target.tagName&&o.select(a);else o.select(a)}}}},O("table",{width:d,contentEditable:a,className:"table ".concat(z?"table-selection-none":""),style:{width:"100%"===d?d:"".concat(g.reduce(function(t,e){return t+e},0),"px")},on:{mousemove:C(function(e){!function(t,e,r,o){if(!t.isDisabled()&&!ef&&!rf){var i=e,a=i.width,c=void 0===a?"auto":a,l=i.columnWidths,f=void 0===l?[]:l,s=i.isHoverCellBorder,v=i.resizingIndex,d=r.clientX,h=r.target;if(n(h)&&d>(y=h.getBoundingClientRect()).x+5&&d<y.x+y.width-5)return void(s&&u.setNodes(t,{isHoverCellBorder:!1,resizingIndex:-1},{mode:"highest"}));if(n(h)){var p=h.closest(".table");if(p)for(var g=r.clientX,y=p.getBoundingClientRect(),b=Ql("100%"===c?Zl(f).map(function(t){return t*o}):f),m=0;m<b.length;m+=1)if(g-y.x>=b[m]-5&&g-y.x<b[m]+5){if(v===m)return;return void u.setNodes(t,{isHoverCellBorder:!0,resizingIndex:m},{mode:"highest"})}}!0===s&&u.setNodes(t,{isHoverCellBorder:!1,resizingIndex:-1},{mode:"highest"})}}(o,t,e,b),function(t,e,r){if(!t.isDisabled()&&!sf){var o=e,i=o.children,a=o.isHoverRowBorder,c=o.resizingRowIndex,l=r.target;if(n(l)){var f=l.closest(".table");if(f)for(var s=r.clientY,v=f.getBoundingClientRect(),d=ff(i.map(function(t){return t.height||30})),h=0;h<d.length;h+=1)if(s-v.y>=d[h]-5&&s-v.y<d[h]+5){if(c===h)return;return void u.setNodes(t,{isHoverRowBorder:!0,resizingRowIndex:h},{mode:"highest"})}}!0===a&&u.setNodes(t,{isHoverRowBorder:!1,resizingRowIndex:-1},{mode:"highest"})}}(o,t,e)},25)}},O("colgroup",{contentEditable:!1},g.map(function(t){return O("col",{width:t})})),O("tbody",null,r)),O("div",{className:"column-resizer",contentEditable:!1},g.map(function(t,e){var r=t;return"100%"===d&&(r=E[e]*b),O("div",{className:"column-resizer-item",style:{minWidth:"".concat(r,"px")}},O("div",{className:"resizer-line-hotzone ".concat(m&&e===w?"visible ":"").concat(x&&e===w?"highlight":""),style:{height:"".concat(h,"px")},on:{mouseenter:function(t){return lf(o,t)},mouseleave:function(t){return lf(o,t)},mousedown:function(t){return function(t){rf||(of=t)}(o)}}},O("div",{className:"resizer-line"})))})),O("div",{className:"row-resizer",contentEditable:!1},t.children.map(function(t,e){var r=g.reduce(function(t,e){return t+e},0),n=t.height||30;return O("div",{className:"row-resizer-item",style:{minHeight:"".concat(n,"px")}},O("div",{className:"resizer-line-hotzone-horizontal ".concat(S&&e===N?"visible ":"").concat(M&&e===N?"highlight":""),style:{width:"".concat(r,"px")},on:{mouseenter:function(t){return yf(o,t)},mouseleave:function(t){return yf(o,t)},mousedown:function(t){return function(t){sf||(df=t)}(o)}}},O("div",{className:"resizer-line-horizontal"})))}))),I=A("div",{hook:{insert:function(t){var e=t.elm;return function(t,e){if(n(e)){var r=e.querySelector("table");r&&(tf=new ResizeObserver(function(e){var r=po(e,1)[0].contentRect;u.setNodes(t,{scrollWidth:r.width,height:r.height},{mode:"highest"})}),tf.observe(r))}}(o,e)},destroy:function(){tf&&(null==tf||tf.disconnect(),tf=null)}}},k);return I}},Sf={type:"table-row",renderElem:function(t,e,r){var n=t.height;return O("tr",{style:n?{height:"".concat(n,"px")}:{}},e)}},Nf={type:"table-cell",renderElem:function(t,r,n){var o=function(t,r){var n=e.getParentNode(t,r);if(null==n)return!1;var o=e.getParentNode(t,n);return null!=o&&Tc(o).some(function(t){return t===r})}(n,t),i=t,a=i.colSpan,u=void 0===a?1:a,c=i.rowSpan,l=void 0===c?1:c,f=i.isHeader,s=void 0!==f&&f,v=i.hidden,d=void 0!==v&&v,h=qc.isSelected(n,t);return O(o&&s?"th":"td",{colSpan:u,rowSpan:l,"data-block-type":"table-cell",className:h?"w-e-selected":"",style:{display:d?"none":""}},r)}},Mf={};function Tf(t,e){null==t.data&&(t.data={});var r=t.data;null==r.style&&(r.style={}),Object.assign(r.style,e)}!function(){if(wf)return Mf;wf=1;var t=In(),e=function(){if(mf)return bf;mf=1;var t=Y(),e=Wt(),r=K(),n=U(),o=Ao(),i=kn(),a=Lt(),u=Pe(),c=Ft(),l=Object.assign,f=Object.defineProperty,s=e([].concat);return bf=!l||n(function(){if(t&&1!==l({b:1},l(f({},"a",{enumerable:!0,get:function(){f(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},r={},n=Symbol("assign detection"),i="abcdefghijklmnopqrst";return e[n]=7,i.split("").forEach(function(t){r[t]=t}),7!==l({},e)[n]||o(l({},r)).join("")!==i})?function(e,n){for(var l=u(e),f=arguments.length,v=1,d=i.f,h=a.f;f>v;)for(var p,g=c(arguments[v++]),y=d?s(o(g),d(g)):o(g),b=y.length,m=0;b>m;)p=y[m++],t&&!r(h,g,p)||(l[p]=g[p]);return l}:l,bf}();t({target:"Object",stat:!0,arity:2,forced:Object.assign!==e},{assign:e})}();var zf={renderStyle:function(t,e){var r,n;if(!o.isElement(t))return e;var i=t,a=i.backgroundColor,u=i.borderWidth,c=i.borderStyle,l=i.borderColor,f=i.textAlign,s={};a&&(s.backgroundColor=a),u&&(s.borderWidth="".concat(u,"px")),c&&(s.borderStyle="none"===c?"":c),l&&(s.borderColor=l),f&&(s.textAlign=f);var v=e;return"table"===t.type?Tf(null===(n=(null===(r=v.children)||void 0===r?void 0:r[0]).children)||void 0===n?void 0:n[0],s):Tf(v,s),v},styleToHtml:function(t,e){if("table"!==t.type&&"table-cell"!==t.type)return e;var r=t.backgroundColor,n=t.borderWidth,o=t.borderStyle,i=t.borderColor,a=t.textAlign;if(!(r||n||o||i||a))return e;var u=d(e);return r&&u.css("background-color",r),n&&u.css("border-width","".concat(n,"px")),o&&u.css("border-style","none"===o?"":o),i&&u.css("border-color",i),a&&u.css("text-align",a),function(t){return 0===t.length?"":t[0].outerHTML}(u)},parseStyleHtml:function(t,e,r){if(!["TABLE","TD","TH"].includes(t.tagName))return e;var n=d(t),o=e,i=Ua(n,"background-color");i||(i=Ua(n,"background")),i&&(o.backgroundColor=i);var a=Ua(n,"border");a||"TD"!==t.tagName||(a="1px solid ".concat(Vl));var u=po((null==a?void 0:a.split(" "))||[],3),c=u[0],l=u[1],f=u[2];(c=Ua(n,"border-width")||c)&&(o.borderWidth=c.replace(/[^\d]/g,"")),(l=Ua(n,"border-style")||l)&&(o.borderStyle="none"===l?"":l),(f=Ua(n,"border-color")||f)&&(o.borderColor=f);var s=Ua(n,"text-align");return(s=Ua(n,"text-align")||s)&&(o.textAlign=s),e},renderElems:[xf,Sf,Nf],elemsToHtml:[uo,co,lo],preParseHtml:[Jl],parseElemsHtml:[Hl,jl,Rl],menus:[dl,hl,pl,gl,yl,bl,ml,wl,xl,Sl,Nl,Ml],editorPlugin:function(t){var r=t.insertBreak,n=t.deleteBackward,f=t.deleteForward,d=t.deleteFragment,h=t.normalizeNode,p=t.insertData,g=t.handleTab,y=t.selectAll,b=t;b.insertBreak=function(){null==e.getSelectedNodeByType(b,"table")?r():b.insertText("\n\r")},b.deleteBackward=function(t){if(!Gl(b)&&!Yl(b,t,"backward")){var r=b.selection;if(r){var o=i.before(b,r),a=i.above(b,{at:r,match:function(t){return e.checkNodeType(t,"table-cell")}});if(o){var u=Xl(b,o);if(!a&&u&&Kl(b))return}}n(t)}},b.handleTab=function(){var r;if(e.getSelectedNodeByType(b,"table")){var n=i.above(t);e.checkNodeType(n[0],"table-cell")&&u.select(t,n[1]);var o=i.next(t);if(o)o[0]&&o[0].text&&(o=null!==(r=i.above(t,{at:o[1]}))&&void 0!==r?r:o),u.select(t,o[1]);else{var a=b.children||[],c=a.length;if(e.checkNodeType(a[c-1],"table")){var l=e.genEmptyParagraph();u.insertNodes(b,l,{at:[c]}),b.handleTab()}}}else g()},b.deleteForward=function(t){if(!Gl(b)&&!Yl(b,t,"forward")){var r=b.selection;if(r){var n=i.after(b,r),o=i.above(b,{at:r,match:function(t){return e.checkNodeType(t,"table-cell")}});if(n){var a=Xl(b,n);if(!o&&a&&Kl(b))return}}f(t)}},b.deleteFragment=function(t){var e=b.selection;if(e){var r,n=!1,o={anchor:e.anchor,focus:e.focus},a=v.isBefore(o.anchor,o.focus);if(Ul(b,e.anchor))(r=i[a?"before":"after"](b,e.anchor))&&(o.anchor=r),n=!0;if(Ul(b,e.focus))(r=i[a?"after":"before"](b,e.focus))&&(o.focus=r),n=!0;n&&u.setSelection(b,o),d(t)}},b.normalizeNode=function(t){var r=po(t,2),n=r[0],o=r[1];if("table"!==e.getNodeType(n))return h([n,o]);if(e.isLastNode(b,n)){var i=e.genEmptyParagraph();u.insertNodes(b,i,{at:[o[0]+1]})}},b.insertData=function(t){if(null!=e.getSelectedNodeByType(b,"table")){var r=t.getData("text/plain");"\n"===r||/<img[^>]+>/.test(t.getData("text/html"))?p(t):i.insertText(b,r)}else p(t)},b.selectAll=function(){var t=b.selection;if(null!=t){var r=e.getSelectedNodeByType(b,"table-cell");if(null!=r){var n=t.anchor,o=t.focus;if(l.equals(n.path.slice(0,3),o.path.slice(0,3)))if(0!==a.string(r).length){var u=e.findPath(b,r),c={anchor:i.start(b,u),focus:i.end(b,u)};b.select(c)}else y();else y()}else y()}else y()},function(t){var e=t.apply;t.apply=function(r){if(!s.isSelectionOperation(r)||!r.newProperties)return e(r);var n=so(so({},t.selection),r.newProperties);if(!c.isRange(n))return qc.unselect(t),e(r);var a=function(t){return o.isElement(t)&&("table-cell"===t.type||"th"===t.type||"td"===t.type)},u=po(i.nodes(t,{match:a,at:c.start(n),mode:"lowest"}),1)[0],f=po(i.nodes(t,{match:a,at:c.end(n),mode:"lowest"}),1)[0];if(!u||!f)return qc.unselect(t),e(r);var v=po(u,2)[1],d=po(f,2)[1];if(l.equals(v,d)||!Yo(t,[v,d],"table"))return qc.unselect(t),e(r);try{var h=Xo(t,{at:v});if(!h||0===h.length)return qc.unselect(t),e(r);for(var p=Jo.valueOf(0,0),g=Jo.valueOf(0,0),y=!1,b=!1,m=0;m<h.length;m+=1)if(h[m])for(var w=0;w<h[m].length;w+=1)if(h[m][w]){var x=po(h[m][w],1),S=po(x[0],2)[1];l.equals(v,S)&&(p.x=m,p.y=w,y=!0),l.equals(d,S)&&(g.x=m,g.y=w,b=!0)}if(!y||!b)return qc.unselect(t),e(r);for(var N=Jo.valueOf(Math.min(p.x,g.x),Math.min(p.y,g.y)),M=Jo.valueOf(Math.max(p.x,g.x),Math.max(p.y,g.y));;){var T=Jo.valueOf(N.x,N.y),z=Jo.valueOf(M.x,M.y);for(m=T.x;m<=z.x&&m<h.length;m+=1)if(h[m])for(w=T.y;w<=z.y&&w<h[m].length;w+=1)if(h[m][w]){var E=po(h[m][w],2)[1];if(E){var k=E.rtl,O=E.ltr,A=E.btt,C=E.ttb;T.x=Math.min(T.x,m-(C-1)),T.y=Math.min(T.y,w-(k-1)),z.x=Math.max(z.x,m+(A-1)),z.y=Math.max(z.y,w+(O-1))}}if(Jo.equals(N,T)&&Jo.equals(M,z))break;N=T,M=z}var I=[],H=new WeakSet;for(m=N.x;m<=M.x&&m<h.length;m+=1)if(h[m]){var j=[];for(w=N.y;w<=M.y&&w<h[m].length;w+=1)if(h[m][w]){var P=po(h[m][w],1),R=po(P[0],1)[0];R&&(H.add(R),j.push(h[m][w]))}j.length>0&&I.push(j)}Gu.set(t,I),Uu.set(t,H)}catch(n){return qc.unselect(t),e(r)}e(r)}}(b),b.getTableSelection=function(){return Gu.get(b)||null};var m=b.addMark,w=b.removeMark,x=so({},u);return b.addMark=function(t,e){var r=Gu.get(b);if(r&&r.length>0){var n=b.selection;r.forEach(function(r){r.forEach(function(r){var n=po(r[0],2)[1],o=i.start(b,n),a=i.end(b,n);u.select(b,{anchor:o,focus:a}),m(t,e)})}),n&&u.select(b,n)}else m(t,e)},b.removeMark=function(t){var e=Gu.get(b);if(e&&e.length>0){var r=b.selection;e.forEach(function(e){e.forEach(function(e){var r=po(e[0],2)[1],n=i.start(b,r),o=i.end(b,r);u.select(b,{anchor:n,focus:o}),w(t)})}),r&&u.select(b,r)}else w(t)},u.setNodes=function(t,e,r){if(void 0===r&&(r={}),t===b){var n=Gu.get(b);if(n&&n.length>0)return"hidden"in e||"rowSpan"in e||"colSpan"in e?void x.setNodes(t,e,r):void n.forEach(function(n){n.forEach(function(n){var o=po(n[0],2)[1];x.setNodes(t,e,so(so({},r),{at:o}))})})}x.setNodes(t,e,r)},b}};export{zf as default};
//# sourceMappingURL=index.mjs.map
