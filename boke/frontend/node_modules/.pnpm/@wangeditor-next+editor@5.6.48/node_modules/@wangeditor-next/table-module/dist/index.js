!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("@wangeditor-next/core"),require("slate"),require("dom7"),require("snabbdom"),require("lodash.debounce"),require("lodash.throttle")):"function"==typeof define&&define.amd?define(["@wangeditor-next/core","slate","dom7","snabbdom","lodash.debounce","lodash.throttle"],e):(t="undefined"!=typeof globalThis?globalThis:t||self).WangEditorTableModule=e(t.core,t.slate,t.$,t.snabbdom,t.debounce,t.throttle)}(this,function(t,e,r,n,o,i){"use strict";t.i18nAddResources("en",{tableModule:{modal:{border:"Border",borderWidth:"Width",bgColor:"Back color",align:"Text Align",ok:"OK"},color:{default:"Default color",clear:"Clear back color"},borderStyle:{none:"None",solid:"Solid",dotted:"Dotted",dashed:"Dashed",double:"Double",groove:"Groove",ridge:"Ridge",inset:"Inset",outset:"Outset"},deleteCol:"Delete column",deleteRow:"Delete row",deleteTable:"Delete table",widthAuto:"Fit width",insertCol:"Insert column",insertRow:"Insert row",insertTable:"Insert table",header:"Header",mergeCell:"merge cell",splitCell:"split cell",tableProperty:"Table property",cellProperty:"Cell property"}}),t.i18nAddResources("zh-CN",{tableModule:{modal:{border:"边框",borderWidth:"宽度",bgColor:"背景色",align:"对齐方式",ok:"确定"},color:{default:"默认颜色",clear:"清除背景色"},borderStyle:{none:"无样式",solid:"实线",dotted:"点状虚线",dashed:"虚线",double:"双线",groove:"凹槽边框",ridge:"菱形边框",inset:"凹边框",outset:"凸边框"},deleteCol:"删除列",deleteRow:"删除行",deleteTable:"删除表格",widthAuto:"适应宽度",insertCol:"插入列",insertRow:"插入行",insertTable:"插入表格",header:"表头",mergeCell:"合并单元格",splitCell:"拆分单元格",tableProperty:"表格属性",cellProperty:"单元格属性"}});var a,u,c="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},l={};function f(){if(u)return a;u=1;var t=function(t){return t&&t.Math===Math&&t};return a=t("object"==typeof globalThis&&globalThis)||t("object"==typeof window&&window)||t("object"==typeof self&&self)||t("object"==typeof c&&c)||t("object"==typeof a&&a)||function(){return this}()||Function("return this")()}var s,d,v,h,p,g,y,m,b={};function w(){return d?s:(d=1,s=function(t){try{return!!t()}catch(t){return!0}})}function x(){if(h)return v;h=1;var t=w();return v=!t(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})}function E(){if(g)return p;g=1;var t=w();return p=!t(function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})}function S(){if(m)return y;m=1;var t=E(),e=Function.prototype.call;return y=t?e.bind(e):function(){return e.apply(e,arguments)},y}var T,N,M,z,k,O,D,A,C,H,I,j,P,R,V,L,B,W,_,F,q,$,G,U,Y,X,K,J,Q,Z,tt,et,rt,nt,ot,it,at,ut,ct,lt,ft,st={};function dt(){if(T)return st;T=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,r=e&&!t.call({1:2},1);return st.f=r?function(t){var r=e(this,t);return!!r&&r.enumerable}:t,st}function vt(){return M?N:(M=1,N=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}})}function ht(){if(k)return z;k=1;var t=E(),e=Function.prototype,r=e.call,n=t&&e.bind.bind(r,r);return z=t?n:function(t){return function(){return r.apply(t,arguments)}},z}function pt(){if(D)return O;D=1;var t=ht(),e=t({}.toString),r=t("".slice);return O=function(t){return r(e(t),8,-1)}}function gt(){if(C)return A;C=1;var t=ht(),e=w(),r=pt(),n=Object,o=t("".split);return A=e(function(){return!n("z").propertyIsEnumerable(0)})?function(t){return"String"===r(t)?o(t,""):n(t)}:n}function yt(){return I?H:(I=1,H=function(t){return null==t})}function mt(){if(P)return j;P=1;var t=yt(),e=TypeError;return j=function(r){if(t(r))throw new e("Can't call method on "+r);return r}}function bt(){if(V)return R;V=1;var t=gt(),e=mt();return R=function(r){return t(e(r))}}function wt(){if(B)return L;B=1;var t="object"==typeof document&&document.all;return L=void 0===t&&void 0!==t?function(e){return"function"==typeof e||e===t}:function(t){return"function"==typeof t}}function xt(){if(_)return W;_=1;var t=wt();return W=function(e){return"object"==typeof e?null!==e:t(e)}}function Et(){if(q)return F;q=1;var t=f(),e=wt();return F=function(r,n){return arguments.length<2?(o=t[r],e(o)?o:void 0):t[r]&&t[r][n];var o},F}function St(){if(G)return $;G=1;var t=ht();return $=t({}.isPrototypeOf)}function Tt(){if(Y)return U;Y=1;var t=f().navigator,e=t&&t.userAgent;return U=e?String(e):""}function Nt(){if(K)return X;K=1;var t,e,r=f(),n=Tt(),o=r.process,i=r.Deno,a=o&&o.versions||i&&i.version,u=a&&a.v8;return u&&(e=(t=u.split("."))[0]>0&&t[0]<4?1:+(t[0]+t[1])),!e&&n&&(!(t=n.match(/Edge\/(\d+)/))||t[1]>=74)&&(t=n.match(/Chrome\/(\d+)/))&&(e=+t[1]),X=e}function Mt(){if(Q)return J;Q=1;var t=Nt(),e=w(),r=f().String;return J=!!Object.getOwnPropertySymbols&&!e(function(){var e=Symbol("symbol detection");return!r(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&t&&t<41})}function zt(){if(tt)return Z;tt=1;var t=Mt();return Z=t&&!Symbol.sham&&"symbol"==typeof Symbol.iterator}function kt(){if(rt)return et;rt=1;var t=Et(),e=wt(),r=St(),n=zt(),o=Object;return et=n?function(t){return"symbol"==typeof t}:function(n){var i=t("Symbol");return e(i)&&r(i.prototype,o(n))}}function Ot(){if(ot)return nt;ot=1;var t=String;return nt=function(e){try{return t(e)}catch(t){return"Object"}}}function Dt(){if(at)return it;at=1;var t=wt(),e=Ot(),r=TypeError;return it=function(n){if(t(n))return n;throw new r(e(n)+" is not a function")}}function At(){if(ct)return ut;ct=1;var t=Dt(),e=yt();return ut=function(r,n){var o=r[n];return e(o)?void 0:t(o)}}function Ct(){if(ft)return lt;ft=1;var t=S(),e=wt(),r=xt(),n=TypeError;return lt=function(o,i){var a,u;if("string"===i&&e(a=o.toString)&&!r(u=t(a,o)))return u;if(e(a=o.valueOf)&&!r(u=t(a,o)))return u;if("string"!==i&&e(a=o.toString)&&!r(u=t(a,o)))return u;throw new n("Can't convert object to primitive value")}}var Ht,It,jt,Pt,Rt,Vt,Lt,Bt,Wt,_t,Ft,qt,$t,Gt,Ut,Yt,Xt,Kt,Jt,Qt,Zt,te,ee,re,ne={exports:{}};function oe(){return It?Ht:(It=1,Ht=!1)}function ie(){if(Pt)return jt;Pt=1;var t=f(),e=Object.defineProperty;return jt=function(r,n){try{e(t,r,{value:n,configurable:!0,writable:!0})}catch(e){t[r]=n}return n}}function ae(){if(Rt)return ne.exports;Rt=1;var t=oe(),e=f(),r=ie(),n="__core-js_shared__",o=ne.exports=e[n]||r(n,{});return(o.versions||(o.versions=[])).push({version:"3.46.0",mode:t?"pure":"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru), 2025 CoreJS Company (core-js.io)",license:"https://github.com/zloirock/core-js/blob/v3.46.0/LICENSE",source:"https://github.com/zloirock/core-js"}),ne.exports}function ue(){if(Lt)return Vt;Lt=1;var t=ae();return Vt=function(e,r){return t[e]||(t[e]=r||{})}}function ce(){if(Wt)return Bt;Wt=1;var t=mt(),e=Object;return Bt=function(r){return e(t(r))}}function le(){if(Ft)return _t;Ft=1;var t=ht(),e=ce(),r=t({}.hasOwnProperty);return _t=Object.hasOwn||function(t,n){return r(e(t),n)}}function fe(){if($t)return qt;$t=1;var t=ht(),e=0,r=Math.random(),n=t(1.1.toString);return qt=function(t){return"Symbol("+(void 0===t?"":t)+")_"+n(++e+r,36)}}function se(){if(Ut)return Gt;Ut=1;var t=f(),e=ue(),r=le(),n=fe(),o=Mt(),i=zt(),a=t.Symbol,u=e("wks"),c=i?a.for||a:a&&a.withoutSetter||n;return Gt=function(t){return r(u,t)||(u[t]=o&&r(a,t)?a[t]:c("Symbol."+t)),u[t]}}function de(){if(Xt)return Yt;Xt=1;var t=S(),e=xt(),r=kt(),n=At(),o=Ct(),i=se(),a=TypeError,u=i("toPrimitive");return Yt=function(i,c){if(!e(i)||r(i))return i;var l,f=n(i,u);if(f){if(void 0===c&&(c="default"),l=t(f,i,c),!e(l)||r(l))return l;throw new a("Can't convert object to primitive value")}return void 0===c&&(c="number"),o(i,c)}}function ve(){if(Jt)return Kt;Jt=1;var t=de(),e=kt();return Kt=function(r){var n=t(r,"string");return e(n)?n:n+""}}function he(){if(Zt)return Qt;Zt=1;var t=f(),e=xt(),r=t.document,n=e(r)&&e(r.createElement);return Qt=function(t){return n?r.createElement(t):{}}}function pe(){if(ee)return te;ee=1;var t=x(),e=w(),r=he();return te=!t&&!e(function(){return 7!==Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a})}function ge(){if(re)return b;re=1;var t=x(),e=S(),r=dt(),n=vt(),o=bt(),i=ve(),a=le(),u=pe(),c=Object.getOwnPropertyDescriptor;return b.f=t?c:function(t,l){if(t=o(t),l=i(l),u)try{return c(t,l)}catch(t){}if(a(t,l))return n(!e(r.f,t,l),t[l])},b}var ye,me,be,we,xe,Ee,Se,Te={};function Ne(){if(me)return ye;me=1;var t=x(),e=w();return ye=t&&e(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype})}function Me(){if(we)return be;we=1;var t=xt(),e=String,r=TypeError;return be=function(n){if(t(n))return n;throw new r(e(n)+" is not an object")}}function ze(){if(xe)return Te;xe=1;var t=x(),e=pe(),r=Ne(),n=Me(),o=ve(),i=TypeError,a=Object.defineProperty,u=Object.getOwnPropertyDescriptor,c="enumerable",l="configurable",f="writable";return Te.f=t?r?function(t,e,r){if(n(t),e=o(e),n(r),"function"==typeof t&&"prototype"===e&&"value"in r&&f in r&&!r[f]){var i=u(t,e);i&&i[f]&&(t[e]=r.value,r={configurable:l in r?r[l]:i[l],enumerable:c in r?r[c]:i[c],writable:!1})}return a(t,e,r)}:a:function(t,r,u){if(n(t),r=o(r),n(u),e)try{return a(t,r,u)}catch(t){}if("get"in u||"set"in u)throw new i("Accessors not supported");return"value"in u&&(t[r]=u.value),t},Te}function ke(){if(Se)return Ee;Se=1;var t=x(),e=ze(),r=vt();return Ee=t?function(t,n,o){return e.f(t,n,r(1,o))}:function(t,e,r){return t[e]=r,t}}var Oe,De,Ae,Ce,He,Ie,je,Pe,Re,Ve,Le,Be,We,_e,Fe,qe={exports:{}};function $e(){if(De)return Oe;De=1;var t=x(),e=le(),r=Function.prototype,n=t&&Object.getOwnPropertyDescriptor,o=e(r,"name"),i=o&&"something"===function(){}.name,a=o&&(!t||t&&n(r,"name").configurable);return Oe={EXISTS:o,PROPER:i,CONFIGURABLE:a}}function Ge(){if(Ce)return Ae;Ce=1;var t=ht(),e=wt(),r=ae(),n=t(Function.toString);return e(r.inspectSource)||(r.inspectSource=function(t){return n(t)}),Ae=r.inspectSource}function Ue(){if(Ie)return He;Ie=1;var t=f(),e=wt(),r=t.WeakMap;return He=e(r)&&/native code/.test(String(r))}function Ye(){if(Pe)return je;Pe=1;var t=ue(),e=fe(),r=t("keys");return je=function(t){return r[t]||(r[t]=e(t))}}function Xe(){return Ve?Re:(Ve=1,Re={})}function Ke(){if(Be)return Le;Be=1;var t,e,r,n=Ue(),o=f(),i=xt(),a=ke(),u=le(),c=ae(),l=Ye(),s=Xe(),d="Object already initialized",v=o.TypeError,h=o.WeakMap;if(n||c.state){var p=c.state||(c.state=new h);p.get=p.get,p.has=p.has,p.set=p.set,t=function(t,e){if(p.has(t))throw new v(d);return e.facade=t,p.set(t,e),e},e=function(t){return p.get(t)||{}},r=function(t){return p.has(t)}}else{var g=l("state");s[g]=!0,t=function(t,e){if(u(t,g))throw new v(d);return e.facade=t,a(t,g,e),e},e=function(t){return u(t,g)?t[g]:{}},r=function(t){return u(t,g)}}return Le={set:t,get:e,has:r,enforce:function(n){return r(n)?e(n):t(n,{})},getterFor:function(t){return function(r){var n;if(!i(r)||(n=e(r)).type!==t)throw new v("Incompatible receiver, "+t+" required");return n}}}}function Je(){if(We)return qe.exports;We=1;var t=ht(),e=w(),r=wt(),n=le(),o=x(),i=$e().CONFIGURABLE,a=Ge(),u=Ke(),c=u.enforce,l=u.get,f=String,s=Object.defineProperty,d=t("".slice),v=t("".replace),h=t([].join),p=o&&!e(function(){return 8!==s(function(){},"length",{value:8}).length}),g=String(String).split("String"),y=qe.exports=function(t,e,r){"Symbol("===d(f(e),0,7)&&(e="["+v(f(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),r&&r.getter&&(e="get "+e),r&&r.setter&&(e="set "+e),(!n(t,"name")||i&&t.name!==e)&&(o?s(t,"name",{value:e,configurable:!0}):t.name=e),p&&r&&n(r,"arity")&&t.length!==r.arity&&s(t,"length",{value:r.arity});try{r&&n(r,"constructor")&&r.constructor?o&&s(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var a=c(t);return n(a,"source")||(a.source=h(g,"string"==typeof e?e:"")),t};return Function.prototype.toString=y(function(){return r(this)&&l(this).source||a(this)},"toString"),qe.exports}function Qe(){if(Fe)return _e;Fe=1;var t=wt(),e=ze(),r=Je(),n=ie();return _e=function(o,i,a,u){u||(u={});var c=u.enumerable,l=void 0!==u.name?u.name:i;if(t(a)&&r(a,l,u),u.global)c?o[i]=a:n(i,a);else{try{u.unsafe?o[i]&&(c=!0):delete o[i]}catch(t){}c?o[i]=a:e.f(o,i,{value:a,enumerable:!1,configurable:!u.nonConfigurable,writable:!u.nonWritable})}return o}}var Ze,tr,er,rr,nr,or,ir,ar,ur,cr,lr,fr,sr,dr,vr,hr,pr,gr={};function yr(){if(rr)return er;rr=1;var t=function(){if(tr)return Ze;tr=1;var t=Math.ceil,e=Math.floor;return Ze=Math.trunc||function(r){var n=+r;return(n>0?e:t)(n)}}();return er=function(e){var r=+e;return r!=r||0===r?0:t(r)}}function mr(){if(or)return nr;or=1;var t=yr(),e=Math.max,r=Math.min;return nr=function(n,o){var i=t(n);return i<0?e(i+o,0):r(i,o)}}function br(){if(ar)return ir;ar=1;var t=yr(),e=Math.min;return ir=function(r){var n=t(r);return n>0?e(n,9007199254740991):0}}function wr(){if(cr)return ur;cr=1;var t=br();return ur=function(e){return t(e.length)}}function xr(){if(fr)return lr;fr=1;var t=bt(),e=mr(),r=wr(),n=function(n){return function(o,i,a){var u=t(o),c=r(u);if(0===c)return!n&&-1;var l,f=e(a,c);if(n&&i!=i){for(;c>f;)if((l=u[f++])!=l)return!0}else for(;c>f;f++)if((n||f in u)&&u[f]===i)return n||f||0;return!n&&-1}};return lr={includes:n(!0),indexOf:n(!1)}}function Er(){if(dr)return sr;dr=1;var t=ht(),e=le(),r=bt(),n=xr().indexOf,o=Xe(),i=t([].push);return sr=function(t,a){var u,c=r(t),l=0,f=[];for(u in c)!e(o,u)&&e(c,u)&&i(f,u);for(;a.length>l;)e(c,u=a[l++])&&(~n(f,u)||i(f,u));return f}}function Sr(){return hr?vr:(hr=1,vr=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"])}function Tr(){if(pr)return gr;pr=1;var t=Er(),e=Sr().concat("length","prototype");return gr.f=Object.getOwnPropertyNames||function(r){return t(r,e)},gr}var Nr,Mr,zr,kr,Or,Dr,Ar,Cr,Hr,Ir,jr,Pr,Rr,Vr,Lr,Br,Wr,_r,Fr,qr,$r,Gr,Ur,Yr,Xr,Kr,Jr,Qr,Zr={};function tn(){return Nr||(Nr=1,Zr.f=Object.getOwnPropertySymbols),Zr}function en(){if(zr)return Mr;zr=1;var t=Et(),e=ht(),r=Tr(),n=tn(),o=Me(),i=e([].concat);return Mr=t("Reflect","ownKeys")||function(t){var e=r.f(o(t)),a=n.f;return a?i(e,a(t)):e}}function rn(){if(Or)return kr;Or=1;var t=le(),e=en(),r=ge(),n=ze();return kr=function(o,i,a){for(var u=e(i),c=n.f,l=r.f,f=0;f<u.length;f++){var s=u[f];t(o,s)||a&&t(a,s)||c(o,s,l(i,s))}}}function nn(){if(Ar)return Dr;Ar=1;var t=w(),e=wt(),r=/#|\.prototype\./,n=function(r,n){var c=i[o(r)];return c===u||c!==a&&(e(n)?t(n):!!n)},o=n.normalize=function(t){return String(t).replace(r,".").toLowerCase()},i=n.data={},a=n.NATIVE="N",u=n.POLYFILL="P";return Dr=n}function on(){if(Hr)return Cr;Hr=1;var t=f(),e=ge().f,r=ke(),n=Qe(),o=ie(),i=rn(),a=nn();return Cr=function(u,c){var l,f,s,d,v,h=u.target,p=u.global,g=u.stat;if(l=p?t:g?t[h]||o(h,{}):t[h]&&t[h].prototype)for(f in c){if(d=c[f],s=u.dontCallGetSet?(v=e(l,f))&&v.value:l[f],!a(p?f:h+(g?".":"#")+f,u.forced)&&void 0!==s){if(typeof d==typeof s)continue;i(d,s)}(u.sham||s&&s.sham)&&r(d,"sham",!0),n(l,f,d,u)}}}function an(){if(jr)return Ir;jr=1;var t=pt();return Ir=Array.isArray||function(e){return"Array"===t(e)}}function un(){if(Rr)return Pr;Rr=1;var t=TypeError;return Pr=function(e){if(e>9007199254740991)throw t("Maximum allowed index exceeded");return e}}function cn(){if(Lr)return Vr;Lr=1;var t=x(),e=ze(),r=vt();return Vr=function(n,o,i){t?e.f(n,o,r(0,i)):n[o]=i}}function ln(){if(Wr)return Br;Wr=1;var t={};return t[se()("toStringTag")]="z",Br="[object z]"===String(t)}function fn(){if(Fr)return _r;Fr=1;var t=ln(),e=wt(),r=pt(),n=se()("toStringTag"),o=Object,i="Arguments"===r(function(){return arguments}());return _r=t?r:function(t){var a,u,c;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(u=function(t,e){try{return t[e]}catch(t){}}(a=o(t),n))?u:i?r(a):"Object"===(c=r(a))&&e(a.callee)?"Arguments":c}}function sn(){if($r)return qr;$r=1;var t=ht(),e=w(),r=wt(),n=fn(),o=Et(),i=Ge(),a=function(){},u=o("Reflect","construct"),c=/^\s*(?:class|function)\b/,l=t(c.exec),f=!c.test(a),s=function(t){if(!r(t))return!1;try{return u(a,[],t),!0}catch(t){return!1}},d=function(t){if(!r(t))return!1;switch(n(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return f||!!l(c,i(t))}catch(t){return!0}};return d.sham=!0,qr=!u||e(function(){var t;return s(s.call)||!s(Object)||!s(function(){t=!0})||t})?d:s}function dn(){if(Ur)return Gr;Ur=1;var t=an(),e=sn(),r=xt(),n=se()("species"),o=Array;return Gr=function(i){var a;return t(i)&&(a=i.constructor,(e(a)&&(a===o||t(a.prototype))||r(a)&&null===(a=a[n]))&&(a=void 0)),void 0===a?o:a}}function vn(){if(Xr)return Yr;Xr=1;var t=dn();return Yr=function(e,r){return new(t(e))(0===r?0:r)}}function hn(){if(Jr)return Kr;Jr=1;var t=w(),e=se(),r=Nt(),n=e("species");return Kr=function(e){return r>=51||!t(function(){var t=[];return(t.constructor={})[n]=function(){return{foo:1}},1!==t[e](Boolean).foo})}}!function(){if(Qr)return l;Qr=1;var t=on(),e=w(),r=an(),n=xt(),o=ce(),i=wr(),a=un(),u=cn(),c=vn(),f=hn(),s=se(),d=Nt(),v=s("isConcatSpreadable"),h=d>=51||!e(function(){var t=[];return t[v]=!1,t.concat()[0]!==t}),p=function(t){if(!n(t))return!1;var e=t[v];return void 0!==e?!!e:r(t)};t({target:"Array",proto:!0,arity:1,forced:!h||!f("concat")},{concat:function(t){var e,r,n,l,f,s=o(this),d=c(s,0),v=0;for(e=-1,n=arguments.length;e<n;e++)if(p(f=-1===e?s:arguments[e]))for(l=i(f),a(v+l),r=0;r<l;r++,v++)r in f&&u(d,v,f[r]);else a(v+1),u(d,v++,f);return d.length=v,d}})}();var pn,gn,yn,mn={};function bn(){if(gn)return pn;gn=1;var t=w();return pn=function(e,r){var n=[][e];return!!n&&t(function(){n.call(null,r||function(){return 1},1)})}}!function(){if(yn)return mn;yn=1;var t=on(),e=ht(),r=gt(),n=bt(),o=bn(),i=e([].join);t({target:"Array",proto:!0,forced:r!==Object||!o("join",",")},{join:function(t){return i(n(this),void 0===t?",":t)}})}();var wn,xn,En,Sn,Tn,Nn,Mn,zn={};function kn(){if(Sn)return En;Sn=1;var t=function(){if(xn)return wn;xn=1;var t=pt(),e=ht();return wn=function(r){if("Function"===t(r))return e(r)}}(),e=Dt(),r=E(),n=t(t.bind);return En=function(t,o){return e(t),void 0===o?t:r?n(t,o):function(){return t.apply(o,arguments)}},En}function On(){if(Nn)return Tn;Nn=1;var t=kn(),e=ht(),r=gt(),n=ce(),o=wr(),i=vn(),a=e([].push),u=function(e){var u=1===e,c=2===e,l=3===e,f=4===e,s=6===e,d=7===e,v=5===e||s;return function(h,p,g,y){for(var m,b,w=n(h),x=r(w),E=o(x),S=t(p,g),T=0,N=y||i,M=u?N(h,E):c||d?N(h,0):void 0;E>T;T++)if((v||T in x)&&(b=S(m=x[T],T,w),e))if(u)M[T]=b;else if(b)switch(e){case 3:return!0;case 5:return m;case 6:return T;case 2:a(M,m)}else switch(e){case 4:return!1;case 7:a(M,m)}return s?-1:l||f?f:M}};return Tn={forEach:u(0),map:u(1),filter:u(2),some:u(3),every:u(4),find:u(5),findIndex:u(6),filterReject:u(7)}}!function(){if(Mn)return zn;Mn=1;var t=on(),e=On().map;t({target:"Array",proto:!0,forced:!hn()("map")},{map:function(t){return e(this,t,arguments.length>1?arguments[1]:void 0)}})}();var Dn,An,Cn,Hn={};!function(){if(Cn)return Hn;Cn=1;var t=ln(),e=Qe(),r=function(){if(An)return Dn;An=1;var t=ln(),e=fn();return Dn=t?{}.toString:function(){return"[object "+e(this)+"]"}}();t||e(Object.prototype,"toString",r,{unsafe:!0})}();var In={type:"table",elemToHtml:function(t,e){var r=t,n=r.width,o=void 0===n?"auto":n,i=r.columnWidths,a=r.height,u=void 0===a?"auto":a,c=null==i?void 0:i.map(function(t){return"<col width=".concat(t,"></col>")}).join(""),l=c?'<colgroup contentEditable="false">'.concat(c,"</colgroup>"):"";return'<table style="width: '.concat(o,";table-layout: fixed;height:").concat(u,'">').concat(l,"<tbody>").concat(e,"</tbody></table>")}},jn={type:"table-row",elemToHtml:function(t,e){var r=t.height,n=r?' style="height: '.concat(r,'px"'):"";return"<tr".concat(n,">").concat(e,"</tr>")}},Pn={type:"table-cell",elemToHtml:function(t,e){var r=t,n=r.colSpan,o=void 0===n?1:n,i=r.rowSpan,a=void 0===i?1:i,u=r.isHeader,c=void 0!==u&&u,l=r.width,f=void 0===l?"auto":l,s=r.hidden;if(void 0!==s&&s)return"";var d=c?"th":"td";return"<".concat(d,' colSpan="').concat(o,'" rowSpan="').concat(a,'" width="').concat(f,'">').concat(e,"</").concat(d,">")}},Rn=function(t,e){return Rn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},Rn(t,e)};var Vn=function(){return Vn=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},Vn.apply(this,arguments)};function Ln(t,e){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=u(0),a.throw=u(1),a.return=u(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(c){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&u[0]?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return i.label++,{value:u[1],done:!1};case 5:i.label++,n=u[1],u=[0];continue;case 7:u=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){i=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){i.label=u[1];break}if(6===u[0]&&i.label<o[1]){i.label=o[1],o=u;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(u);break}o[2]&&i.ops.pop(),i.trys.pop();continue}u=e.call(t,i)}catch(t){u=[6,t],n=0}finally{r=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}}function Bn(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Wn(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function _n(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))}"function"==typeof SuppressedError&&SuppressedError;var Fn,qn,$n,Gn,Un,Yn,Xn,Kn,Jn,Qn,Zn='<svg viewBox="0 0 1024 1024"><path d="M236.8 128L896 787.2V128H236.8z m614.4 704L192 172.8V832h659.2zM192 64h704c38.4 0 64 25.6 64 64v704c0 38.4-25.6 64-64 64H192c-38.4 0-64-25.6-64-64V128c0-38.4 25.6-64 64-64z"></path></svg>',to={},eo={};function ro(){if(qn)return Fn;qn=1;var t=Er(),e=Sr();return Fn=Object.keys||function(r){return t(r,e)}}function no(){if(Un)return Gn;Un=1;var t=Et();return Gn=t("document","documentElement")}function oo(){if(Xn)return Yn;Xn=1;var t,e=Me(),r=function(){if($n)return eo;$n=1;var t=x(),e=Ne(),r=ze(),n=Me(),o=bt(),i=ro();return eo.f=t&&!e?Object.defineProperties:function(t,e){n(t);for(var a,u=o(e),c=i(e),l=c.length,f=0;l>f;)r.f(t,a=c[f++],u[a]);return t},eo}(),n=Sr(),o=Xe(),i=no(),a=he(),u=Ye(),c="prototype",l="script",f=u("IE_PROTO"),s=function(){},d=function(t){return"<"+l+">"+t+"</"+l+">"},v=function(t){t.write(d("")),t.close();var e=t.parentWindow.Object;return t=null,e},h=function(){try{t=new ActiveXObject("htmlfile")}catch(t){}var e,r,o;h="undefined"!=typeof document?document.domain&&t?v(t):(r=a("iframe"),o="java"+l+":",r.style.display="none",i.appendChild(r),r.src=String(o),(e=r.contentWindow.document).open(),e.write(d("document.F=Object")),e.close(),e.F):v(t);for(var u=n.length;u--;)delete h[c][n[u]];return h()};return o[f]=!0,Yn=Object.create||function(t,n){var o;return null!==t?(s[c]=e(t),o=new s,s[c]=null,o[f]=t):o=h(),void 0===n?o:r.f(o,n)}}function io(){if(Jn)return Kn;Jn=1;var t=se(),e=oo(),r=ze().f,n=t("unscopables"),o=Array.prototype;return void 0===o[n]&&r(o,n,{configurable:!0,value:e(null)}),Kn=function(t){o[n][t]=!0}}!function(){if(Qn)return to;Qn=1;var t=on(),e=xr().includes,r=w(),n=io();t({target:"Array",proto:!0,forced:r(function(){return!Array(1).includes()})},{includes:function(t){return e(this,t,arguments.length>1?arguments[1]:void 0)}}),n("includes")}();var ao,uo,co,lo,fo,so,vo,ho,po,go={};function yo(){if(lo)return co;lo=1;var t=function(){if(uo)return ao;uo=1;var t=xt(),e=pt(),r=se()("match");return ao=function(n){var o;return t(n)&&(void 0!==(o=n[r])?!!o:"RegExp"===e(n))}}(),e=TypeError;return co=function(r){if(t(r))throw new e("The method doesn't accept regular expressions");return r}}function mo(){if(so)return fo;so=1;var t=fn(),e=String;return fo=function(r){if("Symbol"===t(r))throw new TypeError("Cannot convert a Symbol value to a string");return e(r)}}!function(){if(po)return go;po=1;var t=on(),e=ht(),r=yo(),n=mt(),o=mo(),i=function(){if(ho)return vo;ho=1;var t=se()("match");return vo=function(e){var r=/./;try{"/./"[e](r)}catch(n){try{return r[t]=!1,"/./"[e](r)}catch(t){}}return!1}}(),a=e("".indexOf);t({target:"String",proto:!0,forced:!i("includes")},{includes:function(t){return!!~a(o(n(this)),o(r(t)),arguments.length>1?arguments[1]:void 0)}})}();var bo={blocks:{td:"table-cell",th:"table-cell",content:"paragraph",tr:"table-row",table:"table",tbody:"table-body"}};function wo(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=bo,i=r.map(function(t){var e;return null===(e=null==o?void 0:o.blocks)||void 0===e?void 0:e[t]});return function(t){return function(t){return!e.Editor.isEditor(t)&&e.Element.isElement(t)&&"type"in t}(t)&&i.includes(t.type)}}function xo(t,r){for(var n=Wn(r,2),o=n[0],i=n[1],a=[],u=2;u<arguments.length;u++)a[u-2]=arguments[u];var c=Wn(e.Node.common(t,o,i),2),l=c[0],f=c[1];return!!wo.apply(void 0,_n([t],Wn(a),!1))(l,f)||!!e.Editor.above(t,{match:wo.apply(void 0,_n([t],Wn(a),!1)),at:f})}function Eo(t,r){var n,o;void 0===r&&(r={});var i=[];try{for(var a=Bn(function(t,r){var n,o,i,a,u,c,l,f,s,d,v,h,p,g,y,m,b,w;return void 0===r&&(r={}),Ln(this,function(x){switch(x.label){case 0:if(n=Wn(e.Editor.nodes(t,{match:wo(t,"table"),at:r.at}),1),!(o=n[0]))return[2,[]];i=Wn(o,2),a=i[1],x.label=1;case 1:x.trys.push([1,6,7,8]),u=Bn(e.Editor.nodes(t,{match:wo(t,"table"),at:a})),c=u.next(),x.label=2;case 2:if(c.done)return[3,5];l=Wn(c.value,2),f=l[1],s=[];try{for(b=void 0,d=Bn(e.Editor.nodes(t,{match:wo(t,"tr"),at:f})),v=d.next();!v.done;v=d.next())h=Wn(v.value,2),p=h[1],s.push(_n([],Wn(e.Editor.nodes(t,{match:wo(t,"th","td"),at:p})),!1))}catch(t){b={error:t}}finally{try{v&&!v.done&&(w=d.return)&&w.call(d)}finally{if(b)throw b.error}}return[4,s];case 3:x.sent(),x.label=4;case 4:return c=u.next(),[3,2];case 5:return[3,8];case 6:return g=x.sent(),y={error:g},[3,8];case 7:try{c&&!c.done&&(m=u.return)&&m.call(u)}finally{if(y)throw y.error}return[7];case 8:return[2]}})}(t,{at:r.at})),u=a.next();!u.done;u=a.next()){for(var c=u.value,l=[],f=0,s=0;s<c.length;s+=1)c[s]&&(f=Math.max(f,c[s].length));for(s=0;s<c.length;s+=1)if(l[s]||(l[s]=[]),c[s])for(var d=0;d<c[s].length;d+=1)if(c[s][d]&&c[s][d][0]){for(var v=Wn(c[s][d],1)[0],h=v.rowSpan,p=void 0===h?1:h,g=v.colSpan,y=void 0===g?1:g,m=d;l[s]&&l[s][m];)m+=1;for(var b=0;b<y;b+=1)for(var w=0;w<p;w+=1){var x=s+w,E=m+b;l[x]||(l[x]=[]),l[x][E]||(l[x][E]=[c[s][d],{rtl:b+1,ltr:y-b,ttb:w+1,btt:p-w}])}}i.push.apply(i,_n([],Wn(l),!1))}}catch(t){n={error:t}}finally{try{u&&!u.done&&(o=a.return)&&o.call(a)}finally{if(n)throw n.error}}return i}var So,To=function(){function t(t,e){this.x=t,this.y=e}return t.valueOf=function(t,e){return new this(t,e)},t.equals=function(t,e){return t.x===e.x&&t.y===e.y},t}(),No={};!function(){if(So)return No;So=1;var t=on(),e=On().find,r=io(),n="find",o=!0;n in[]&&Array(1)[n](function(){o=!1}),t({target:"Array",proto:!0,forced:o},{find:function(t){return e(this,t,arguments.length>1?arguments[1]:void 0)}}),r(n)}();var Mo,zo,ko,Oo,Do,Ao,Co,Ho,Io,jo,Po,Ro,Vo,Lo,Bo,Wo,_o,Fo={};function qo(){if(zo)return Mo;zo=1;var t=S(),e=Me(),r=At();return Mo=function(n,o,i){var a,u;e(n);try{if(!(a=r(n,"return"))){if("throw"===o)throw i;return i}a=t(a,n)}catch(t){u=!0,a=t}if("throw"===o)throw i;if(u)throw a;return e(a),i}}function $o(){if(Oo)return ko;Oo=1;var t=Me(),e=qo();return ko=function(r,n,o,i){try{return i?n(t(o)[0],o[1]):n(o)}catch(t){e(r,"throw",t)}}}function Go(){return Ao?Do:(Ao=1,Do={})}function Uo(){if(Ho)return Co;Ho=1;var t=se(),e=Go(),r=t("iterator"),n=Array.prototype;return Co=function(t){return void 0!==t&&(e.Array===t||n[r]===t)}}function Yo(){if(jo)return Io;jo=1;var t=fn(),e=At(),r=yt(),n=Go(),o=se()("iterator");return Io=function(i){if(!r(i))return e(i,o)||e(i,"@@iterator")||n[t(i)]}}function Xo(){if(Ro)return Po;Ro=1;var t=S(),e=Dt(),r=Me(),n=Ot(),o=Yo(),i=TypeError;return Po=function(a,u){var c=arguments.length<2?o(a):u;if(e(c))return r(t(c,a));throw new i(n(a)+" is not iterable")},Po}function Ko(){if(Wo)return Bo;Wo=1;var t=se()("iterator"),e=!1;try{var r=0,n={next:function(){return{done:!!r++}},return:function(){e=!0}};n[t]=function(){return this},Array.from(n,function(){throw 2})}catch(t){}return Bo=function(r,n){try{if(!n&&!e)return!1}catch(t){return!1}var o=!1;try{var i={};i[t]=function(){return{next:function(){return{done:o=!0}}}},r(i)}catch(t){}return o}}!function(){if(_o)return Fo;_o=1;var t=on(),e=function(){if(Lo)return Vo;Lo=1;var t=kn(),e=S(),r=ce(),n=$o(),o=Uo(),i=sn(),a=wr(),u=cn(),c=Xo(),l=Yo(),f=Array;return Vo=function(s){var d=r(s),v=i(this),h=arguments.length,p=h>1?arguments[1]:void 0,g=void 0!==p;g&&(p=t(p,h>2?arguments[2]:void 0));var y,m,b,w,x,E,S=l(d),T=0;if(!S||this===f&&o(S))for(y=a(d),m=v?new this(y):f(y);y>T;T++)E=g?p(d[T],T):d[T],u(m,T,E);else for(m=v?new this:[],x=(w=c(d,S)).next;!(b=e(x,w)).done;T++)E=g?n(w,p,[b.value,T],!0):b.value,u(m,T,E);return m.length=T,m},Vo}();t({target:"Array",stat:!0,forced:!Ko()(function(t){Array.from(t)})},{from:e})}();var Jo,Qo,Zo,ti,ei,ri,ni,oi,ii,ai,ui,ci={};function li(){if(Qo)return Jo;Qo=1;var t=Me();return Jo=function(){var e=t(this),r="";return e.hasIndices&&(r+="d"),e.global&&(r+="g"),e.ignoreCase&&(r+="i"),e.multiline&&(r+="m"),e.dotAll&&(r+="s"),e.unicode&&(r+="u"),e.unicodeSets&&(r+="v"),e.sticky&&(r+="y"),r}}function fi(){if(ti)return Zo;ti=1;var t=w(),e=f().RegExp,r=t(function(){var t=e("a","y");return t.lastIndex=2,null!==t.exec("abcd")}),n=r||t(function(){return!e("a","y").sticky}),o=r||t(function(){var t=e("^r","gy");return t.lastIndex=2,null!==t.exec("str")});return Zo={BROKEN_CARET:o,MISSED_STICKY:n,UNSUPPORTED_Y:r}}function si(){if(ai)return ii;ai=1;var t,e,r=S(),n=ht(),o=mo(),i=li(),a=fi(),u=ue(),c=oo(),l=Ke().get,s=function(){if(ri)return ei;ri=1;var t=w(),e=f().RegExp;return ei=t(function(){var t=e(".","s");return!(t.dotAll&&t.test("\n")&&"s"===t.flags)})}(),d=function(){if(oi)return ni;oi=1;var t=w(),e=f().RegExp;return ni=t(function(){var t=e("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")})}(),v=u("native-string-replace",String.prototype.replace),h=RegExp.prototype.exec,p=h,g=n("".charAt),y=n("".indexOf),m=n("".replace),b=n("".slice),x=(e=/b*/g,r(h,t=/a/,"a"),r(h,e,"a"),0!==t.lastIndex||0!==e.lastIndex),E=a.BROKEN_CARET,T=void 0!==/()??/.exec("")[1];return(x||T||E||s||d)&&(p=function(t){var e,n,a,u,f,s,d,w=this,S=l(w),N=o(t),M=S.raw;if(M)return M.lastIndex=w.lastIndex,e=r(p,M,N),w.lastIndex=M.lastIndex,e;var z=S.groups,k=E&&w.sticky,O=r(i,w),D=w.source,A=0,C=N;if(k&&(O=m(O,"y",""),-1===y(O,"g")&&(O+="g"),C=b(N,w.lastIndex),w.lastIndex>0&&(!w.multiline||w.multiline&&"\n"!==g(N,w.lastIndex-1))&&(D="(?: "+D+")",C=" "+C,A++),n=new RegExp("^(?:"+D+")",O)),T&&(n=new RegExp("^"+D+"$(?!\\s)",O)),x&&(a=w.lastIndex),u=r(h,k?n:w,C),k?u?(u.input=b(u.input,A),u[0]=b(u[0],A),u.index=w.lastIndex,w.lastIndex+=u[0].length):w.lastIndex=0:x&&u&&(w.lastIndex=w.global?u.index+u[0].length:a),T&&u&&u.length>1&&r(v,u[0],n,function(){for(f=1;f<arguments.length-2;f++)void 0===arguments[f]&&(u[f]=void 0)}),u&&z)for(u.groups=s=c(null),f=0;f<z.length;f++)s[(d=z[f])[0]]=u[d[1]];return u}),ii=p}function di(){if(ui)return ci;ui=1;var t=on(),e=si();return t({target:"RegExp",proto:!0,forced:/./.exec!==e},{exec:e}),ci}di();var vi,hi,pi,gi,yi,mi,bi,wi,xi,Ei,Si,Ti,Ni,Mi,zi,ki,Oi,Di,Ai,Ci,Hi,Ii,ji,Pi,Ri,Vi={};function Li(){if(hi)return vi;hi=1;var t=ht(),e=yr(),r=mo(),n=mt(),o=t("".charAt),i=t("".charCodeAt),a=t("".slice),u=function(t){return function(u,c){var l,f,s=r(n(u)),d=e(c),v=s.length;return d<0||d>=v?t?"":void 0:(l=i(s,d))<55296||l>56319||d+1===v||(f=i(s,d+1))<56320||f>57343?t?o(s,d):l:t?a(s,d,d+2):f-56320+(l-55296<<10)+65536}};return vi={codeAt:u(!1),charAt:u(!0)}}function Bi(){if(mi)return yi;mi=1;var t=le(),e=wt(),r=ce(),n=Ye(),o=function(){if(gi)return pi;gi=1;var t=w();return pi=!t(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})}(),i=n("IE_PROTO"),a=Object,u=a.prototype;return yi=o?a.getPrototypeOf:function(n){var o=r(n);if(t(o,i))return o[i];var c=o.constructor;return e(c)&&o instanceof c?c.prototype:o instanceof a?u:null}}function Wi(){if(wi)return bi;wi=1;var t,e,r,n=w(),o=wt(),i=xt(),a=oo(),u=Bi(),c=Qe(),l=se(),f=oe(),s=l("iterator"),d=!1;return[].keys&&("next"in(r=[].keys())?(e=u(u(r)))!==Object.prototype&&(t=e):d=!0),!i(t)||n(function(){var e={};return t[s].call(e)!==e})?t={}:f&&(t=a(t)),o(t[s])||c(t,s,function(){return this}),bi={IteratorPrototype:t,BUGGY_SAFARI_ITERATORS:d}}function _i(){if(Ei)return xi;Ei=1;var t=ze().f,e=le(),r=se()("toStringTag");return xi=function(n,o,i){n&&!i&&(n=n.prototype),n&&!e(n,r)&&t(n,r,{configurable:!0,value:o})}}function Fi(){if(ki)return zi;ki=1;var t=xt();return zi=function(e){return t(e)||null===e}}function qi(){if(Di)return Oi;Di=1;var t=Fi(),e=String,r=TypeError;return Oi=function(n){if(t(n))return n;throw new r("Can't set "+e(n)+" as a prototype")}}function $i(){if(Ci)return Ai;Ci=1;var t=function(){if(Mi)return Ni;Mi=1;var t=ht(),e=Dt();return Ni=function(r,n,o){try{return t(e(Object.getOwnPropertyDescriptor(r,n)[o]))}catch(t){}}}(),e=xt(),r=mt(),n=qi();return Ai=Object.setPrototypeOf||("__proto__"in{}?function(){var o,i=!1,a={};try{(o=t(Object.prototype,"__proto__","set"))(a,[]),i=a instanceof Array}catch(t){}return function(t,a){return r(t),n(a),e(t)?(i?o(t,a):t.__proto__=a,t):t}}():void 0)}function Gi(){if(Ii)return Hi;Ii=1;var t=on(),e=S(),r=oe(),n=$e(),o=wt(),i=function(){if(Ti)return Si;Ti=1;var t=Wi().IteratorPrototype,e=oo(),r=vt(),n=_i(),o=Go(),i=function(){return this};return Si=function(a,u,c,l){var f=u+" Iterator";return a.prototype=e(t,{next:r(+!l,c)}),n(a,f,!1,!0),o[f]=i,a}}(),a=Bi(),u=$i(),c=_i(),l=ke(),f=Qe(),s=se(),d=Go(),v=Wi(),h=n.PROPER,p=n.CONFIGURABLE,g=v.IteratorPrototype,y=v.BUGGY_SAFARI_ITERATORS,m=s("iterator"),b="keys",w="values",x="entries",E=function(){return this};return Hi=function(n,s,v,S,T,N,M){i(v,s,S);var z,k,O,D=function(t){if(t===T&&j)return j;if(!y&&t&&t in H)return H[t];switch(t){case b:case w:case x:return function(){return new v(this,t)}}return function(){return new v(this)}},A=s+" Iterator",C=!1,H=n.prototype,I=H[m]||H["@@iterator"]||T&&H[T],j=!y&&I||D(T),P="Array"===s&&H.entries||I;if(P&&(z=a(P.call(new n)))!==Object.prototype&&z.next&&(r||a(z)===g||(u?u(z,g):o(z[m])||f(z,m,E)),c(z,A,!0,!0),r&&(d[A]=E)),h&&T===w&&I&&I.name!==w&&(!r&&p?l(H,"name",w):(C=!0,j=function(){return e(I,this)})),T)if(k={values:D(w),keys:N?j:D(b),entries:D(x)},M)for(O in k)(y||C||!(O in H))&&f(H,O,k[O]);else t({target:s,proto:!0,forced:y||C},k);return r&&!M||H[m]===j||f(H,m,j,{name:T}),d[s]=j,k}}function Ui(){return Pi?ji:(Pi=1,ji=function(t,e){return{value:t,done:e}})}!function(){if(Ri)return Vi;Ri=1;var t=Li().charAt,e=mo(),r=Ke(),n=Gi(),o=Ui(),i="String Iterator",a=r.set,u=r.getterFor(i);n(String,"String",function(t){a(this,{type:i,string:e(t),index:0})},function(){var e,r=u(this),n=r.string,i=r.index;return i>=n.length?o(void 0,!0):(e=t(n,i),r.index+=e.length,o(e,!1))})}();var Yi,Xi,Ki,Ji,Qi,Zi,ta,ea={};function ra(){return Xi?Yi:(Xi=1,Yi={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0})}function na(){if(Ji)return Ki;Ji=1;var t=he()("span").classList,e=t&&t.constructor&&t.constructor.prototype;return Ki=e===Object.prototype?void 0:e}!function(){if(ta)return ea;ta=1;var t=f(),e=ra(),r=na(),n=function(){if(Zi)return Qi;Zi=1;var t=On().forEach,e=bn()("forEach");return Qi=e?[].forEach:function(e){return t(this,e,arguments.length>1?arguments[1]:void 0)},Qi}(),o=ke(),i=function(t){if(t&&t.forEach!==n)try{o(t,"forEach",n)}catch(e){t.forEach=n}};for(var a in e)e[a]&&i(t[a]&&t[a].prototype);i(r)}();var oa,ia,aa,ua,ca,la,fa,sa={};function da(){return ia?oa:(ia=1,oa="\t\n\v\f\r                　\u2028\u2029\ufeff")}function va(){if(ua)return aa;ua=1;var t=ht(),e=mt(),r=mo(),n=da(),o=t("".replace),i=RegExp("^["+n+"]+"),a=RegExp("(^|[^"+n+"])["+n+"]+$"),u=function(t){return function(n){var u=r(e(n));return 1&t&&(u=o(u,i,"")),2&t&&(u=o(u,a,"$1")),u}};return aa={start:u(1),end:u(2),trim:u(3)}}!function(){if(fa)return sa;fa=1;var t=on(),e=va().trim,r=function(){if(la)return ca;la=1;var t=$e().PROPER,e=w(),r=da();return ca=function(n){return e(function(){return!!r[n]()||"​᠎"!=="​᠎"[n]()||t&&r[n].name!==n})}}();t({target:"String",proto:!0,forced:r("trim")},{trim:function(){return e(this)}})}();var ha,pa,ga,ya,ma={};function ba(t){return t.length?t[0].tagName.toLowerCase():""}function wa(t,e){for(var r="",n=(t.attr("style")||"").split(";"),o=n.length,i=0;i<o;i+=1){var a=n[i];if(a){var u=a.split(":");u[0].trim()===e&&(r=u[1].trim())}}return r}function xa(){if(ya)return ga;ya=1;var t=bt(),e=io(),r=Go(),n=Ke(),o=ze().f,i=Gi(),a=Ui(),u=oe(),c=x(),l="Array Iterator",f=n.set,s=n.getterFor(l);ga=i(Array,"Array",function(e,r){f(this,{type:l,target:t(e),index:0,kind:r})},function(){var t=s(this),e=t.target,r=t.index++;if(!e||r>=e.length)return t.target=null,a(void 0,!0);switch(t.kind){case"keys":return a(r,!1);case"values":return a(e[r],!1)}return a([r,e[r]],!1)},"values");var d=r.Arguments=r.Array;if(e("keys"),e("values"),e("entries"),!u&&c&&"values"!==d.name)try{o(d,"name",{value:"values"})}catch(t){}return ga}pa||(pa=1,function(){if(ha)return ma;ha=1;var t=on(),e=f();t({global:!0,forced:e.globalThis!==e},{globalThis:e})}()),r.append&&r.fn&&(r.fn.append=r.append),r.on&&r.fn&&(r.fn.on=r.on),r.focus&&r.fn&&(r.fn.focus=r.focus),r.attr&&r.fn&&(r.fn.attr=r.attr),r.val&&r.fn&&(r.fn.val=r.val),r.html&&r.fn&&(r.fn.html=r.html),r.dataset&&r.fn&&(r.fn.dataset=r.dataset),r.addClass&&r.fn&&(r.fn.addClass=r.addClass),r.removeClass&&r.fn&&(r.fn.removeClass=r.removeClass),r.children&&r.fn&&(r.fn.children=r.children),r.each&&r.fn&&(r.fn.each=r.each),r.find&&r.fn&&(r.fn.find=r.find),r.data&&r.fn&&(r.fn.data=r.data),r.hide&&r.fn&&(r.fn.hide=r.hide),r.show&&r.fn&&(r.fn.show=r.show),xa();var Ea,Sa,Ta,Na,Ma={};function za(){if(Sa)return Ea;Sa=1;var t=w();return Ea=!t(function(){return Object.isExtensible(Object.preventExtensions({}))})}function ka(){if(Na)return Ta;Na=1;var t=Qe();return Ta=function(e,r,n){for(var o in r)t(e,o,r[o],n);return e}}var Oa,Da,Aa,Ca,Ha,Ia,ja,Pa,Ra,Va,La,Ba,Wa,_a,Fa,qa,$a,Ga,Ua,Ya,Xa={exports:{}},Ka={};function Ja(){if(Da)return Oa;Da=1;var t=ht();return Oa=t([].slice)}function Qa(){if(Aa)return Ka;Aa=1;var t=pt(),e=bt(),r=Tr().f,n=Ja(),o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];return Ka.f=function(i){return o&&"Window"===t(i)?function(t){try{return r(t)}catch(t){return n(o)}}(i):r(e(i))},Ka}function Za(){if(ja)return Ia;ja=1;var t=w(),e=xt(),r=pt(),n=function(){if(Ha)return Ca;Ha=1;var t=w();return Ca=t(function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}})}(),o=Object.isExtensible,i=t(function(){});return Ia=i||n?function(t){return!!e(t)&&((!n||"ArrayBuffer"!==r(t))&&(!o||o(t)))}:o}function tu(){if(Pa)return Xa.exports;Pa=1;var t=on(),e=ht(),r=Xe(),n=xt(),o=le(),i=ze().f,a=Tr(),u=Qa(),c=Za(),l=fe(),f=za(),s=!1,d=l("meta"),v=0,h=function(t){i(t,d,{value:{objectID:"O"+v++,weakData:{}}})},p=Xa.exports={enable:function(){p.enable=function(){},s=!0;var r=a.f,n=e([].splice),o={};o[d]=1,r(o).length&&(a.f=function(t){for(var e=r(t),o=0,i=e.length;o<i;o++)if(e[o]===d){n(e,o,1);break}return e},t({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:u.f}))},fastKey:function(t,e){if(!n(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,d)){if(!c(t))return"F";if(!e)return"E";h(t)}return t[d].objectID},getWeakData:function(t,e){if(!o(t,d)){if(!c(t))return!0;if(!e)return!1;h(t)}return t[d].weakData},onFreeze:function(t){return f&&s&&c(t)&&!o(t,d)&&h(t),t}};return r[d]=!0,Xa.exports}function eu(){if(Va)return Ra;Va=1;var t=kn(),e=S(),r=Me(),n=Ot(),o=Uo(),i=wr(),a=St(),u=Xo(),c=Yo(),l=qo(),f=TypeError,s=function(t,e){this.stopped=t,this.result=e},d=s.prototype;return Ra=function(v,h,p){var g,y,m,b,w,x,E,S=p&&p.that,T=!(!p||!p.AS_ENTRIES),N=!(!p||!p.IS_RECORD),M=!(!p||!p.IS_ITERATOR),z=!(!p||!p.INTERRUPTED),k=t(h,S),O=function(t){return g&&l(g,"normal"),new s(!0,t)},D=function(t){return T?(r(t),z?k(t[0],t[1],O):k(t[0],t[1])):z?k(t,O):k(t)};if(N)g=v.iterator;else if(M)g=v;else{if(!(y=c(v)))throw new f(n(v)+" is not iterable");if(o(y)){for(m=0,b=i(v);b>m;m++)if((w=D(v[m]))&&a(d,w))return w;return new s(!1)}g=u(v,y)}for(x=N?v.next:g.next;!(E=e(x,g)).done;){try{w=D(E.value)}catch(t){l(g,"throw",t)}if("object"==typeof w&&w&&a(d,w))return w}return new s(!1)}}function ru(){if(Ba)return La;Ba=1;var t=St(),e=TypeError;return La=function(r,n){if(t(n,r))return r;throw new e("Incorrect invocation")}}function nu(){if(_a)return Wa;_a=1;var t=wt(),e=xt(),r=$i();return Wa=function(n,o,i){var a,u;return r&&t(a=o.constructor)&&a!==i&&e(u=a.prototype)&&u!==i.prototype&&r(n,u),n}}function ou(){if(qa)return Fa;qa=1;var t=on(),e=f(),r=ht(),n=nn(),o=Qe(),i=tu(),a=eu(),u=ru(),c=wt(),l=yt(),s=xt(),d=w(),v=Ko(),h=_i(),p=nu();return Fa=function(f,g,y){var m=-1!==f.indexOf("Map"),b=-1!==f.indexOf("Weak"),w=m?"set":"add",x=e[f],E=x&&x.prototype,S=x,T={},N=function(t){var e=r(E[t]);o(E,t,"add"===t?function(t){return e(this,0===t?0:t),this}:"delete"===t?function(t){return!(b&&!s(t))&&e(this,0===t?0:t)}:"get"===t?function(t){return b&&!s(t)?void 0:e(this,0===t?0:t)}:"has"===t?function(t){return!(b&&!s(t))&&e(this,0===t?0:t)}:function(t,r){return e(this,0===t?0:t,r),this})};if(n(f,!c(x)||!(b||E.forEach&&!d(function(){(new x).entries().next()}))))S=y.getConstructor(g,f,m,w),i.enable();else if(n(f,!0)){var M=new S,z=M[w](b?{}:-0,1)!==M,k=d(function(){M.has(1)}),O=v(function(t){new x(t)}),D=!b&&d(function(){for(var t=new x,e=5;e--;)t[w](e,e);return!t.has(-0)});O||((S=g(function(t,e){u(t,E);var r=p(new x,t,S);return l(e)||a(e,r[w],{that:r,AS_ENTRIES:m}),r})).prototype=E,E.constructor=S),(k||D)&&(N("delete"),N("has"),m&&N("get")),(D||z)&&N(w),b&&E.clear&&delete E.clear}return T[f]=S,t({global:!0,constructor:!0,forced:S!==x},T),h(S,f),b||y.setStrong(S,f,m),S}}function iu(){if(Ga)return $a;Ga=1;var t=ht(),e=ka(),r=tu().getWeakData,n=ru(),o=Me(),i=yt(),a=xt(),u=eu(),c=On(),l=le(),f=Ke(),s=f.set,d=f.getterFor,v=c.find,h=c.findIndex,p=t([].splice),g=0,y=function(t){return t.frozen||(t.frozen=new m)},m=function(){this.entries=[]},b=function(t,e){return v(t.entries,function(t){return t[0]===e})};return m.prototype={get:function(t){var e=b(this,t);if(e)return e[1]},has:function(t){return!!b(this,t)},set:function(t,e){var r=b(this,t);r?r[1]=e:this.entries.push([t,e])},delete:function(t){var e=h(this.entries,function(e){return e[0]===t});return~e&&p(this.entries,e,1),!!~e}},$a={getConstructor:function(t,c,f,v){var h=t(function(t,e){n(t,p),s(t,{type:c,id:g++,frozen:null}),i(e)||u(e,t[v],{that:t,AS_ENTRIES:f})}),p=h.prototype,m=d(c),b=function(t,e,n){var i=m(t),a=r(o(e),!0);return!0===a?y(i).set(e,n):a[i.id]=n,t};return e(p,{delete:function(t){var e=m(this);if(!a(t))return!1;var n=r(t);return!0===n?y(e).delete(t):n&&l(n,e.id)&&delete n[e.id]},has:function(t){var e=m(this);if(!a(t))return!1;var n=r(t);return!0===n?y(e).has(t):n&&l(n,e.id)}}),e(p,f?{get:function(t){var e=m(this);if(a(t)){var n=r(t);if(!0===n)return y(e).get(t);if(n)return n[e.id]}},set:function(t,e){return b(this,t,e)}}:{add:function(t){return b(this,t,!0)}}),h}}}Ya||(Ya=1,function(){if(Ua)return Ma;Ua=1;var t,e=za(),r=f(),n=ht(),o=ka(),i=tu(),a=ou(),u=iu(),c=xt(),l=Ke().enforce,s=w(),d=Ue(),v=Object,h=Array.isArray,p=v.isExtensible,g=v.isFrozen,y=v.isSealed,m=v.freeze,b=v.seal,x=!r.ActiveXObject&&"ActiveXObject"in r,E=function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},S=a("WeakMap",E,u),T=S.prototype,N=n(T.set);if(d)if(x){t=u.getConstructor(E,"WeakMap",!0),i.enable();var M=n(T.delete),z=n(T.has),k=n(T.get);o(T,{delete:function(e){if(c(e)&&!p(e)){var r=l(this);return r.frozen||(r.frozen=new t),M(this,e)||r.frozen.delete(e)}return M(this,e)},has:function(e){if(c(e)&&!p(e)){var r=l(this);return r.frozen||(r.frozen=new t),z(this,e)||r.frozen.has(e)}return z(this,e)},get:function(e){if(c(e)&&!p(e)){var r=l(this);return r.frozen||(r.frozen=new t),z(this,e)?k(this,e):r.frozen.get(e)}return k(this,e)},set:function(e,r){if(c(e)&&!p(e)){var n=l(this);n.frozen||(n.frozen=new t),z(this,e)?N(this,e,r):n.frozen.set(e,r)}else N(this,e,r);return this}})}else e&&s(function(){var t=m([]);return N(new S,t,1),!g(t)})&&o(T,{set:function(t,e){var r;return h(t)&&(g(t)?r=m:y(t)&&(r=b)),N(this,t,e),r&&r(t),this}})}());var au,uu={};!function(){if(au)return uu;au=1;var t=f(),e=ra(),r=na(),n=xa(),o=ke(),i=_i(),a=se()("iterator"),u=n.values,c=function(t,r){if(t){if(t[a]!==u)try{o(t,a,u)}catch(e){t[a]=u}if(i(t,r,!0),e[r])for(var c in n)if(t[c]!==n[c])try{o(t,c,n[c])}catch(e){t[c]=n[c]}}};for(var l in e)c(t[l]&&t[l].prototype,l);c(r,"DOMTokenList")}();var cu,lu,fu,su,du,vu,hu,pu,gu,yu,mu,bu=new WeakMap,wu=new WeakMap,xu=function(){function n(){this.title=t.t("tableModule.tableProperty"),this.iconSvg='<svg viewBox="0 0 20 20"><path d="M8 2v5h4V2h1v5h5v1h-5v4h.021l-.172.351-1.916.28-.151.027c-.287.063-.54.182-.755.341L8 13v5H7v-5H2v-1h5V8H2V7h5V2h1zm4 6H8v4h4V8z" opacity=".6"/><path d="m15.5 11.5 1.323 2.68 2.957.43-2.14 2.085.505 2.946L15.5 18.25l-2.645 1.39.505-2.945-2.14-2.086 2.957-.43L15.5 11.5zM17 1a2 2 0 0 1 2 2v9.475l-.85-.124-.857-1.736a2.048 2.048 0 0 0-.292-.44L17 3H3v14h7.808l.402.392L10.935 19H3a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h14z"/></svg>',this.tag="button",this.showModal=!0,this.modalWidth=300,this.menu="table",this.borderStyle=[{value:"none",label:t.t("tableModule.borderStyle.none")},{value:"solid",label:t.t("tableModule.borderStyle.solid")},{value:"dotted",label:t.t("tableModule.borderStyle.dotted")},{value:"dashed",label:t.t("tableModule.borderStyle.dashed")},{value:"double",label:t.t("tableModule.borderStyle.double")},{value:"groove",label:t.t("tableModule.borderStyle.groove")},{value:"ridge",label:t.t("tableModule.borderStyle.ridge")},{value:"inset",label:t.t("tableModule.borderStyle.inset")},{value:"outset",label:t.t("tableModule.borderStyle.outset")}],this.textAlignOptions=[{value:"left",label:t.t("justify.left"),svg:'<svg viewBox="0 0 1024 1024"><path d="M768 793.6v102.4H51.2v-102.4h716.8z m204.8-230.4v102.4H51.2v-102.4h921.6z m-204.8-230.4v102.4H51.2v-102.4h716.8zM972.8 102.4v102.4H51.2V102.4h921.6z"></path></svg>'},{value:"center",label:t.t("justify.center"),svg:'<svg viewBox="0 0 1024 1024"><path d="M870.4 793.6v102.4H153.6v-102.4h716.8z m102.4-230.4v102.4H51.2v-102.4h921.6z m-102.4-230.4v102.4H153.6v-102.4h716.8zM972.8 102.4v102.4H51.2V102.4h921.6z"></path></svg>'},{value:"right",label:t.t("justify.right"),svg:'<svg viewBox="0 0 1024 1024"><path d="M972.8 793.6v102.4H256v-102.4h716.8z m0-230.4v102.4H51.2v-102.4h921.6z m0-230.4v102.4H256v-102.4h716.8zM972.8 102.4v102.4H51.2V102.4h921.6z"></path></svg>'},{value:"justify",label:t.t("justify.justify"),svg:'<svg viewBox="0 0 1024 1024"><path d="M0 64h1024v128H0z m0 192h1024v128H0z m0 192h1024v128H0z m0 192h1024v128H0z m0 192h1024v128H0z"></path></svg>'}]}return n.prototype.getValue=function(t){return""},n.prototype.isActive=function(t){return!1},n.prototype.isDisabled=function(e){return null==t.DomEditor.getSelectedNodeByType(e,"table")},n.prototype.exec=function(t,e){},n.prototype.getModalContentNode=function(t){return Wn(e.Editor.nodes(t,{match:wo(t,"table")}),1)[0]},n.prototype.getModalPositionNode=function(t){return null},n.prototype.getModalContentElem=function(n){var o=this,i=this.getModalContentNode(n);if(!i)return null;var a=Wn(i,2),u=a[0],c=a[1],l=r('<div>\n      <label class="babel-container">\n        <span>'.concat(t.t("tableModule.modal.border"),'</span>\n        <span class="babel-container-border">\n          <select name="borderStyle">\n            ').concat(this.borderStyle.map(function(t){return'<option value="'.concat(t.value,'">').concat(t.label,"</option>")}).join(""),'\n          </select>\n          <span class="color-group" data-mark="color">\n            <span class="color-group-block"></span>\n            <input name="borderColor" type="hidden">\n          </span>\n          <input name="borderWidth" type="number" placeholder="').concat(t.t("tableModule.modal.borderWidth"),'">\n        </span>\n      </label>\n      <div class="babel-container">\n        <span>').concat(t.t("tableModule.modal.bgColor"),'</span>\n        <span class="babel-container-background">\n          <span class="color-group" data-mark="bgColor">\n            <span class="color-group-block"></span>\n            <input name="backgroundColor" type="hidden">\n          </span>\n        </span>\n      </div>\n      <label class="babel-container">\n        <span>').concat(t.t("tableModule.modal.align"),'</span>\n        <span class="babel-container-align">\n          <select name="textAlign">\n            ').concat(this.textAlignOptions.map(function(t){return'<option value="'.concat(t.value,'">').concat(t.label,"</option>")}).join(""),'\n          </select>\n        </span>\n      </label>\n      <div class="button-container">\n        <button type="button">').concat(t.t("tableModule.modal.ok"),"</button>\n      </div>\n    </div>"));l.find("[name]").each(function(t){r(t).val(u[r(t).attr("name")])});var f=function(t,e){e?r(".color-group-block",t).css("background-color",e).empty():r(".color-group-block",t).css("background-color","").html(Zn)};return l.find(".color-group").each(function(t){var e=r('[type="hidden"]',t).val()||"";f(t,e);var i=r(t);i.on("click",function(){l.find(".color-group .w-e-drop-panel").hide();var a=i.data("panel");a?a.show():(a=o.getPanelContentElem(n,{mark:i.data("mark"),selectedColor:e,callback:function(e){r('[type="hidden"]',t).val(e||""),f(t,e),a.hide()}}),i.append(a),i.data("panel",a))})}),l.find("button").on("click",function(){var t=Array.from(l.find("[name]")).reduce(function(t,e){return t[r(e).attr("name")]=r(e).val(),t},{}),i=bu.get(n);"cell"===o.menu&&(null==i?void 0:i.length)?i.forEach(function(r){r.forEach(function(r){e.Transforms.setNodes(n,t,{at:r[0][1]})})}):e.Transforms.setNodes(n,t,{at:c}),setTimeout(function(){n.focus()})}),l[0]},n.prototype.getPanelContentElem=function(e,n){var o=n.mark,i=n.selectedColor,a=n.callback,u=r('<ul class="w-e-panel-content-color"></ul>');u.on("click","li",function(t){var e=t.target;if(e){t.preventDefault(),t.stopPropagation();var n=r(e).attr("data-value");a(n)}});var c=e.getMenuConfig(o).colors;(void 0===c?[]:c).forEach(function(t){var e=r('<div class="color-block" data-value="'.concat(t,'"></div>'));e.css("background-color",t);var n=r('<li data-value="'.concat(t,'"></li>'));i===t&&n.addClass("active"),n.append(e),u.append(n)});var l="";"color"===o&&(l=t.t("tableModule.color.default")),"bgColor"===o&&(l=t.t("tableModule.color.clear"));var f=r('\n      <li data-value="" class="clear">\n        '.concat(Zn,"\n        ").concat(l,"\n      </li>\n    "));u.prepend(f);var s=r('<div class="w-e-drop-panel"></div>');return s.append(u),s},n}(),Eu=function(r){function n(){var e=r.apply(this,_n([],Wn(arguments),!1))||this;return e.title=t.t("tableModule.cellProperty"),e.iconSvg='<svg viewBox="0 0 20 20"><path d="m11.105 18-.17 1H2.5A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1h15A1.5 1.5 0 0 1 19 2.5v9.975l-.85-.124-.15-.302V8h-5v4h.021l-.172.351-1.916.28-.151.027c-.287.063-.54.182-.755.341L8 13v5h3.105zM2 12h5V8H2v4zm10-4H8v4h4V8zM2 2v5h5V2H2zm0 16h5v-5H2v5zM13 7h5V2h-5v5zM8 2v5h4V2H8z" opacity=".6"/><path d="m15.5 11.5 1.323 2.68 2.957.43-2.14 2.085.505 2.946L15.5 18.25l-2.645 1.39.505-2.945-2.14-2.086 2.957-.43L15.5 11.5zM13 6a1 1 0 0 1 1 1v3.172a2.047 2.047 0 0 0-.293.443l-.858 1.736-1.916.28-.151.027A1.976 1.976 0 0 0 9.315 14H7a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h6zm-1 2H8v4h4V8z"/></svg>',e.tag="button",e.showModal=!0,e.modalWidth=300,e.menu="cell",e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}Rn(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(n,r),n.prototype.getModalContentNode=function(t){return Wn(e.Editor.nodes(t,{match:wo(t,"td")}),1)[0]},n}(xu),Su={};function Tu(){if(lu)return cu;lu=1;var t=Ot(),e=TypeError;return cu=function(r,n){if(!delete r[n])throw new e("Cannot delete property "+t(n)+" of "+t(r))}}!function(){if(mu)return Su;mu=1;var t=on(),e=ht(),r=Dt(),n=ce(),o=wr(),i=Tu(),a=mo(),u=w(),c=function(){if(su)return fu;su=1;var t=Ja(),e=Math.floor,r=function(n,o){var i=n.length;if(i<8)for(var a,u,c=1;c<i;){for(u=c,a=n[c];u&&o(n[u-1],a)>0;)n[u]=n[--u];u!==c++&&(n[u]=a)}else for(var l=e(i/2),f=r(t(n,0,l),o),s=r(t(n,l),o),d=f.length,v=s.length,h=0,p=0;h<d||p<v;)n[h+p]=h<d&&p<v?o(f[h],s[p])<=0?f[h++]:s[p++]:h<d?f[h++]:s[p++];return n};return fu=r}(),l=bn(),f=function(){if(vu)return du;vu=1;var t=Tt().match(/firefox\/(\d+)/i);return du=!!t&&+t[1]}(),s=function(){if(pu)return hu;pu=1;var t=Tt();return hu=/MSIE|Trident/.test(t)}(),d=Nt(),v=function(){if(yu)return gu;yu=1;var t=Tt().match(/AppleWebKit\/(\d+)\./);return gu=!!t&&+t[1]}(),h=[],p=e(h.sort),g=e(h.push),y=u(function(){h.sort(void 0)}),m=u(function(){h.sort(null)}),b=l("sort"),x=!u(function(){if(d)return d<70;if(!(f&&f>3)){if(s)return!0;if(v)return v<603;var t,e,r,n,o="";for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:r=3;break;case 68:case 71:r=4;break;default:r=2}for(n=0;n<47;n++)h.push({k:e+n,v:r})}for(h.sort(function(t,e){return e.v-t.v}),n=0;n<h.length;n++)e=h[n].k.charAt(0),o.charAt(o.length-1)!==e&&(o+=e);return"DGBEFHACIJK"!==o}});t({target:"Array",proto:!0,forced:y||!m||!b||!x},{sort:function(t){void 0!==t&&r(t);var e=n(this);if(x)return void 0===t?p(e):p(e,t);var u,l,f=[],s=o(e);for(l=0;l<s;l++)l in e&&g(f,e[l]);for(c(f,function(t){return function(e,r){return void 0===r?-1:void 0===e?1:void 0!==t?+t(e,r)||0:a(e)>a(r)?1:-1}}(t)),u=o(f),l=0;l<u;)e[l]=f[l++];for(;l<s;)i(e,l++);return e}})}();var Nu,Mu,zu,ku={};!function(){if(zu)return ku;zu=1;var t=on(),e=ce(),r=mr(),n=yr(),o=wr(),i=function(){if(Mu)return Nu;Mu=1;var t=x(),e=an(),r=TypeError,n=Object.getOwnPropertyDescriptor,o=t&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}();return Nu=o?function(t,o){if(e(t)&&!n(t,"length").writable)throw new r("Cannot set read only .length");return t.length=o}:function(t,e){return t.length=e}}(),a=un(),u=vn(),c=cn(),l=Tu(),f=hn()("splice"),s=Math.max,d=Math.min;t({target:"Array",proto:!0,forced:!f},{splice:function(t,f){var v,h,p,g,y,m,b=e(this),w=o(b),x=r(t,w),E=arguments.length;for(0===E?v=h=0:1===E?(v=0,h=w-x):(v=E-2,h=d(s(n(f),0),w-x)),a(w+v-h),p=u(b,h),g=0;g<h;g++)(y=x+g)in b&&c(p,g,b[y]);if(p.length=h,v<h){for(g=x;g<w-h;g++)m=g+v,(y=g+h)in b?b[m]=b[y]:l(b,m);for(g=w;g>w-h+v;g--)l(b,g-1)}else if(v>h)for(g=w-h;g>x;g--)m=g+v-1,(y=g+h-1)in b?b[m]=b[y]:l(b,m);for(g=0;g<v;g++)b[g+x]=arguments[g+2];return i(b,w-h+v),p}})}();var Ou,Du,Au,Cu,Hu,Iu={};function ju(){if(Du)return Ou;Du=1;var t=f();return Ou=t}function Pu(){if(Cu)return Au;Cu=1;var t=ht();return Au=t(1.1.valueOf)}!function(){if(Hu)return Iu;Hu=1;var t=on(),e=oe(),r=x(),n=f(),o=ju(),i=ht(),a=nn(),u=le(),c=nu(),l=St(),s=kt(),d=de(),v=w(),h=Tr().f,p=ge().f,g=ze().f,y=Pu(),m=va().trim,b="Number",E=n[b],S=o[b],T=E.prototype,N=n.TypeError,M=i("".slice),z=i("".charCodeAt),k=function(t){var e,r,n,o,i,a,u,c,l=d(t,"number");if(s(l))throw new N("Cannot convert a Symbol value to a number");if("string"==typeof l&&l.length>2)if(l=m(l),43===(e=z(l,0))||45===e){if(88===(r=z(l,2))||120===r)return NaN}else if(48===e){switch(z(l,1)){case 66:case 98:n=2,o=49;break;case 79:case 111:n=8,o=55;break;default:return+l}for(a=(i=M(l,2)).length,u=0;u<a;u++)if((c=z(i,u))<48||c>o)return NaN;return parseInt(i,n)}return+l},O=a(b,!E(" 0o1")||!E("0b1")||E("+0x1")),D=function(t){var e,r=arguments.length<1?0:E(function(t){var e=d(t,"number");return"bigint"==typeof e?e:k(e)}(t));return l(T,e=this)&&v(function(){y(e)})?c(Object(r),this,D):r};D.prototype=T,O&&!e&&(T.constructor=D),t({global:!0,constructor:!0,wrap:!0,forced:O},{Number:D});var A=function(t,e){for(var n,o=r?h(e):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),i=0;o.length>i;i++)u(e,n=o[i])&&!u(t,n)&&g(t,n,p(e,n))};e&&S&&A(o[b],S),(O||e)&&A(o[b],E)}();var Ru,Vu,Lu,Bu,Wu,_u,Fu,qu;function $u(){if(Vu)return Ru;Vu=1;var t=Je(),e=ze();return Ru=function(r,n,o){return o.get&&t(o.get,n,{getter:!0}),o.set&&t(o.set,n,{setter:!0}),e.f(r,n,o)}}function Gu(){if(Bu)return Lu;Bu=1;var t=Et(),e=$u(),r=se(),n=x(),o=r("species");return Lu=function(r){var i=t(r);n&&i&&!i[o]&&e(i,o,{configurable:!0,get:function(){return this}})}}function Uu(){if(_u)return Wu;_u=1;var t=oo(),e=$u(),r=ka(),n=kn(),o=ru(),i=yt(),a=eu(),u=Gi(),c=Ui(),l=Gu(),f=x(),s=tu().fastKey,d=Ke(),v=d.set,h=d.getterFor;return Wu={getConstructor:function(u,c,l,d){var p=u(function(e,r){o(e,g),v(e,{type:c,index:t(null),first:null,last:null,size:0}),f||(e.size=0),i(r)||a(r,e[d],{that:e,AS_ENTRIES:l})}),g=p.prototype,y=h(c),m=function(t,e,r){var n,o,i=y(t),a=b(t,e);return a?a.value=r:(i.last=a={index:o=s(e,!0),key:e,value:r,previous:n=i.last,next:null,removed:!1},i.first||(i.first=a),n&&(n.next=a),f?i.size++:t.size++,"F"!==o&&(i.index[o]=a)),t},b=function(t,e){var r,n=y(t),o=s(e);if("F"!==o)return n.index[o];for(r=n.first;r;r=r.next)if(r.key===e)return r};return r(g,{clear:function(){for(var e=y(this),r=e.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=null),r=r.next;e.first=e.last=null,e.index=t(null),f?e.size=0:this.size=0},delete:function(t){var e=this,r=y(e),n=b(e,t);if(n){var o=n.next,i=n.previous;delete r.index[n.index],n.removed=!0,i&&(i.next=o),o&&(o.previous=i),r.first===n&&(r.first=o),r.last===n&&(r.last=i),f?r.size--:e.size--}return!!n},forEach:function(t){for(var e,r=y(this),o=n(t,arguments.length>1?arguments[1]:void 0);e=e?e.next:r.first;)for(o(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!b(this,t)}}),r(g,l?{get:function(t){var e=b(this,t);return e&&e.value},set:function(t,e){return m(this,0===t?0:t,e)}}:{add:function(t){return m(this,t=0===t?0:t,t)}}),f&&e(g,"size",{configurable:!0,get:function(){return y(this).size}}),p},setStrong:function(t,e,r){var n=e+" Iterator",o=h(e),i=h(n);u(t,e,function(t,e){v(this,{type:n,target:t,state:o(t),kind:e,last:null})},function(){for(var t=i(this),e=t.kind,r=t.last;r&&r.removed;)r=r.previous;return t.target&&(t.last=r=r?r.next:t.state.first)?c("keys"===e?r.key:"values"===e?r.value:[r.key,r.value],!1):(t.target=null,c(void 0,!0))},r?"entries":"values",!r,!0),l(e)}},Wu}qu||(qu=1,Fu||(Fu=1,ou()("Set",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},Uu())));var Yu=function(){function r(){this.title=t.t("tableModule.deleteCol"),this.iconSvg='<svg viewBox="0 0 1048 1024"><path d="M327.68 510.976L393.216 445.44v-13.1072L327.68 366.7968V510.976z m327.68-78.4384l65.536-65.536V507.904L655.36 442.368v-9.8304z m393.216 484.9664V0H0v917.504h1048.576z m-65.536-131.072h-262.144v-52.4288l-13.1072 13.1072-52.4288-52.4288v91.7504H393.216v-91.7504l-52.4288 52.4288-13.1072-13.1072v52.4288H65.536V65.536H327.68v121.2416l36.0448-36.0448 29.4912 29.4912V62.2592h262.144V180.224l49.152-49.152 16.384 16.384V62.2592h262.144V786.432z m-294.912-108.1344l-160.5632-160.5632-167.1168 167.1168-78.6432-78.6432 167.1168-167.1168L288.3584 278.528l78.6432-78.6432 160.5632 160.5632 163.84-163.84 78.6432 78.6432-163.84 163.84 160.5632 160.5632-78.6432 78.6432z"></path></svg>',this.tag="button"}return r.prototype.getValue=function(t){return""},r.prototype.isActive=function(t){return!1},r.prototype.isDisabled=function(r){var n=r.selection;return null==n||(!e.Range.isCollapsed(n)||null==t.DomEditor.getSelectedNodeByType(r,"table-cell"))},r.prototype.exec=function(r,n){if(!this.isDisabled(r)){var o=Wn(e.Editor.nodes(r,{match:function(e){return t.DomEditor.checkNodeType(e,"table-cell")},universal:!0}),1),i=Wn(o[0],2),a=i[0],u=i[1],c=t.DomEditor.getParentNode(r,a),l=(null==c?void 0:c.children.length)||0;if(!c||l<=1)e.Transforms.removeNodes(r,{mode:"highest"});else if(null!=t.DomEditor.getParentNode(r,c)){var f=Eo(r),s=0;t:for(var d=0;d<f.length;d+=1)for(var v=0;v<f[d].length;v+=1){var h=Wn(f[d][v],1),p=Wn(h[0],2)[1];if(e.Path.equals(u,p)){s=v;break t}}e.Editor.withoutNormalizing(r,function(){for(var n,o,i=new Set,a=new Set,u=0;u<f.length;u+=1)if(f[u]&&f[u][s]){var c=Wn(f[u][s],2),l=Wn(c[0],2)[1],d=c[1],v=d.rtl,h=d.ltr,p=d.ttb,g=d.btt,y=l.join(",");if(v>1||h>1||p>1||g>1){var m=u-(p-1),b=s-(v-1);if(m<0||m>=f.length||!f[m]||!f[m][b])continue;var w=Wn(f[m][b],1),x=Wn(w[0],2),E=x[0],S=x[1],T=S.join(",");if(!a.has(T)){a.add(T);var N=E.rowSpan,M=void 0===N?1:N,z=E.colSpan,k=void 0===z?1:z,O=Math.max(k-1,1);e.Transforms.setNodes(r,{rowSpan:M,colSpan:O},{at:S})}}else i.add(y)}var D=Array.from(i);D.sort(function(t,e){var r=t.split(",").map(Number),n=e.split(",").map(Number);return r[r.length-2]!==n[n.length-2]?n[n.length-2]-r[r.length-2]:n[n.length-1]-r[r.length-1]});try{for(var A=Bn(D),C=A.next();!C.done;C=A.next()){var H=C.value.split(",").map(Number);try{e.Editor.hasPath(r,H)&&e.Transforms.removeNodes(r,{at:H})}catch(t){console.warn("删除单元格失败:",H,t)}}}catch(t){n={error:t}}finally{try{C&&!C.done&&(o=A.return)&&o.call(A)}finally{if(n)throw n.error}}var I=Wn(e.Editor.nodes(r,{match:function(e){return t.DomEditor.checkNodeType(e,"table")},universal:!0}),1)[0];if(I){var j=Wn(I,2),P=j[0],R=j[1],V=P.columnWidths,L=_n([],Wn(void 0===V?[]:V),!1);L.splice(s,1),e.Transforms.setNodes(r,{columnWidths:L},{at:R})}})}}},r}(),Xu=function(){function r(){this.title=t.t("tableModule.deleteRow"),this.iconSvg='<svg viewBox="0 0 1048 1024"><path d="M907.6736 586.5472L747.1104 425.984l163.84-163.84-78.6432-78.6432-163.84 163.84L507.904 186.7776 429.2608 262.144l163.84 163.84-167.1168 167.1168 78.6432 78.6432 167.1168-167.1168 160.5632 160.5632 75.3664-78.6432zM0 917.504V0h1048.576v917.504H0z m983.04-327.68h-22.9376l-65.536-65.536H983.04V327.68h-91.7504l65.536-65.536h26.2144V65.536H65.536v196.608h317.8496l65.536 65.536H65.536v196.608h380.1088l-65.536 65.536H65.536v196.608H983.04v-196.608z"></path></svg>',this.tag="button"}return r.prototype.getValue=function(t){return""},r.prototype.isActive=function(t){return!1},r.prototype.isDisabled=function(r){var n=r.selection;return null==n||(!e.Range.isCollapsed(n)||null==t.DomEditor.getSelectedNodeByType(r,"table-row"))},r.prototype.exec=function(r,n){if(!this.isDisabled(r)){var o=Wn(e.Editor.nodes(r,{match:function(e){return t.DomEditor.checkNodeType(e,"table-row")},universal:!0}),1),i=Wn(o[0],2),a=i[0],u=i[1],c=t.DomEditor.getParentNode(r,a);if(((null==c?void 0:c.children.length)||0)<=1)e.Transforms.removeNodes(r,{mode:"highest"});else{var l=Wn(e.Editor.nodes(r,{match:function(e){return t.DomEditor.checkNodeType(e,"table-cell")},universal:!0}),1),f=Wn(l[0],2)[1],s=Eo(r),d=0;t:for(var v=0;v<s.length;v+=1)for(var h=0;h<s[v].length;h+=1){var p=Wn(s[v][h],1),g=Wn(p[0],2)[1];if(e.Path.equals(f,g)){d=v;break t}}e.Editor.withoutNormalizing(r,function(){for(var t,n,o=[],i=0;i<s[d].length;i+=1){var a=Wn(s[d][i],2),c=Wn(a[0],1)[0].hidden,l=a[1],f=l.ttb,v=l.btt,h=l.rtl;if(f>1||v>1){var p=d-(f-1);if(p<0||p>=s.length||!s[p]||!s[p][i])continue;var g=Wn(s[p][i],1),y=Wn(g[0],2),m=y[0],b=y[1],w=m,x=w.rowSpan,E=void 0===x?1:x,S=w.colSpan,T=void 0===S?1:S;if(c)e.Transforms.setNodes(r,{rowSpan:Math.max(E-1,1),colSpan:T},{at:b});else if(1===f&&1===h){if(d+1<s.length&&E>1){var N={type:"table-cell",rowSpan:E-1,colSpan:T,hidden:!1,children:w.children.map(function(t){return Vn({},t)})};w.isHeader&&(N.isHeader=w.isHeader),w.width&&(N.width=w.width),w.backgroundColor&&(N.backgroundColor=w.backgroundColor),w.borderWidth&&(N.borderWidth=w.borderWidth),w.borderStyle&&(N.borderStyle=w.borderStyle),w.borderColor&&(N.borderColor=w.borderColor),w.textAlign&&(N.textAlign=w.textAlign),o.push({cell:N,columnIndex:i})}else e.Transforms.setNodes(r,{rowSpan:Math.max(E-1,1),colSpan:T},{at:b})}else e.Transforms.setNodes(r,{rowSpan:Math.max(E-1,1),colSpan:T},{at:b})}}if(e.Transforms.removeNodes(r,{at:u}),o.length>0){var M=u;try{o.sort(function(t,e){return t.columnIndex-e.columnIndex});try{for(var z=Bn(o),k=z.next();!k.done;k=z.next()){var O=k.value,D=O.cell,A=O.columnIndex;try{var C=_n(_n([],Wn(M),!1),[A],!1);e.Transforms.insertNodes(r,D,{at:C})}catch(t){try{var H=Wn(e.Editor.node(r,M),1)[0].children.length,I=_n(_n([],Wn(M),!1),[H],!1);e.Transforms.insertNodes(r,D,{at:I})}catch(t){console.warn("插入新单元格失败:",t)}}}}catch(e){t={error:e}}finally{try{k&&!k.done&&(n=z.return)&&n.call(z)}finally{if(t)throw t.error}}}catch(t){console.warn("插入新单元格失败:",t)}}})}}},r}(),Ku=function(){function r(){this.title=t.t("tableModule.deleteTable"),this.iconSvg='<svg viewBox="0 0 1024 1024"><path d="M826.8032 356.5312c-19.328 0-36.3776 15.6928-36.3776 35.0464v524.2624c0 19.328-16 34.56-35.328 34.56H264.9344c-19.328 0-35.5072-15.3088-35.5072-34.56V390.0416c0-19.328-14.1568-35.0464-33.5104-35.0464s-33.5104 15.6928-33.5104 35.0464V915.712c0 57.9328 44.6208 108.288 102.528 108.288H755.2c57.9328 0 108.0832-50.4576 108.0832-108.288V391.4752c-0.1024-19.2512-17.1264-34.944-36.48-34.944z" p-id="9577"></path><path d="M437.1712 775.7568V390.6048c0-19.328-14.1568-35.0464-33.5104-35.0464s-33.5104 15.616-33.5104 35.0464v385.152c0 19.328 14.1568 35.0464 33.5104 35.0464s33.5104-15.7184 33.5104-35.0464zM649.7024 775.7568V390.6048c0-19.328-17.0496-35.0464-36.3776-35.0464s-36.3776 15.616-36.3776 35.0464v385.152c0 19.328 17.0496 35.0464 36.3776 35.0464s36.3776-15.7184 36.3776-35.0464zM965.0432 217.0368h-174.6176V145.5104c0-57.9328-47.2064-101.76-104.6528-101.76h-350.976c-57.8304 0-105.3952 43.8528-105.3952 101.76v71.5264H54.784c-19.4304 0-35.0464 14.1568-35.0464 33.5104 0 19.328 15.616 33.5104 35.0464 33.5104h910.3616c19.328 0 35.0464-14.1568 35.0464-33.5104 0-19.3536-15.6928-33.5104-35.1488-33.5104z m-247.3728 0H297.3952V145.5104c0-19.328 18.2016-34.7648 37.4272-34.7648h350.976c19.1488 0 31.872 15.1296 31.872 34.7648v71.5264z"></path></svg>',this.tag="button"}return r.prototype.getValue=function(t){return""},r.prototype.isActive=function(t){return!1},r.prototype.isDisabled=function(e){return null==e.selection||null==t.DomEditor.getSelectedNodeByType(e,"table")},r.prototype.exec=function(t,r){this.isDisabled(t)||e.Transforms.removeNodes(t,{mode:"highest"})},r}(),Ju=function(){function r(){this.title=t.t("tableModule.widthAuto"),this.iconSvg='<svg viewBox="0 0 1228 1024"><path d="M862.514337 563.200461H404.581995v121.753478a13.311987 13.311987 0 0 1-6.655993 11.468789 10.23999 10.23999 0 0 1-12.083188-1.433599l-204.799795-179.199821a13.721586 13.721586 0 0 1 0-20.479979l204.799795-179.302221a10.23999 10.23999 0 0 1 12.185588-1.535998 13.209587 13.209587 0 0 1 6.553593 11.673588v115.097485h457.932342V319.693504a11.571188 11.571188 0 0 1 18.841582-10.239989l204.799795 179.19982a13.721586 13.721586 0 0 1 0 20.47998l-204.799795 179.199821a10.23999 10.23999 0 0 1-12.185588 1.535998 13.311987 13.311987 0 0 1-6.655994-11.571188V563.200461zM136.499064 14.951409v993.893406a15.257585 15.257585 0 0 1-15.155185 15.052785H15.155185A15.155185 15.155185 0 0 1 0 1008.844815V14.951409a15.257585 15.257585 0 0 1 15.155185-15.052785h106.086294a15.155185 15.155185 0 0 1 15.257585 15.155185zM1228.798771 14.951409v993.893406a15.257585 15.257585 0 0 1-15.155185 15.052785h-106.188693a15.155185 15.155185 0 0 1-15.155185-15.052785V14.951409a15.257585 15.257585 0 0 1 15.155185-15.052785h106.086293A15.155185 15.155185 0 0 1 1228.798771 15.053809z"></path></svg>',this.tag="button"}return r.prototype.getValue=function(t){return!1},r.prototype.isActive=function(t){return!1},r.prototype.isDisabled=function(r){var n=r.selection;return null==n||(!e.Range.isCollapsed(n)||null==t.DomEditor.getSelectedNodeByType(r,"table"))},r.prototype.exec=function(r,n){if(!this.isDisabled(r)){var o=t.DomEditor.getSelectedNodeByType(r,"table");if(o){var i=o.columnWidths,a=void 0===i?[]:i,u=t.DomEditor.toDOMNode(r,o).querySelector(".table-container");if(u&&0!==a.length){var c=u.clientWidth,l=a.reduce(function(t,e){return t+e},0),f=a.map(function(t){var e=t/l;return Math.floor(e*c)}),s=r.getMenuConfig("insertTable").minWidth,d=parseInt(String(void 0===s?60:s),10)||60,v=f.map(function(t){return Math.max(d,t)}),h=v.reduce(function(t,e){return t+e},0);if(h>c){var p=c/h;m={width:"auto",columnWidths:g=v.map(function(t){return Math.max(d,Math.floor(t*p))})};e.Transforms.setNodes(r,m,{mode:"highest"})}else{var g=_n([],Wn(v),!1),y=c-h-1;y>0&&g.length>0&&(g[g.length-1]+=y);m={width:"auto",columnWidths:g};e.Transforms.setNodes(r,m,{mode:"highest"})}}else{var m={width:"auto"};e.Transforms.setNodes(r,m,{mode:"highest"})}}}},r}();function Qu(t){var e=t.children||[];return 0===e.length?[]:(e[0]||{}).children||[]}function Zu(t){return Qu(t).every(function(t){return!!t.isHeader})}var tc,ec,rc,nc,oc,ic=function(){function r(){this.title=t.t("tableModule.insertCol"),this.iconSvg='<svg viewBox="0 0 1048 1024"><path d="M327.68 193.3312v186.7776H140.9024v91.7504H327.68v186.7776h88.4736V471.8592h190.0544V380.1088H416.1536V193.3312zM0 917.504V0h1048.576v917.504H0zM655.36 65.536H65.536v720.896H655.36V65.536z m327.68 0h-262.144v196.608h262.144V65.536z m0 262.144h-262.144v196.608h262.144V327.68z m0 262.144h-262.144v196.608h262.144v-196.608z"></path></svg>',this.tag="button"}return r.prototype.getValue=function(t){return""},r.prototype.isActive=function(t){return!1},r.prototype.isDisabled=function(r){var n=r.selection;if(null==n)return!0;if(!e.Range.isCollapsed(n))return!0;var o=t.DomEditor.getSelectedNodeByType(r,"table");if(null==o)return!0;try{var i=Wn(e.Editor.nodes(r,{match:function(e){return t.DomEditor.checkNodeType(e,"table-cell")},universal:!0}),1)[0];if(!i)return!0;for(var a=Wn(i,2)[1],u=Eo(r),c=-1,l=0;l<u.length;l+=1){for(var f=0;f<u[l].length;f+=1){var s=Wn(u[l][f],1),d=Wn(s[0],2)[1];if(e.Path.equals(a,d)){c=f;break}}if(-1!==c)break}if(-1===c)return!0;var v=o.columnWidths,h=(void 0===v?[]:v)[c];if(h&&h<20)return!0}catch(t){return!0}return!1},r.prototype.exec=function(r,n){if(!this.isDisabled(r)){var o=Wn(e.Editor.nodes(r,{match:function(e){return t.DomEditor.checkNodeType(e,"table-cell")},universal:!0}),1),i=Wn(o[0],2),a=i[0],u=i[1],c=t.DomEditor.getParentNode(r,a);if(null!=c){var l=t.DomEditor.getParentNode(r,c);if(null!=l){for(var f=Eo(r),s=0,d=0;d<f.length;d+=1)for(var v=0;v<f[d].length;v+=1){var h=Wn(f[d][v],1),p=Wn(h[0],2)[1];if(e.Path.equals(u,p)){s=v;break}}e.Editor.withoutNormalizing(r,function(){for(var n=new Set,o=new Set,i=0;i<f.length;i+=1)if(f[i]&&f[i][s]){var a=Wn(f[i][s],2);Wn(a[0],1);var u=a[1],c=u.rtl,d=u.ltr,v=u.ttb,h=u.btt;if(c>1||d>1||v>1||h>1){var p=i-(v-1),g=s-(c-1);if(p<0||p>=f.length||!f[p]||!f[p][g])continue;var y=Wn(f[p][g],1),m=Wn(y[0],2),b=m[0],w=m[1],x=w.join(",");if(n.has(x))o.add(i);else{n.add(x);var E=b.rowSpan,S=void 0===E?1:E,T=b.colSpan,N=(void 0===T?1:T)+1;b.hidden||e.Transforms.setNodes(r,{colSpan:N},{at:w});for(var M=0;M<S;M+=1)o.add(p+M)}}}for(i=0;i<f.length;i+=1)if(!o.has(i)&&f[i]&&f[i][s]){var z={type:"table-cell",children:[{text:""}]};0===i&&Zu(l)&&(z.isHeader=!0);var k=Wn(f[i][s],1),O=Wn(k[0],2)[1];e.Transforms.insertNodes(r,z,{at:O})}var D=Wn(e.Editor.nodes(r,{match:function(e){return t.DomEditor.checkNodeType(e,"table")},universal:!0}),1)[0];if(D){var A=Wn(D,2),C=A[0],H=A[1],I=C.columnWidths,j=void 0===I?[]:I,P=_n([],Wn(j),!1),R=r.getMenuConfig("insertTable").minWidth,V=void 0===R?60:R,L=j[s]||parseInt(V,10)||60,B=Math.floor(L/2),W=L-B;P.splice(s,0,B),P[s+1]=W,e.Transforms.setNodes(r,{columnWidths:P},{at:H})}})}}}},r}(),ac={};function uc(){if(nc)return rc;nc=1;var t=S(),e=le(),r=St(),n=function(){if(ec)return tc;ec=1;var t=f(),e=w(),r=t.RegExp,n=!e(function(){var t=!0;try{r(".","d")}catch(e){t=!1}var e={},n="",o=t?"dgimsy":"gimsy",i=function(t,r){Object.defineProperty(e,t,{get:function(){return n+=r,!0}})},a={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var u in t&&(a.hasIndices="d"),a)i(u,a[u]);return Object.getOwnPropertyDescriptor(r.prototype,"flags").get.call(e)!==o||n!==o});return tc={correct:n}}(),o=li(),i=RegExp.prototype;return rc=n.correct?function(t){return t.flags}:function(a){return n.correct||!r(i,a)||e(a,"flags")?a.flags:t(o,a)}}!function(){if(oc)return ac;oc=1;var t=$e().PROPER,e=Qe(),r=Me(),n=mo(),o=w(),i=uc(),a="toString",u=RegExp.prototype,c=u[a],l=o(function(){return"/a/b"!==c.call({source:"a",flags:"b"})}),f=t&&c.name!==a;(l||f)&&e(u,a,function(){var t=r(this);return"/"+n(t.source)+"/"+n(i(t))},{unsafe:!0})}();var cc,lc,fc,sc=function(){function r(){this.title=t.t("tableModule.insertRow"),this.iconSvg='<svg viewBox="0 0 1048 1024"><path d="M707.7888 521.0112h-147.456v-147.456H488.2432v147.456h-147.456v68.8128h147.456v147.456h72.0896v-147.456h147.456zM0 917.504V0h1048.576v917.504H0zM327.68 65.536H65.536v196.608H327.68V65.536z m327.68 0H393.216v196.608h262.144V65.536z m327.68 0h-262.144v196.608h262.144V65.536z m0 258.8672H65.536v462.0288H983.04V324.4032z"></path></svg>',this.tag="button"}return r.prototype.getValue=function(t){return""},r.prototype.isActive=function(t){return!1},r.prototype.isDisabled=function(r){var n=r.selection;return null==n||(!e.Range.isCollapsed(n)||null==t.DomEditor.getSelectedNodeByType(r,"table"))},r.prototype.exec=function(r,n){var o;if(!this.isDisabled(r)){var i=Wn(e.Editor.nodes(r,{match:function(e){return t.DomEditor.checkNodeType(e,"table-cell")},universal:!0}),1),a=Wn(i[0],2)[1],u=Eo(r),c=0;t:for(var l=0;l<u.length;l+=1)for(var f=0;f<u[l].length;f+=1){var s=Wn(u[l][f],1),d=Wn(s[0],2)[1];if(e.Path.equals(a,d)){c=l;break t}}var v=(null===(o=u[c])||void 0===o?void 0:o.length)||0;0!==v&&e.Editor.withoutNormalizing(r,function(){for(var t=c+1,n=t>=0&&t<u.length,o=[],i=0;n&&i<u[c].length;i+=1){var l=Wn(u[c][i],2)[1],f=l.ttb,s=l.btt;if(f>1||s>1){var d=c-(f-1);if(d<0||d>=u.length||!u[d]||!u[d][i])continue;var h=Wn(u[d][i],1),p=Wn(h[0],2),g=p[0],y=p[1],m=g.rowSpan||1;o.push(i),g.hidden||e.Transforms.setNodes(r,{rowSpan:m+1},{at:y})}}for(var b=(r.getMenuConfig("insertTable")||{}).minRowHeight,w={type:"table-row",children:[],height:parseInt((void 0===b?30:b).toString(),10)||30},x=0;x<v;x+=1)if(!o.includes(x)){w.children.push({type:"table-cell",children:[{text:""}]})}var E=e.Path.parent(a),S=e.Path.next(E);e.Transforms.insertNodes(r,w,{at:S})})}},r}(),dc={};!function(){if(fc)return dc;fc=1;var t=on(),e=function(){if(lc)return cc;lc=1;var t=ce(),e=mr(),r=wr();return cc=function(n){for(var o=t(this),i=r(o),a=arguments.length,u=e(a>1?arguments[1]:void 0,i),c=a>2?arguments[2]:void 0,l=void 0===c?i:e(c,i);l>u;)o[u++]=n;return o},cc}(),r=io();t({target:"Array",proto:!0},{fill:e}),r("fill")}();var vc,hc,pc=function(){function n(){this.title=t.t("tableModule.insertTable"),this.iconSvg='<svg viewBox="0 0 1024 1024"><path d="M0 64v896h1024V64H0z m384 576v-192h256v192h-256z m256 64v192h-256v-192h256z m0-512v192h-256V192h256zM320 192v192H64V192h256z m-256 256h256v192H64v-192z m640 0h256v192h-256v-192z m0-64V192h256v192h-256zM64 704h256v192H64v-192z m640 192v-192h256v192h-256z"></path></svg>',this.tag="button",this.showDropPanel=!0,this.$content=null}return n.prototype.getValue=function(t){return""},n.prototype.isActive=function(t){return!1},n.prototype.exec=function(t,e){},n.prototype.isDisabled=function(r){var n=r.selection;return null==n||(!e.Range.isCollapsed(n)||!!t.DomEditor.getSelectedElems(r).some(function(e){var n=t.DomEditor.getNodeType(e);return"pre"===n||("table"===n||("list-item"===n||!!r.isVoid(e)))}))},n.prototype.getPanelContentElem=function(t){var e=this;if(this.$content)return this.$content[0];for(var n=r('<div class="w-e-panel-content-table"></div>'),o=r("<span>0 &times; 0</span>"),i=r("<table></table>"),a=0;a<10;a+=1){for(var u=r("<tr></tr>"),c=0;c<10;c+=1){var l=r("<td></td>");l.attr("data-x",c.toString()),l.attr("data-y",a.toString()),u.append(l),l.on("mouseenter",function(t){var e=t.target;if(null!=e){var n=r(e).dataset(),a=n.x,u=n.y;o[0].innerHTML="".concat(a+1," &times; ").concat(u+1),i.children().each(function(t){r(t).children().each(function(t){var e=r(t),n=e.dataset(),o=n.x,i=n.y;o<=a&&i<=u?e.addClass("active"):e.removeClass("active")})})}}),l.on("click",function(n){n.preventDefault();var o=n.target;if(null!=o){var i=r(o).dataset(),a=i.x,u=i.y;e.insertTable(t,u+1,a+1)}})}i.append(u)}return n.append(i),n.append(o),this.$content=n,n[0]},n.prototype.insertTable=function(r,n,o){var i=parseInt(n,10),a=parseInt(o,10);if(i&&a&&!(i<=0||a<=0)){if(t.DomEditor.isSelectedEmptyParagraph(r)&&e.Transforms.removeNodes(r,{mode:"highest"}),0===r.children.length){e.Transforms.insertNodes(r,{type:"paragraph",children:[{text:""}]},{mode:"highest"})}var u=function(t,e,r){for(var n,o=[],i=t.getMenuConfig("insertTable"),a=i.minWidth,u=void 0===a?60:a,c=i.minRowHeight,l=void 0===c?30:c,f=i.tableFullWidth,s=i.tableHeader,d=Array(r).fill(parseInt(u,10)||60),v=0;v<e;v+=1){for(var h=[],p=0;p<r;p+=1){var g={type:"table-cell",children:[{text:""}]};0===v&&(g.isHeader=null===(n=null==s?void 0:s.selected)||void 0===n||n),h.push(g)}o.push({type:"table-row",children:h,height:parseInt(l,10)||30})}return{type:"table",width:(null==f?void 0:f.selected)?"100%":"auto",children:o,columnWidths:d}}(r,i,a);e.Transforms.insertNodes(r,u,{mode:"highest"})}},n}();hc||(hc=1,vc||(vc=1,ou()("Map",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},Uu())));var gc,yc={isInTable:function(t,r){return void 0===r&&(r={}),!!Wn(e.Editor.nodes(t,{match:wo(t,"table"),at:r.at}),1)[0]},selection:function(t){var e,r,n,o,i,a,u,c;return Ln(this,function(l){switch(l.label){case 0:e=bu.get(t),r=0,l.label=1;case 1:if(!(e&&r<e.length))return[3,4];for(n=[],o=0;o<e[r].length;o+=1)i=Wn(e[r][o],2),a=i[0],u=i[1],c=u.ltr,1===u.ttb&&n.push(a),o+=c-1;return[4,n];case 2:l.sent(),l.label=3;case 3:return r+=1,[3,1];case 4:return[2]}})},unselect:function(t){wu.delete(t),bu.delete(t)},isSelected:function(t,e){var r=wu.get(t);return!!r&&r.has(e)}},mc=function(){function r(){this.title=t.t("tableModule.mergeCell"),this.iconSvg='<svg viewBox="0 0 1024 1024"><path d="M482.2 508.4 331.3 389c-3-2.4-7.3-.2-7.3 3.6V478H184V184h204v128c0 2.2 1.8 4 4 4h60c2.2 0 4-1.8 4-4V144c0-15.5-12.5-28-28-28H144c-15.5 0-28 12.5-28 28v736c0 15.5 12.5 28 28 28h284c15.5 0 28-12.5 28-28V712c0-2.2-1.8-4-4-4h-60c-2.2 0-4 1.8-4 4v128H184V546h140v85.4c0 3.8 4.4 6 7.3 3.6l150.9-119.4c2.4-1.8 2.4-5.4 0-7.2zM880 116H596c-15.5 0-28 12.5-28 28v168c0 2.2 1.8 4 4 4h60c2.2 0 4-1.8 4-4V184h204v294H700v-85.4c0-3.8-4.3-6-7.3-3.6l-151 119.4c-2.3 1.8-2.3 5.3 0 7.1l151 119.5c2.9 2.3 7.3.2 7.3-3.6V546h140v294H636V712c0-2.2-1.8-4-4-4h-60c-2.2 0-4 1.8-4 4v168c0 15.5 12.5 28 28 28h284c15.5 0 28-12.5 28-28V144c0-15.5-12.5-28-28-28z"/></svg>',this.tag="button"}return r.prototype.getValue=function(t){return""},r.prototype.isActive=function(t){return!1},r.prototype.isDisabled=function(t){return!this.canMerge(t)},r.prototype.exec=function(t,e){this.isDisabled(t)||(this.merge(t),yc.unselect(t))},r.prototype.canMerge=function(t){var e=bu.get(t);if(!e||!e.length)return!1;var r=Wn(e[e.length-1][e[e.length-1].length-1],1),n=Wn(r[0],2)[1],o=Wn(e[0][0],1);return!!xo(t,[Wn(o[0],2)[1],n],"table")},r.prototype.merge=function(t){if(this.canMerge(t)){var r=bu.get(t);if(r&&r.length){var n=Wn(r[0][0],1),o=Wn(n[0],2)[1],i=Wn(e.Node.children(t,o,{reverse:!0}),1),a=Wn(i[0],2)[1];e.Editor.withoutNormalizing(t,function(){for(var n,i,u,c,l,f,s=new Map,d=[],v=1/0,h=-1/0,p=1/0,g=-1/0,y=0;y<r.length;y+=1)for(var m=0;m<r[y].length;m+=1){var b=Wn(r[y][m],2),w=Wn(b[0],2),x=w[0],E=w[1],S=b[1].ttb,T=E.join(",");if(1===S&&!s.has(T)){s.set(T,{path:E,x:y,y:m,element:x});var N=x.rowSpan,M=void 0===N?1:N,z=x.colSpan,k=y,O=y+M-1,D=m,A=m+(void 0===z?1:z)-1;v=Math.min(v,k),h=Math.max(h,O),p=Math.min(p,D),g=Math.max(g,A)}}var C=h-v+1,H=g-p+1;try{for(var I=Bn(s),j=I.next();!j.done;j=I.next()){E=Wn(j.value,2)[1].path;e.Path.equals(o,E)||d.push(E)}}catch(t){n={error:t}}finally{try{j&&!j.done&&(i=I.return)&&i.call(I)}finally{if(n)throw n.error}}d.sort(function(t,e){for(var r=0;r<Math.min(t.length,e.length);r+=1)if(t[r]!==e[r])return e[r]-t[r];return e.length-t.length});try{for(var P=Bn(d),R=P.next();!R.done;R=P.next()){E=R.value;try{if(!e.Editor.hasPath(t,E))continue;try{for(var V=(l=void 0,Bn(e.Node.children(t,E,{reverse:!0}))),L=V.next();!L.done;L=V.next()){var B=Wn(L.value,2)[1];e.Transforms.moveNodes(t,{to:e.Path.next(a),at:B})}}catch(t){l={error:t}}finally{try{L&&!L.done&&(f=V.return)&&f.call(V)}finally{if(l)throw l.error}}e.Transforms.removeNodes(t,{at:E})}catch(t){}}}catch(t){u={error:t}}finally{try{R&&!R.done&&(c=P.return)&&c.call(P)}finally{if(u)throw u.error}}e.Transforms.setNodes(t,{rowSpan:C,colSpan:H},{at:o})})}}},r}(),bc={};!function(){if(gc)return bc;gc=1;var t=on(),e=an(),r=sn(),n=xt(),o=mr(),i=wr(),a=bt(),u=cn(),c=se(),l=hn(),f=Ja(),s=l("slice"),d=c("species"),v=Array,h=Math.max;t({target:"Array",proto:!0,forced:!s},{slice:function(t,c){var l,s,p,g=a(this),y=i(g),m=o(t,y),b=o(void 0===c?y:c,y);if(e(g)&&(l=g.constructor,(r(l)&&(l===v||e(l.prototype))||n(l)&&null===(l=l[d]))&&(l=void 0),l===v||void 0===l))return f(g,m,b);for(s=new(void 0===l?v:l)(h(b-m,0)),p=0;m<b;m++,p++)m in g&&u(s,p,g[m]);return s.length=p,s}})}();var wc,xc,Ec,Sc,Tc,Nc,Mc,zc,kc,Oc,Dc,Ac={};function Cc(){if(xc)return wc;xc=1,di();var t=S(),e=Qe(),r=si(),n=w(),o=se(),i=ke(),a=o("species"),u=RegExp.prototype;return wc=function(c,l,f,s){var d=o(c),v=!n(function(){var t={};return t[d]=function(){return 7},7!==""[c](t)}),h=v&&!n(function(){var t=!1,e=/a/;return"split"===c&&((e={}).constructor={},e.constructor[a]=function(){return e},e.flags="",e[d]=/./[d]),e.exec=function(){return t=!0,null},e[d](""),!t});if(!v||!h||f){var p=/./[d],g=l(d,""[c],function(e,n,o,i,a){var c=n.exec;return c===r||c===u.exec?v&&!a?{done:!0,value:t(p,n,o,i)}:{done:!0,value:t(e,o,n,i)}:{done:!1}});e(String.prototype,c,g[0]),e(u,d,g[1])}s&&i(u[d],"sham",!0)}}function Hc(){if(Sc)return Ec;Sc=1;var t=sn(),e=Ot(),r=TypeError;return Ec=function(n){if(t(n))return n;throw new r(e(n)+" is not a constructor")}}function Ic(){if(Nc)return Tc;Nc=1;var t=Me(),e=Hc(),r=yt(),n=se()("species");return Tc=function(o,i){var a,u=t(o).constructor;return void 0===u||r(a=t(u)[n])?i:e(a)}}function jc(){if(zc)return Mc;zc=1;var t=Li().charAt;return Mc=function(e,r,n){return r+(n?t(e,r).length:1)}}function Pc(){if(Oc)return kc;Oc=1;var t=S(),e=Me(),r=wt(),n=pt(),o=si(),i=TypeError;return kc=function(a,u){var c=a.exec;if(r(c)){var l=t(c,a,u);return null!==l&&e(l),l}if("RegExp"===n(a))return t(o,a,u);throw new i("RegExp#exec called on incompatible receiver")}}!function(){if(Dc)return Ac;Dc=1;var t=S(),e=ht(),r=Cc(),n=Me(),o=xt(),i=mt(),a=Ic(),u=jc(),c=br(),l=mo(),f=At(),s=Pc(),d=fi(),v=w(),h=d.UNSUPPORTED_Y,p=Math.min,g=e([].push),y=e("".slice),m=!v(function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var r="ab".split(t);return 2!==r.length||"a"!==r[0]||"b"!==r[1]}),b="c"==="abbc".split(/(b)*/)[1]||4!=="test".split(/(?:)/,-1).length||2!=="ab".split(/(?:ab)*/).length||4!==".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length;r("split",function(e,r,d){var v="0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:t(r,this,e,n)}:r;return[function(r,n){var a=i(this),u=o(r)?f(r,e):void 0;return u?t(u,r,a,n):t(v,l(a),r,n)},function(t,e){var o=n(this),i=l(t);if(!b){var f=d(v,o,i,e,v!==r);if(f.done)return f.value}var m=a(o,RegExp),w=o.unicode,x=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(h?"g":"y"),E=new m(h?"^(?:"+o.source+")":o,x),S=void 0===e?4294967295:e>>>0;if(0===S)return[];if(0===i.length)return null===s(E,i)?[i]:[];for(var T=0,N=0,M=[];N<i.length;){E.lastIndex=h?0:N;var z,k=s(E,h?y(i,N):i);if(null===k||(z=p(c(E.lastIndex+(h?N:0)),i.length))===T)N=u(i,N,w);else{if(g(M,y(i,T,N)),M.length===S)return M;for(var O=1;O<=k.length-1;O++)if(g(M,k[O]),M.length===S)return M;N=T=z}}return g(M,y(i,T)),M}]},b||!m,h)}();var Rc,Vc=function(){function r(){this.title=t.t("tableModule.splitCell"),this.iconSvg='<svg viewBox="0 0 1024 1024"><path d="M362.667 494.933v53.334l25.6-25.6zm0-241.066L460.8 352V78.933H57.6v98.134h305.067zm0 535.466v57.6H57.6v98.134h403.2V691.2zM661.333 494.933v53.334l-25.6-25.6zm0-241.066L563.2 352V78.933h403.2v98.134H661.333zm0 535.466v57.6H966.4v98.134H563.2V691.2z"/><path d="M753.067 341.333 693.333 281.6 512 460.8 330.667 281.6l-59.734 59.733 181.334 181.334L270.933 704l59.734 59.733L512 582.4l181.333 181.333L753.067 704 571.733 522.667z"/></svg>',this.tag="button"}return r.prototype.getValue=function(t){return""},r.prototype.isActive=function(t){return!1},r.prototype.isDisabled=function(r){var n=Wn(e.Editor.nodes(r,{match:function(e){return t.DomEditor.checkNodeType(e,"table-cell")}}),1)[0];if(!n)return!0;var o=Wn(n,1)[0],i=o.rowSpan,a=void 0===i?1:i,u=o.colSpan;return!(a>1||(void 0===u?1:u)>1)},r.prototype.exec=function(t,e){this.isDisabled(t)||this.split(t)},r.prototype.split=function(t,r){void 0===r&&(r={});var n=Wn(e.Editor.nodes(t,{match:wo(t,"table","th","td"),at:r.at}),2),o=n[0],i=n[1];if(o&&i){var a=Zu(Wn(o,1)[0]),u=Wn(i,2),c=u[0],l=u[1],f=c.rowSpan,s=void 0===f?1:f,d=c.colSpan,v=void 0===d?1:d;1===s&&1===v||e.Editor.withoutNormalizing(t,function(){e.Transforms.setNodes(t,{rowSpan:1,colSpan:1},{at:l});for(var r=1;r<v;r+=1){var n={type:"table-cell",children:[{text:""}]};0===l[l.length-2]&&a&&(n.isHeader=!0);var o=l.slice(0,-1),i=l[l.length-1]+r,u=_n(_n([],Wn(o),!1),[i],!1);try{e.Transforms.insertNodes(t,n,{at:u})}catch(r){try{var c=Wn(e.Editor.node(t,o),1)[0].children.length,f=_n(_n([],Wn(o),!1),[c],!1);e.Transforms.insertNodes(t,n,{at:f})}catch(t){console.warn("插入同行单元格失败: ".concat(t instanceof Error?t.message:String(t)))}}}for(var d=1;d<s;d+=1){var h=l[l.length-2]+d,p=_n(_n([],Wn(l.slice(0,-2)),!1),[h],!1);try{var g=Wn(e.Editor.node(t,p),1)[0];if(!g){console.warn("目标行 ".concat(h," 不存在"));continue}for(r=0;r<v;r+=1){n={type:"table-cell",children:[{text:""}]},i=l[l.length-1]+r,u=_n(_n([],Wn(p),!1),[i],!1);try{var y=g.children.length;if(i>=y){var m=_n(_n([],Wn(p),!1),[y],!1);e.Transforms.insertNodes(t,n,{at:m})}else e.Transforms.insertNodes(t,n,{at:u})}catch(r){try{var b=g.children.length;f=_n(_n([],Wn(p),!1),[b],!1);e.Transforms.insertNodes(t,n,{at:f})}catch(t){console.warn("插入单元格到第".concat(d,"行失败: ").concat(t instanceof Error?t.message:String(t)))}}}}catch(t){console.warn("处理第".concat(d,"行时出错: ").concat(t instanceof Error?t.message:String(t)))}}})}},r}(),Lc=function(){function r(){this.title=t.t("tableModule.header"),this.iconSvg='<svg viewBox="0 0 1024 1024"><path d="M704 128l-64 0L384 128 320 128 0 128l0 256 0 64 0 192 0 64 0 256 320 0 64 0 256 0 64 0 320 0 0-256 0-64L1024 448 1024 384 1024 128 704 128zM640 640 384 640 384 448l256 0L640 640zM64 448l256 0 0 192L64 640 64 448zM320 896 64 896l0-192 256 0L320 896zM640 896 384 896l0-192 256 0L640 896zM960 896l-256 0 0-192 256 0L960 896zM960 640l-256 0L704 448l256 0L960 640z"></path></svg>',this.tag="button"}return r.prototype.getValue=function(e){var r=t.DomEditor.getSelectedNodeByType(e,"table");return null!=r&&Zu(r)},r.prototype.isActive=function(t){return!!this.getValue(t)},r.prototype.isDisabled=function(r){var n=r.selection;return null==n||(!e.Range.isCollapsed(n)||null==t.DomEditor.getSelectedNodeByType(r,"table"))},r.prototype.exec=function(r,n){if(!this.isDisabled(r)){var o=!n,i=t.DomEditor.getSelectedNodeByType(r,"table");if(null!=i)Qu(i).forEach(function(n){return e.Transforms.setNodes(r,{isHeader:o},{at:t.DomEditor.findPath(r,n)})})}},r}(),Bc={key:"insertTable",factory:function(){return new pc}},Wc={key:"deleteTable",factory:function(){return new Ku}},_c={key:"insertTableRow",factory:function(){return new sc}},Fc={key:"deleteTableRow",factory:function(){return new Xu}},qc={key:"insertTableCol",factory:function(){return new ic}},$c={key:"deleteTableCol",factory:function(){return new Yu}},Gc={key:"tableHeader",factory:function(){return new Lc}},Uc={key:"tableFullWidth",factory:function(){return new Ju}},Yc={key:"mergeTableCell",factory:function(){return new mc}},Xc={key:"splitTableCell",factory:function(){return new Vc}},Kc={key:"setTableProperty",factory:function(){return new xu}},Jc={key:"setTableCellProperty",factory:function(){return new Eu}},Qc={};!function(){if(Rc)return Qc;Rc=1;var t=on(),e=On().filter;t({target:"Array",proto:!0,forced:!hn()("filter")},{filter:function(t){return e(this,t,arguments.length>1?arguments[1]:void 0)}})}();var Zc,tl,el,rl,nl,ol={};function il(){if(rl)return el;rl=1;var t=ht(),e=ce(),r=Math.floor,n=t("".charAt),o=t("".replace),i=t("".slice),a=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,u=/\$([$&'`]|\d{1,2})/g;return el=function(t,c,l,f,s,d){var v=l+t.length,h=f.length,p=u;return void 0!==s&&(s=e(s),p=a),o(d,p,function(e,o){var a;switch(n(o,0)){case"$":return"$";case"&":return t;case"`":return i(c,0,l);case"'":return i(c,v);case"<":a=s[i(o,1,-1)];break;default:var u=+o;if(0===u)return e;if(u>h){var d=r(u/10);return 0===d?e:d<=h?void 0===f[d-1]?n(o,1):f[d-1]+n(o,1):e}a=f[u-1]}return void 0===a?"":a})}}!function(){if(nl)return ol;nl=1;var t=function(){if(tl)return Zc;tl=1;var t=E(),e=Function.prototype,r=e.apply,n=e.call;return Zc="object"==typeof Reflect&&Reflect.apply||(t?n.bind(r):function(){return n.apply(r,arguments)}),Zc}(),e=S(),r=ht(),n=Cc(),o=w(),i=Me(),a=wt(),u=xt(),c=yr(),l=br(),f=mo(),s=mt(),d=jc(),v=At(),h=il(),p=uc(),g=Pc(),y=se()("replace"),m=Math.max,b=Math.min,x=r([].concat),T=r([].push),N=r("".indexOf),M=r("".slice),z=function(t){return void 0===t?t:String(t)},k="$0"==="a".replace(/./,"$0"),O=!!/./[y]&&""===/./[y]("a","$0");n("replace",function(r,n,o){var w=O?"$":"$0";return[function(t,r){var o=s(this),i=u(t)?v(t,y):void 0;return i?e(i,t,o,r):e(n,f(o),t,r)},function(e,r){var u=i(this),s=f(e);if("string"==typeof r&&-1===N(r,w)&&-1===N(r,"$<")){var v=o(n,u,s,r);if(v.done)return v.value}var y=a(r);y||(r=f(r));var E,S=f(p(u)),k=-1!==N(S,"g");k&&(E=-1!==N(S,"u"),u.lastIndex=0);for(var O,D=[];null!==(O=g(u,s))&&(T(D,O),k);){""===f(O[0])&&(u.lastIndex=d(s,l(u.lastIndex),E))}for(var A="",C=0,H=0;H<D.length;H++){for(var I,j=f((O=D[H])[0]),P=m(b(c(O.index),s.length),0),R=[],V=1;V<O.length;V++)T(R,z(O[V]));var L=O.groups;if(y){var B=x([j],R,P,s);void 0!==L&&T(B,L),I=f(t(r,void 0,B))}else I=h(j,s,P,R,L,r);P>=C&&(A+=M(s,C,P)+I,C=P+j.length)}return A+M(s,C)}]},!!o(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})||!k||O)}();var al={selector:"td:not([data-w-e-type]),th:not([data-w-e-type])",parseElemHtml:function(n,o,i){var a=r(n);0===(o=o.filter(function(r){return"paragraph"===t.DomEditor.getNodeType(r)||(!!e.Text.isText(r)||!!i.isInline(r))})).length&&(o=[{text:a.text().replace(/\s+/gm," ")}]);var u=parseInt(a.attr("colSpan")||"1",10),c=parseInt(a.attr("rowSpan")||"1",10),l="none"===wa(a,"display"),f=a.attr("width")||"auto";return{type:"table-cell",isHeader:"th"===ba(a),colSpan:u,rowSpan:c,width:f,children:o,hidden:l}}};var ul={selector:"tr:not([data-w-e-type])",parseElemHtml:function(e,n,o){for(var i=r(e),a=[],u=0;u<n.length;u+=1){var c=n[u];if("table-cell"===t.DomEditor.getNodeType(c)){var l=c;if(l.hidden)continue;a.push(l)}}return{type:"table-row",height:parseInt(wa(i,"height")||"0",10)||void 0,children:a}}};var cl,ll={selector:"table:not([data-w-e-type])",parseElemHtml:function(e,n,o){var i,a,u=r(e),c="auto";"100%"===wa(u,"width")&&(c="100%"),"100%"===u.attr("width")&&(c="100%");var l={type:"table",width:c,height:parseInt(wa(u,"height")||"0",10),children:n.filter(function(e){return"table-row"===t.DomEditor.getNodeType(e)})},f=(null===(i=u.find("tr")[0])||void 0===i?void 0:i.children)||[],s=(null===(a=u.find("colgroup")[0])||void 0===a?void 0:a.children)||null,d=n[n.length-1].children.length;if(s&&s.length===d)l.columnWidths=Array.from(s).map(function(t){return parseInt(t.getAttribute("width"),10)});else if(f.length>0){var v=[];Array.from(f).forEach(function(t){var e=parseInt(r(t).attr("colSpan")||"1",10),n=parseInt(wa(r(t),"width")||"90",10);v.push(n);for(var o=1;o<e;o+=1)v.push(90)}),l.columnWidths=v}return l}},fl=null===(cl=null===window||void 0===window?void 0:window.getComputedStyle(document.documentElement))||void 0===cl?void 0:cl.getPropertyValue("--w-e-textarea-border-color");var sl,dl,vl,hl,pl,gl={};!function(){if(pl)return gl;pl=1;var t=on(),e=function(){if(dl)return sl;dl=1;var t=ht(),e=mt(),r=mo(),n=/"/g,o=t("".replace);return sl=function(t,i,a,u){var c=r(e(t)),l="<"+i;return""!==a&&(l+=" "+a+'="'+o(r(u),n,"&quot;")+'"'),l+">"+c+"</"+i+">"}}(),r=function(){if(hl)return vl;hl=1;var t=w();return vl=function(e){return t(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})}}();t({target:"String",proto:!0,forced:r("anchor")},{anchor:function(t){return e(this,"a","name",t)}})}();var yl,ml;function bl(r){var n=r.selection;if(null==n)return!1;var o=Wn(e.Editor.nodes(r,{match:function(e){return t.DomEditor.checkNodeType(e,"table-cell")}}),1)[0];if(o){var i=Wn(o,2)[1],a=e.Editor.start(r,i);if(e.Point.equals(n.anchor,a))return!0}return!1}function wl(t,r){var n=r.offset;if(0===n)return!1;var o=e.Editor.node(t,r);if(!e.Text.isText(o[0]))return!1;var i=e.Node.string(o[0]);return!(n>=i.length)&&("\n"===i[n-1]&&"\r"===i[n])}function xl(r,n,o){var i=r.selection;if(null==i||"line"===n)return!1;var a=Wn(e.Editor.nodes(r,{match:function(e){return t.DomEditor.checkNodeType(e,"table-cell")}}),1)[0],u=i.anchor;if("backward"===o&&0===i.anchor.offset&&(u=e.Editor.before(r,i)),"forward"===o&&e.Editor.isEnd(r,i.anchor,i.anchor.path)&&(u=e.Editor.after(r,i)),null==u)return!1;var c=e.Editor.above(r,{at:u,match:function(e){return t.DomEditor.checkNodeType(e,"table-cell")}});if(null==c||null==a||!e.Path.equals(c[1],a[1]))return!1;var l=e.Editor.node(r,u);if(!e.Text.isText(l[0])||l[0].text.length<2)return!1;var f="backward"===o?[u.offset-2,u.offset]:[u.offset,u.offset+2],s=e.Node.string(l[0]);return"\n\r"===s.slice.apply(s,_n([],Wn(f),!1))?(e.Transforms.insertText(r,s.slice(0,f[0])+s.slice(f[1]),{at:{anchor:e.Editor.start(r,u.path),focus:e.Editor.end(r,u.path)}}),!0):!!wl(r,u)&&(e.Transforms.insertText(r,s.slice(0,i.anchor.offset-1)+s.slice(i.anchor.offset+1),{at:{anchor:e.Editor.start(r,u.path),focus:e.Editor.end(r,u.path)}}),!0)}function El(r,n){return!!_n([],Wn(e.Editor.nodes(r,{at:n,match:function(e){return"table"===t.DomEditor.getNodeType(e)}})),!1).find(function(){return!0})}function Sl(e){var r,n;try{for(var o=Bn(["paragraph","header1","header2","header3","header4","header5","header6","blockquote","list-item","todo","divider"]),i=o.next();!i.done;i=o.next()){var a=i.value;if(t.DomEditor.getSelectedNodeByType(e,a))return!0}}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return!1}ml||(ml=1,yl||(yl=1,ou()("WeakSet",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},iu())));var Tl={selector:"table",preParseHtml:function(t){var e=r(t);if("table"!==ba(e))return t;var n=e.find("tbody");if(0===n.length)return t;var o=e.find("tr");e.append(o),n.remove();for(var i=e.find("td, th"),a=0;a<i.length;a+=1){var u=i[a],c=(f=r(u)).attr("style");if(c){/display\s*:\s*none/i.test(c)&&f.remove()}f.attr("width","auto")}var l=e.find("td, th");for(a=0;a<l.length;a+=1){u=l[a];var f,s=(f=r(u)).html()||"";s=(s=(s=s.replace(/<o:p[^>]*>[\s\S]*?<\/o:p>/gi,"")).replace(/<\/o:p>/gi,"")).replace(/<p[^>]*>([\s\S]*?)<\/p>/gi,function(t,e){var r=e.trim();return r&&"&nbsp;"!==r?e:""}),f.html(s)}return e[0]}};function Nl(t){var e,r,n=[],o=0;try{for(var i=Bn(t),a=i.next();!a.done;a=i.next()){o+=a.value,n.push(o)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n}function Ml(t){var e,r,n=[],o=t.reduce(function(t,e){return t+e},0);try{for(var i=Bn(t),a=i.next();!a.done;a=i.next()){var u=a.value;n.push(u/o)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n}var zl=null;var kl=!1,Ol=!1,Dl=0,Al=null,Cl=r(window);Cl.on("mousedown",function(t){var e=t.target;if(e.closest('[data-block-type="table-cell"]'))kl=!0;else if("DIV"===e.tagName&&e.closest(".column-resizer-item")){if(null===Al)return;Ol=!0;var r=t.clientX;Dl=r,document.body.style.cursor="col-resize",t.preventDefault()}Cl.on("mousemove",Hl),Cl.on("mouseup",Il)});var Hl=i(function(r){if(Ol&&null!==Al){r.preventDefault();var n,o=r.clientX,i=o-Dl,a=Wn(e.Editor.nodes(Al,{match:wo(Al,"table")}),1),u=Wn(a[0],1)[0],c=u.columnWidths,l=void 0===c?[]:c,f=u.resizingIndex,s=void 0===f?-1:f,d=t.DomEditor.getSelectedNodeByType(Al,"table"),v=t.DomEditor.toDOMNode(Al,d).querySelector(".table");if(v)n=function(t,e,r,n,o){var i=_n([],Wn(t),!1);if(e<0||e>=t.length)return i;var a=o.getMenuConfig("insertTable").minWidth,u=parseInt((void 0===a?60:a).toString(),10)||60,c=r-(0===e?0:n[e-1]),l=Math.max(u,c);return i[e]=Math.floor(100*l)/100,i}(l,s,o-v.getBoundingClientRect().left,Nl(l),Al);else n=function(t,e,r,n){var o=_n([],Wn(t),!1),i=n.getMenuConfig("insertTable").minWidth,a=parseInt((void 0===i?60:i).toString(),10)||60,u=o[e],c=Math.max(a,u+r);return o[e]=Math.floor(100*c)/100,o}(l,s,i,Al);e.Transforms.setNodes(Al,{columnWidths:n},{mode:"highest"})}},100);function Il(t){kl=!1,Ol=!1,Al=null,document.body.style.cursor="",Cl.off("mousemove",Hl),Cl.off("mouseup",Il)}function jl(t,r){"mouseenter"===r.type?e.Transforms.setNodes(t,{isResizing:!0},{mode:"highest"}):e.Transforms.setNodes(t,{isResizing:!1},{mode:"highest"})}function Pl(t){var e,r,n=[],o=0;try{for(var i=Bn(t),a=i.next();!a.done;a=i.next()){o+=a.value,n.push(o)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n}var Rl=!1,Vl=0,Ll=null,Bl=r(window);var Wl=i(function(r){if(Rl&&null!==Ll){r.preventDefault();var n,o=r.clientY,i=o-Vl,a=Wn(e.Editor.nodes(Ll,{match:wo(Ll,"table")}),1),u=Wn(a[0],1)[0],c=u.children,l=u.resizingRowIndex,f=void 0===l?-1:l,s=c.map(function(t){return t.height||30}),d=t.DomEditor.getSelectedNodeByType(Ll,"table"),v=t.DomEditor.toDOMNode(Ll,d).querySelector(".table");if(v)n=function(t,e,r,n,o){var i=_n([],Wn(t),!1);if(e<0||e>=t.length)return i;var a=(o.getMenuConfig("insertTable")||{}).minRowHeight,u=parseInt((void 0===a?30:a).toString(),10)||30,c=r-(0===e?0:n[e-1]),l=Math.max(u,c);return i[e]=Math.floor(100*l)/100,i}(s,f,o-v.getBoundingClientRect().top,Pl(s),Ll);else n=function(t,e,r,n){var o=_n([],Wn(t),!1),i=(n.getMenuConfig("insertTable")||{}).minRowHeight,a=parseInt((void 0===i?30:i).toString(),10)||30,u=o[e],c=Math.max(a,u+r);return o[e]=Math.floor(100*c)/100,o}(s,f,i,Ll);var h=t.DomEditor.getSelectedNodeByType(Ll,"table");if(h&&f>=0&&f<n.length){var p=_n(_n([],Wn(t.DomEditor.findPath(Ll,h)),!1),[f],!1);try{e.Transforms.setNodes(Ll,{height:n[f]},{at:p})}catch(t){console.warn("更新行高度失败:",t)}}}},100);function _l(t){Rl=!1,Ll=null,document.body.style.cursor="",Bl.off("mousemove",Wl),Bl.off("mouseup",_l)}function Fl(t,r){"mouseenter"===r.type?e.Transforms.setNodes(t,{isResizingRow:!0},{mode:"highest"}):e.Transforms.setNodes(t,{isResizingRow:!1},{mode:"highest"})}Bl.on("mousedown",function(t){var e=t.target;if("DIV"===e.tagName&&e.closest(".row-resizer-item")){if(null===Ll)return;Rl=!0;var r=t.clientY;Vl=r,document.body.style.cursor="row-resize",t.preventDefault()}Bl.on("mousemove",Wl),Bl.on("mouseup",_l)});var ql,$l,Gl,Ul={type:"table",renderElem:function(r,i,a){var u=function(r,n){if(r.isDisabled())return!1;var o=r.selection;if(null==o)return!0;if(e.Range.isCollapsed(o))return!0;var i=o.anchor,a=o.focus,u=t.DomEditor.findPath(r,n),c=e.Editor.start(r,u),l=e.Editor.end(r,u),f=e.Point.compare(i,l)<=0&&e.Point.compare(i,c)>=0,s=e.Point.compare(a,l)<=0&&e.Point.compare(a,c)>=0;return!!(f&&s&&e.Path.equals(i.path.slice(0,3),a.path.slice(0,3)))}(a,r),c=r,l=c.width,f=void 0===l?"auto":l,s=c.height,d=c.columnWidths,v=void 0===d?[]:d,h=c.scrollWidth,p=void 0===h?0:h,g=c.isHoverCellBorder,y=c.resizingIndex,m=c.isResizing,b=c.isHoverRowBorder,w=c.resizingRowIndex,x=c.isResizingRow,E=t.DomEditor.isNodeSelected(a,r),S=Wn(yc.selection(a),1)[0],T=Ml(v),N=n.jsx("div",{className:"table-container","data-selected":E,on:{mousedown:function(n){if("DIV"===n.target.tagName&&n.preventDefault(),!a.isDisabled()){n.target.closest('[data-block-type="table-cell"]')&&yc.unselect(a);var o=t.DomEditor.findPath(a,r),i=e.Editor.start(a,o),u=a.selection;if(null!=u)u.anchor.path[0]!==o[0]&&"DIV"===n.target.tagName&&a.select(i);else a.select(i)}}}},n.jsx("table",{width:f,contentEditable:u,className:"table ".concat(S?"table-selection-none":""),style:{width:"100%"===f?f:"".concat(v.reduce(function(t,e){return t+e},0),"px")},on:{mousemove:o(function(n){!function(r,n,o,i){if(!r.isDisabled()&&!kl&&!Ol){var a=n,u=a.width,c=void 0===u?"auto":u,l=a.columnWidths,f=void 0===l?[]:l,s=a.isHoverCellBorder,d=a.resizingIndex,v=o.clientX,h=o.target;if(t.isHTMLElememt(h)&&v>(y=h.getBoundingClientRect()).x+5&&v<y.x+y.width-5)return void(s&&e.Transforms.setNodes(r,{isHoverCellBorder:!1,resizingIndex:-1},{mode:"highest"}));if(t.isHTMLElememt(h)){var p=h.closest(".table");if(p)for(var g=o.clientX,y=p.getBoundingClientRect(),m=Nl("100%"===c?Ml(f).map(function(t){return t*i}):f),b=0;b<m.length;b+=1)if(g-y.x>=m[b]-5&&g-y.x<m[b]+5){if(d===b)return;return void e.Transforms.setNodes(r,{isHoverCellBorder:!0,resizingIndex:b},{mode:"highest"})}}!0===s&&e.Transforms.setNodes(r,{isHoverCellBorder:!1,resizingIndex:-1},{mode:"highest"})}}(a,r,n,p),function(r,n,o){if(!r.isDisabled()&&!Rl){var i=n,a=i.children,u=i.isHoverRowBorder,c=i.resizingRowIndex,l=o.target;if(t.isHTMLElememt(l)){var f=l.closest(".table");if(f)for(var s=o.clientY,d=f.getBoundingClientRect(),v=Pl(a.map(function(t){return t.height||30})),h=0;h<v.length;h+=1)if(s-d.y>=v[h]-5&&s-d.y<v[h]+5){if(c===h)return;return void e.Transforms.setNodes(r,{isHoverRowBorder:!0,resizingRowIndex:h},{mode:"highest"})}}!0===u&&e.Transforms.setNodes(r,{isHoverRowBorder:!1,resizingRowIndex:-1},{mode:"highest"})}}(a,r,n)},25)}},n.jsx("colgroup",{contentEditable:!1},v.map(function(t){return n.jsx("col",{width:t})})),n.jsx("tbody",null,i)),n.jsx("div",{className:"column-resizer",contentEditable:!1},v.map(function(t,e){var r=t;return"100%"===f&&(r=T[e]*p),n.jsx("div",{className:"column-resizer-item",style:{minWidth:"".concat(r,"px")}},n.jsx("div",{className:"resizer-line-hotzone ".concat(g&&e===y?"visible ":"").concat(m&&e===y?"highlight":""),style:{height:"".concat(s,"px")},on:{mouseenter:function(t){return jl(a,t)},mouseleave:function(t){return jl(a,t)},mousedown:function(t){return function(t){Ol||(Al=t)}(a)}}},n.jsx("div",{className:"resizer-line"})))})),n.jsx("div",{className:"row-resizer",contentEditable:!1},r.children.map(function(t,e){var r=v.reduce(function(t,e){return t+e},0),o=t.height||30;return n.jsx("div",{className:"row-resizer-item",style:{minHeight:"".concat(o,"px")}},n.jsx("div",{className:"resizer-line-hotzone-horizontal ".concat(b&&e===w?"visible ":"").concat(x&&e===w?"highlight":""),style:{width:"".concat(r,"px")},on:{mouseenter:function(t){return Fl(a,t)},mouseleave:function(t){return Fl(a,t)},mousedown:function(t){return function(t){Rl||(Ll=t)}(a)}}},n.jsx("div",{className:"resizer-line-horizontal"})))}))),M=n.h("div",{hook:{insert:function(r){var n=r.elm;return function(r,n){if(t.isHTMLElememt(n)){var o=n.querySelector("table");o&&(zl=new ResizeObserver(function(t){var n=Wn(t,1)[0].contentRect;e.Transforms.setNodes(r,{scrollWidth:n.width,height:n.height},{mode:"highest"})}),zl.observe(o))}}(a,n)},destroy:function(){zl&&(null==zl||zl.disconnect(),zl=null)}}},N);return M}},Yl={type:"table-row",renderElem:function(t,e,r){var o=t.height;return n.jsx("tr",{style:o?{height:"".concat(o,"px")}:{}},e)}},Xl={type:"table-cell",renderElem:function(e,r,o){var i=function(e,r){var n=t.DomEditor.getParentNode(e,r);if(null==n)return!1;var o=t.DomEditor.getParentNode(e,n);return null!=o&&Qu(o).some(function(t){return t===r})}(o,e),a=e,u=a.colSpan,c=void 0===u?1:u,l=a.rowSpan,f=void 0===l?1:l,s=a.isHeader,d=void 0!==s&&s,v=a.hidden,h=void 0!==v&&v,p=yc.isSelected(o,e);if(!i)return n.jsx("td",{colSpan:c,rowSpan:f,"data-block-type":"table-cell",className:p?"w-e-selected":"",style:{display:h?"none":""}},r);var g=d?"th":"td";return n.jsx(g,{colSpan:c,rowSpan:f,"data-block-type":"table-cell",className:p?"w-e-selected":"",style:{display:h?"none":""}},r)}},Kl={};function Jl(t,e){null==t.data&&(t.data={});var r=t.data;null==r.style&&(r.style={}),Object.assign(r.style,e)}!function(){if(Gl)return Kl;Gl=1;var t=on(),e=function(){if($l)return ql;$l=1;var t=x(),e=ht(),r=S(),n=w(),o=ro(),i=tn(),a=dt(),u=ce(),c=gt(),l=Object.assign,f=Object.defineProperty,s=e([].concat);return ql=!l||n(function(){if(t&&1!==l({b:1},l(f({},"a",{enumerable:!0,get:function(){f(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},r={},n=Symbol("assign detection"),i="abcdefghijklmnopqrst";return e[n]=7,i.split("").forEach(function(t){r[t]=t}),7!==l({},e)[n]||o(l({},r)).join("")!==i})?function(e,n){for(var l=u(e),f=arguments.length,d=1,v=i.f,h=a.f;f>d;)for(var p,g=c(arguments[d++]),y=v?s(o(g),v(g)):o(g),m=y.length,b=0;m>b;)p=y[b++],t&&!r(h,g,p)||(l[p]=g[p]);return l}:l,ql}();t({target:"Object",stat:!0,arity:2,forced:Object.assign!==e},{assign:e})}();var Ql={renderStyle:function(t,r){var n,o;if(!e.Element.isElement(t))return r;var i=t,a=i.backgroundColor,u=i.borderWidth,c=i.borderStyle,l=i.borderColor,f=i.textAlign,s={};a&&(s.backgroundColor=a),u&&(s.borderWidth="".concat(u,"px")),c&&(s.borderStyle="none"===c?"":c),l&&(s.borderColor=l),f&&(s.textAlign=f);var d=r;return"table"===t.type?Jl(null===(o=(null===(n=d.children)||void 0===n?void 0:n[0]).children)||void 0===o?void 0:o[0],s):Jl(d,s),d},styleToHtml:function(t,e){if("table"!==t.type&&"table-cell"!==t.type)return e;var n=t.backgroundColor,o=t.borderWidth,i=t.borderStyle,a=t.borderColor,u=t.textAlign;if(!(n||o||i||a||u))return e;var c=r(e);return n&&c.css("background-color",n),o&&c.css("border-width","".concat(o,"px")),i&&c.css("border-style","none"===i?"":i),a&&c.css("border-color",a),u&&c.css("text-align",u),function(t){return 0===t.length?"":t[0].outerHTML}(c)},parseStyleHtml:function(t,e,n){if(!["TABLE","TD","TH"].includes(t.tagName))return e;var o=r(t),i=e,a=wa(o,"background-color");a||(a=wa(o,"background")),a&&(i.backgroundColor=a);var u=wa(o,"border");u||"TD"!==t.tagName||(u="1px solid ".concat(fl));var c=Wn((null==u?void 0:u.split(" "))||[],3),l=c[0],f=c[1],s=c[2];(l=wa(o,"border-width")||l)&&(i.borderWidth=l.replace(/[^\d]/g,"")),(f=wa(o,"border-style")||f)&&(i.borderStyle="none"===f?"":f),(s=wa(o,"border-color")||s)&&(i.borderColor=s);var d=wa(o,"text-align");return(d=wa(o,"text-align")||d)&&(i.textAlign=d),e},renderElems:[Ul,Yl,Xl],elemsToHtml:[In,jn,Pn],preParseHtml:[Tl],parseElemsHtml:[al,ul,ll],menus:[Bc,Wc,_c,Fc,qc,$c,Gc,Uc,Yc,Xc,Kc,Jc],editorPlugin:function(r){var n=r.insertBreak,o=r.deleteBackward,i=r.deleteForward,a=r.deleteFragment,u=r.normalizeNode,c=r.insertData,l=r.handleTab,f=r.selectAll,s=r;s.insertBreak=function(){null==t.DomEditor.getSelectedNodeByType(s,"table")?n():s.insertText("\n\r")},s.deleteBackward=function(r){if(!bl(s)&&!xl(s,r,"backward")){var n=s.selection;if(n){var i=e.Editor.before(s,n),a=e.Editor.above(s,{at:n,match:function(e){return t.DomEditor.checkNodeType(e,"table-cell")}});if(i){var u=El(s,i);if(!a&&u&&Sl(s))return}}o(r)}},s.handleTab=function(){var n;if(t.DomEditor.getSelectedNodeByType(s,"table")){var o=e.Editor.above(r);t.DomEditor.checkNodeType(o[0],"table-cell")&&e.Transforms.select(r,o[1]);var i=e.Editor.next(r);if(i)i[0]&&i[0].text&&(i=null!==(n=e.Editor.above(r,{at:i[1]}))&&void 0!==n?n:i),e.Transforms.select(r,i[1]);else{var a=s.children||[],u=a.length;if(t.DomEditor.checkNodeType(a[u-1],"table")){var c=t.DomEditor.genEmptyParagraph();e.Transforms.insertNodes(s,c,{at:[u]}),s.handleTab()}}}else l()},s.deleteForward=function(r){if(!bl(s)&&!xl(s,r,"forward")){var n=s.selection;if(n){var o=e.Editor.after(s,n),a=e.Editor.above(s,{at:n,match:function(e){return t.DomEditor.checkNodeType(e,"table-cell")}});if(o){var u=El(s,o);if(!a&&u&&Sl(s))return}}i(r)}},s.deleteFragment=function(t){var r=s.selection;if(r){var n,o=!1,i={anchor:r.anchor,focus:r.focus},u=e.Point.isBefore(i.anchor,i.focus);if(wl(s,r.anchor))(n=e.Editor[u?"before":"after"](s,r.anchor))&&(i.anchor=n),o=!0;if(wl(s,r.focus))(n=e.Editor[u?"after":"before"](s,r.focus))&&(i.focus=n),o=!0;o&&e.Transforms.setSelection(s,i),a(t)}},s.normalizeNode=function(r){var n=Wn(r,2),o=n[0],i=n[1];if("table"!==t.DomEditor.getNodeType(o))return u([o,i]);if(t.DomEditor.isLastNode(s,o)){var a=t.DomEditor.genEmptyParagraph();e.Transforms.insertNodes(s,a,{at:[i[0]+1]})}},s.insertData=function(r){if(null!=t.DomEditor.getSelectedNodeByType(s,"table")){var n=r.getData("text/plain");"\n"===n||/<img[^>]+>/.test(r.getData("text/html"))?c(r):e.Editor.insertText(s,n)}else c(r)},s.selectAll=function(){var r=s.selection;if(null!=r){var n=t.DomEditor.getSelectedNodeByType(s,"table-cell");if(null!=n){var o=r.anchor,i=r.focus;if(e.Path.equals(o.path.slice(0,3),i.path.slice(0,3)))if(0!==e.Node.string(n).length){var a=t.DomEditor.findPath(s,n),u={anchor:e.Editor.start(s,a),focus:e.Editor.end(s,a)};s.select(u)}else f();else f()}else f()}else f()},function(t){var r=t.apply;t.apply=function(n){if(!e.Operation.isSelectionOperation(n)||!n.newProperties)return r(n);var o=Vn(Vn({},t.selection),n.newProperties);if(!e.Range.isRange(o))return yc.unselect(t),r(n);var i=function(t){return e.Element.isElement(t)&&("table-cell"===t.type||"th"===t.type||"td"===t.type)},a=Wn(e.Editor.nodes(t,{match:i,at:e.Range.start(o),mode:"lowest"}),1)[0],u=Wn(e.Editor.nodes(t,{match:i,at:e.Range.end(o),mode:"lowest"}),1)[0];if(!a||!u)return yc.unselect(t),r(n);var c=Wn(a,2)[1],l=Wn(u,2)[1];if(e.Path.equals(c,l)||!xo(t,[c,l],"table"))return yc.unselect(t),r(n);try{var f=Eo(t,{at:c});if(!f||0===f.length)return yc.unselect(t),r(n);for(var s=To.valueOf(0,0),d=To.valueOf(0,0),v=!1,h=!1,p=0;p<f.length;p+=1)if(f[p])for(var g=0;g<f[p].length;g+=1)if(f[p][g]){var y=Wn(f[p][g],1),m=Wn(y[0],2)[1];e.Path.equals(c,m)&&(s.x=p,s.y=g,v=!0),e.Path.equals(l,m)&&(d.x=p,d.y=g,h=!0)}if(!v||!h)return yc.unselect(t),r(n);for(var b=To.valueOf(Math.min(s.x,d.x),Math.min(s.y,d.y)),w=To.valueOf(Math.max(s.x,d.x),Math.max(s.y,d.y));;){var x=To.valueOf(b.x,b.y),E=To.valueOf(w.x,w.y);for(p=x.x;p<=E.x&&p<f.length;p+=1)if(f[p])for(g=x.y;g<=E.y&&g<f[p].length;g+=1)if(f[p][g]){var S=Wn(f[p][g],2)[1];if(S){var T=S.rtl,N=S.ltr,M=S.btt,z=S.ttb;x.x=Math.min(x.x,p-(z-1)),x.y=Math.min(x.y,g-(T-1)),E.x=Math.max(E.x,p+(M-1)),E.y=Math.max(E.y,g+(N-1))}}if(To.equals(b,x)&&To.equals(w,E))break;b=x,w=E}var k=[],O=new WeakSet;for(p=b.x;p<=w.x&&p<f.length;p+=1)if(f[p]){var D=[];for(g=b.y;g<=w.y&&g<f[p].length;g+=1)if(f[p][g]){var A=Wn(f[p][g],1),C=Wn(A[0],1)[0];C&&(O.add(C),D.push(f[p][g]))}D.length>0&&k.push(D)}bu.set(t,k),wu.set(t,O)}catch(e){return yc.unselect(t),r(n)}r(n)}}(s),s.getTableSelection=function(){return bu.get(s)||null};var d=s.addMark,v=s.removeMark,h=Vn({},e.Transforms);return s.addMark=function(t,r){var n=bu.get(s);if(n&&n.length>0){var o=s.selection;n.forEach(function(n){n.forEach(function(n){var o=Wn(n[0],2)[1],i=e.Editor.start(s,o),a=e.Editor.end(s,o);e.Transforms.select(s,{anchor:i,focus:a}),d(t,r)})}),o&&e.Transforms.select(s,o)}else d(t,r)},s.removeMark=function(t){var r=bu.get(s);if(r&&r.length>0){var n=s.selection;r.forEach(function(r){r.forEach(function(r){var n=Wn(r[0],2)[1],o=e.Editor.start(s,n),i=e.Editor.end(s,n);e.Transforms.select(s,{anchor:o,focus:i}),v(t)})}),n&&e.Transforms.select(s,n)}else v(t)},e.Transforms.setNodes=function(t,e,r){if(void 0===r&&(r={}),t===s){var n=bu.get(s);if(n&&n.length>0)return"hidden"in e||"rowSpan"in e||"colSpan"in e?void h.setNodes(t,e,r):void n.forEach(function(n){n.forEach(function(n){var o=Wn(n[0],2)[1];h.setNodes(t,e,Vn(Vn({},r),{at:o}))})})}h.setNodes(t,e,r)},s}};return Ql});
//# sourceMappingURL=index.js.map
